[2025-08-06 19:24:24,345][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 19:24:24,346][__main__][INFO] - === STARTING EXPERIMENT: baseline-mwpm-filt ===
[2025-08-06 19:24:24,346][__main__][INFO] - PID: 199550
[2025-08-06 19:24:24,346][__main__][INFO] - SLURM_JOB_ID: 28947894
[2025-08-06 19:24:24,346][__main__][INFO] - Architecture: resnet50
[2025-08-06 19:24:24,346][__main__][INFO] - Embedding Dim: 64
[2025-08-06 19:24:24,346][__main__][INFO] - Learning Rate: 0.0003
[2025-08-06 19:24:24,346][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-06 19:24:24,346][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-06 19:24:24,346][__main__][INFO] - Dataset: d=9, rounds_max=19, p=2.1
[2025-08-06 19:24:24,347][__main__][INFO] - Accelerator: auto
[2025-08-06 19:24:24,347][__main__][INFO] - Devices: auto
[2025-08-06 19:24:24,347][__main__][INFO] - Strategy: auto
[2025-08-06 19:24:24,347][__main__][INFO] - Num Nodes: 1
[2025-08-06 19:24:24,347][__main__][INFO] - Sync BatchNorm: True
[2025-08-06 19:24:24,347][__main__][INFO] - MWPM filtering: True
[2025-08-06 19:24:24,347][__main__][INFO] - Batch Size: 453
[2025-08-06 19:24:24,347][__main__][INFO] - Precision: bf16-mixed
[2025-08-06 19:24:24,347][__main__][INFO] - Max Steps: 50000
[2025-08-06 19:24:24,347][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-06 19:24:24,348][__main__][INFO] - Log every 100 steps
[2025-08-06 19:24:24,348][__main__][INFO] - Num Workers: 8
[2025-08-06 19:24:24,348][__main__][INFO] - Prefetch Factor: 4
[2025-08-06 19:24:24,348][__main__][INFO] - Persistent Workers: True
[2025-08-06 19:24:24,348][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/baseline-mwpm-filt
[2025-08-06 19:24:24,372][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-06 19:24:24,372][__main__][INFO] - Initializing wandb logger with params
[2025-08-06 19:24:29,262][__main__][INFO] - Saved new W&B run ID to file: vie4qs1t
[2025-08-06 19:24:29,390][__main__][INFO] - Using manual batch size from config: 453
[2025-08-06 19:24:29,476][__main__][INFO] - === STARTING TRAINING ===
[2025-08-06 19:24:30,008][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 20:01:01,573][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 20:01:01,574][__main__][INFO] - === STARTING EXPERIMENT: baseline-d19-filter ===
[2025-08-06 20:01:01,574][__main__][INFO] - PID: 2968524
[2025-08-06 20:01:01,574][__main__][INFO] - SLURM_JOB_ID: 28958299
[2025-08-06 20:01:01,574][__main__][INFO] - Architecture: resnet50
[2025-08-06 20:01:01,574][__main__][INFO] - Embedding Dim: 64
[2025-08-06 20:01:01,574][__main__][INFO] - Learning Rate: 0.0003
[2025-08-06 20:01:01,574][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-06 20:01:01,574][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-06 20:01:01,574][__main__][INFO] - Dataset: d=19, rounds_max=19, p=2.1
[2025-08-06 20:01:01,574][__main__][INFO] - Accelerator: auto
[2025-08-06 20:01:01,574][__main__][INFO] - Devices: auto
[2025-08-06 20:01:01,574][__main__][INFO] - Strategy: auto
[2025-08-06 20:01:01,574][__main__][INFO] - Num Nodes: 1
[2025-08-06 20:01:01,574][__main__][INFO] - Sync BatchNorm: True
[2025-08-06 20:01:01,574][__main__][INFO] - MWPM filtering: True
[2025-08-06 20:01:01,575][__main__][INFO] - Batch Size: auto-tuned
[2025-08-06 20:01:01,575][__main__][INFO] - Precision: bf16-mixed
[2025-08-06 20:01:01,575][__main__][INFO] - Max Steps: 100000
[2025-08-06 20:01:01,575][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-06 20:01:01,575][__main__][INFO] - Log every 100 steps
[2025-08-06 20:01:01,575][__main__][INFO] - Num Workers: 15
[2025-08-06 20:01:01,575][__main__][INFO] - Prefetch Factor: 4
[2025-08-06 20:01:01,575][__main__][INFO] - Persistent Workers: True
[2025-08-06 20:01:01,575][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/baseline-d19-filter
[2025-08-06 20:01:01,597][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-06 20:01:01,597][__main__][INFO] - Initializing wandb logger with params
[2025-08-06 20:01:03,981][__main__][INFO] - Saved new W&B run ID to file: cz9wl9tn
[2025-08-06 20:01:04,061][__main__][INFO] - === AUTO-TUNING BATCH SIZE ===
[2025-08-06 20:01:04,450][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 20:03:04,658][__main__][INFO] - Saved batch size 236 to file
[2025-08-06 20:03:04,659][__main__][INFO] - Optimal per-GPU batch size found: 236
[2025-08-06 20:03:04,659][__main__][INFO] - Effective total batch size across 1 device(s): 236
[2025-08-06 20:03:04,664][__main__][INFO] - Saved metadata: {'timestamp': 1754524984.659184, 'slurm_job_id': '28958299', 'batch_size': 236, 'num_devices': 1, 'effective_batch_size': 236}
[2025-08-06 20:03:05,061][__main__][INFO] - === STARTING TRAINING ===
[2025-08-06 20:03:05,072][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 20:04:15,077][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 20:04:15,078][__main__][INFO] - === STARTING EXPERIMENT: resnet34-d19-filter ===
[2025-08-06 20:04:15,078][__main__][INFO] - PID: 2970369
[2025-08-06 20:04:15,078][__main__][INFO] - SLURM_JOB_ID: 28960126
[2025-08-06 20:04:15,078][__main__][INFO] - Architecture: resnet34
[2025-08-06 20:04:15,078][__main__][INFO] - Embedding Dim: 64
[2025-08-06 20:04:15,078][__main__][INFO] - Learning Rate: 0.0003
[2025-08-06 20:04:15,078][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-06 20:04:15,078][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-06 20:04:15,078][__main__][INFO] - Dataset: d=19, rounds_max=19, p=2.1
[2025-08-06 20:04:15,078][__main__][INFO] - Accelerator: auto
[2025-08-06 20:04:15,078][__main__][INFO] - Devices: auto
[2025-08-06 20:04:15,078][__main__][INFO] - Strategy: auto
[2025-08-06 20:04:15,078][__main__][INFO] - Num Nodes: 1
[2025-08-06 20:04:15,078][__main__][INFO] - Sync BatchNorm: True
[2025-08-06 20:04:15,078][__main__][INFO] - MWPM filtering: True
[2025-08-06 20:04:15,078][__main__][INFO] - Batch Size: auto-tuned
[2025-08-06 20:04:15,078][__main__][INFO] - Precision: bf16-mixed
[2025-08-06 20:04:15,079][__main__][INFO] - Max Steps: 100000
[2025-08-06 20:04:15,079][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-06 20:04:15,079][__main__][INFO] - Log every 100 steps
[2025-08-06 20:04:15,079][__main__][INFO] - Num Workers: 15
[2025-08-06 20:04:15,079][__main__][INFO] - Prefetch Factor: 4
[2025-08-06 20:04:15,079][__main__][INFO] - Persistent Workers: True
[2025-08-06 20:04:15,079][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/resnet34-d19-filter
[2025-08-06 20:04:15,103][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-06 20:04:15,103][__main__][INFO] - Initializing wandb logger with params
[2025-08-06 20:04:17,060][__main__][INFO] - Saved new W&B run ID to file: 3u88lg50
[2025-08-06 20:04:17,136][__main__][INFO] - === AUTO-TUNING BATCH SIZE ===
[2025-08-06 20:04:17,726][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 20:06:17,240][__main__][INFO] - Saved batch size 236 to file
[2025-08-06 20:06:17,243][__main__][INFO] - Optimal per-GPU batch size found: 236
[2025-08-06 20:06:17,243][__main__][INFO] - Effective total batch size across 1 device(s): 236
[2025-08-06 20:06:17,256][__main__][INFO] - Saved metadata: {'timestamp': 1754525177.2436533, 'slurm_job_id': '28960126', 'batch_size': 236, 'num_devices': 1, 'effective_batch_size': 236}
[2025-08-06 20:06:17,690][__main__][INFO] - === STARTING TRAINING ===
[2025-08-06 20:06:17,697][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 20:11:24,208][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 20:11:24,208][__main__][INFO] - === STARTING EXPERIMENT: resnet34-d19-filter ===
[2025-08-06 20:11:24,208][__main__][INFO] - PID: 2974407
[2025-08-06 20:11:24,208][__main__][INFO] - SLURM_JOB_ID: 28960126
[2025-08-06 20:11:24,208][__main__][INFO] - Architecture: resnet34
[2025-08-06 20:11:24,209][__main__][INFO] - Embedding Dim: 64
[2025-08-06 20:11:24,209][__main__][INFO] - Learning Rate: 0.0003
[2025-08-06 20:11:24,209][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-06 20:11:24,209][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-06 20:11:24,209][__main__][INFO] - Dataset: d=19, rounds_max=19, p=2.1
[2025-08-06 20:11:24,209][__main__][INFO] - Accelerator: auto
[2025-08-06 20:11:24,209][__main__][INFO] - Devices: auto
[2025-08-06 20:11:24,209][__main__][INFO] - Strategy: auto
[2025-08-06 20:11:24,209][__main__][INFO] - Num Nodes: 1
[2025-08-06 20:11:24,209][__main__][INFO] - Sync BatchNorm: True
[2025-08-06 20:11:24,209][__main__][INFO] - MWPM filtering: True
[2025-08-06 20:11:24,209][__main__][INFO] - Batch Size: auto-tuned
[2025-08-06 20:11:24,209][__main__][INFO] - Precision: bf16-mixed
[2025-08-06 20:11:24,209][__main__][INFO] - Max Steps: 100000
[2025-08-06 20:11:24,209][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-06 20:11:24,209][__main__][INFO] - Log every 100 steps
[2025-08-06 20:11:24,209][__main__][INFO] - Num Workers: 15
[2025-08-06 20:11:24,209][__main__][INFO] - Prefetch Factor: 4
[2025-08-06 20:11:24,209][__main__][INFO] - Persistent Workers: True
[2025-08-06 20:11:24,210][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/resnet34-d19-filter
[2025-08-06 20:11:24,229][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-06 20:11:24,229][__main__][INFO] - Initializing wandb logger with params
[2025-08-06 20:11:26,027][__main__][INFO] - Saved new W&B run ID to file: cy6hxdgo
[2025-08-06 20:11:26,958][__main__][INFO] - === AUTO-TUNING BATCH SIZE ===
[2025-08-06 20:11:27,565][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 20:34:50,374][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 20:34:50,376][__main__][INFO] - === STARTING EXPERIMENT: resnet50_filt_4gpu ===
[2025-08-06 20:34:50,376][__main__][INFO] - PID: 757898
[2025-08-06 20:34:50,376][__main__][INFO] - SLURM_JOB_ID: 28962560
[2025-08-06 20:34:50,376][__main__][INFO] - Architecture: resnet50
[2025-08-06 20:34:50,376][__main__][INFO] - Embedding Dim: 64
[2025-08-06 20:34:50,376][__main__][INFO] - Learning Rate: 0.0003
[2025-08-06 20:34:50,376][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-06 20:34:50,376][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-06 20:34:50,376][__main__][INFO] - Use LSTM: False
[2025-08-06 20:34:50,377][__main__][INFO] - Dataset: d=9, rounds_max=19, p=2.1
[2025-08-06 20:34:50,377][__main__][INFO] - Accelerator: auto
[2025-08-06 20:34:50,377][__main__][INFO] - Devices: auto
[2025-08-06 20:34:50,377][__main__][INFO] - Strategy: auto
[2025-08-06 20:34:50,377][__main__][INFO] - Num Nodes: 1
[2025-08-06 20:34:50,377][__main__][INFO] - Sync BatchNorm: True
[2025-08-06 20:34:50,377][__main__][INFO] - MWPM filtering: True
[2025-08-06 20:34:50,377][__main__][INFO] - Batch Size: auto-tuned
[2025-08-06 20:34:50,377][__main__][INFO] - Precision: bf16-mixed
[2025-08-06 20:34:50,377][__main__][INFO] - Max Steps: 50000
[2025-08-06 20:34:50,377][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-06 20:34:50,377][__main__][INFO] - Log every 100 steps
[2025-08-06 20:34:50,378][__main__][INFO] - Num Workers: 15
[2025-08-06 20:34:50,378][__main__][INFO] - Prefetch Factor: 4
[2025-08-06 20:34:50,378][__main__][INFO] - Persistent Workers: True
[2025-08-06 20:34:50,378][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/resnet50_filt_4gpu
[2025-08-06 20:34:50,394][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-06 20:34:50,394][__main__][INFO] - Initializing wandb logger with params
[2025-08-06 20:34:56,458][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 20:34:56,460][__main__][INFO] - === STARTING EXPERIMENT: resnet50_lstm ===
[2025-08-06 20:34:56,460][__main__][INFO] - PID: 3897256
[2025-08-06 20:34:56,460][__main__][INFO] - SLURM_JOB_ID: 28962562
[2025-08-06 20:34:56,460][__main__][INFO] - Architecture: resnet50
[2025-08-06 20:34:56,460][__main__][INFO] - Embedding Dim: 64
[2025-08-06 20:34:56,460][__main__][INFO] - Learning Rate: 0.0003
[2025-08-06 20:34:56,460][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-06 20:34:56,460][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-06 20:34:56,461][__main__][INFO] - Use LSTM: True
[2025-08-06 20:34:56,461][__main__][INFO] - Dataset: d=9, rounds_max=19, p=2.1
[2025-08-06 20:34:56,461][__main__][INFO] - Accelerator: auto
[2025-08-06 20:34:56,461][__main__][INFO] - Devices: auto
[2025-08-06 20:34:56,461][__main__][INFO] - Strategy: auto
[2025-08-06 20:34:56,461][__main__][INFO] - Num Nodes: 1
[2025-08-06 20:34:56,461][__main__][INFO] - Sync BatchNorm: True
[2025-08-06 20:34:56,461][__main__][INFO] - MWPM filtering: True
[2025-08-06 20:34:56,461][__main__][INFO] - Batch Size: auto-tuned
[2025-08-06 20:34:56,461][__main__][INFO] - Precision: bf16-mixed
[2025-08-06 20:34:56,461][__main__][INFO] - Max Steps: 50000
[2025-08-06 20:34:56,462][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-06 20:34:56,462][__main__][INFO] - Log every 100 steps
[2025-08-06 20:34:56,462][__main__][INFO] - Num Workers: 15
[2025-08-06 20:34:56,462][__main__][INFO] - Prefetch Factor: 4
[2025-08-06 20:34:56,462][__main__][INFO] - Persistent Workers: True
[2025-08-06 20:34:56,462][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/resnet50_lstm
[2025-08-06 20:34:56,478][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-06 20:34:56,478][__main__][INFO] - Initializing wandb logger with params
[2025-08-06 20:34:58,807][__main__][INFO] - Saved new W&B run ID to file: 5frieun7
[2025-08-06 20:34:58,941][__main__][INFO] - === AUTO-TUNING BATCH SIZE ===
[2025-08-06 20:35:02,071][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 20:36:32,973][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 20:36:32,974][__main__][INFO] - === STARTING EXPERIMENT: resnet101_filt_4gpu ===
[2025-08-06 20:36:32,974][__main__][INFO] - PID: 3818023
[2025-08-06 20:36:32,974][__main__][INFO] - SLURM_JOB_ID: 28962566
[2025-08-06 20:36:32,974][__main__][INFO] - Architecture: resnet101
[2025-08-06 20:36:32,974][__main__][INFO] - Embedding Dim: 64
[2025-08-06 20:36:32,974][__main__][INFO] - Learning Rate: 0.001
[2025-08-06 20:36:32,974][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-06 20:36:32,974][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-06 20:36:32,974][__main__][INFO] - Use LSTM: False
[2025-08-06 20:36:32,974][__main__][INFO] - Dataset: d=9, rounds_max=19, p=2.1
[2025-08-06 20:36:32,975][__main__][INFO] - Accelerator: auto
[2025-08-06 20:36:32,975][__main__][INFO] - Devices: auto
[2025-08-06 20:36:32,975][__main__][INFO] - Strategy: auto
[2025-08-06 20:36:32,975][__main__][INFO] - Num Nodes: 1
[2025-08-06 20:36:32,975][__main__][INFO] - Sync BatchNorm: True
[2025-08-06 20:36:32,975][__main__][INFO] - MWPM filtering: True
[2025-08-06 20:36:32,975][__main__][INFO] - Batch Size: auto-tuned
[2025-08-06 20:36:32,975][__main__][INFO] - Precision: bf16-mixed
[2025-08-06 20:36:32,975][__main__][INFO] - Max Steps: 50000
[2025-08-06 20:36:32,975][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-06 20:36:32,975][__main__][INFO] - Log every 100 steps
[2025-08-06 20:36:32,975][__main__][INFO] - Num Workers: 15
[2025-08-06 20:36:32,975][__main__][INFO] - Prefetch Factor: 4
[2025-08-06 20:36:32,975][__main__][INFO] - Persistent Workers: True
[2025-08-06 20:36:32,975][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/resnet101_filt_4gpu
[2025-08-06 20:36:32,991][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-06 20:36:32,991][__main__][INFO] - Initializing wandb logger with params
[2025-08-06 20:36:35,104][__main__][INFO] - Saved new W&B run ID to file: mwv9malo
[2025-08-06 20:36:35,231][__main__][INFO] - === AUTO-TUNING BATCH SIZE ===
[2025-08-06 20:36:38,030][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 20:37:03,392][__main__][INFO] - Found optimal batch size 1186
[2025-08-06 20:37:03,410][__main__][INFO] - Saved batch size 948 to file
[2025-08-06 20:37:03,410][__main__][INFO] - Optimal per-GPU batch size found: 948
[2025-08-06 20:37:03,410][__main__][INFO] - Effective total batch size across 4 device(s): 3792
[2025-08-06 20:37:03,417][__main__][INFO] - Saved metadata: {'timestamp': 1754527023.4107168, 'slurm_job_id': '28962560', 'batch_size': 948, 'num_devices': 4, 'effective_batch_size': 3792}
[2025-08-06 20:37:03,877][__main__][INFO] - === STARTING TRAINING ===
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              [2025-08-06 20:38:01,766][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 20:38:39,304][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 20:41:39,461][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 20:41:39,462][__main__][INFO] - === STARTING EXPERIMENT: resnet50_filt_4gpu ===
[2025-08-06 20:41:39,462][__main__][INFO] - PID: 762273
[2025-08-06 20:41:39,462][__main__][INFO] - SLURM_JOB_ID: 28962710
[2025-08-06 20:41:39,462][__main__][INFO] - Architecture: resnet50
[2025-08-06 20:41:39,462][__main__][INFO] - Embedding Dim: 64
[2025-08-06 20:41:39,462][__main__][INFO] - Learning Rate: 0.0003
[2025-08-06 20:41:39,463][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-06 20:41:39,463][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-06 20:41:39,463][__main__][INFO] - Use LSTM: False
[2025-08-06 20:41:39,463][__main__][INFO] - Dataset: d=19, rounds_max=19, p=2.1
[2025-08-06 20:41:39,463][__main__][INFO] - Accelerator: auto
[2025-08-06 20:41:39,463][__main__][INFO] - Devices: auto
[2025-08-06 20:41:39,463][__main__][INFO] - Strategy: auto
[2025-08-06 20:41:39,463][__main__][INFO] - Num Nodes: 1
[2025-08-06 20:41:39,463][__main__][INFO] - Sync BatchNorm: True
[2025-08-06 20:41:39,463][__main__][INFO] - MWPM filtering: True
[2025-08-06 20:41:39,464][__main__][INFO] - Batch Size: auto-tuned
[2025-08-06 20:41:39,464][__main__][INFO] - Precision: bf16-mixed
[2025-08-06 20:41:39,464][__main__][INFO] - Max Steps: 50000
[2025-08-06 20:41:39,464][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-06 20:41:39,464][__main__][INFO] - Log every 100 steps
[2025-08-06 20:41:39,464][__main__][INFO] - Num Workers: 15
[2025-08-06 20:41:39,464][__main__][INFO] - Prefetch Factor: 4
[2025-08-06 20:41:39,464][__main__][INFO] - Persistent Workers: True
[2025-08-06 20:41:39,464][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/resnet50_filt_4gpu
[2025-08-06 20:41:39,477][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-06 20:41:39,477][__main__][INFO] - Initializing wandb logger with params
[2025-08-06 20:41:41,675][__main__][INFO] - Saved new W&B run ID to file: xissoqhx
[2025-08-06 20:41:41,800][__main__][INFO] - === AUTO-TUNING BATCH SIZE ===
[2025-08-06 20:41:44,710][__main__][INFO] - Set seed 42 for local rank 0
:41:45,350][__main__][INFO] - SLURM_JOB_ID: 28962711
[2025-08-06 20:41:45,350][__main__][INFO] - Architecture: resnet50
[2025-08-06 20:41:45,350][__main__][INFO] - Embedding Dim: 64
[2025-08-06 20:41:45,350][__main__][INFO] - Learning Rate: 0.0003
[2025-08-06 20:41:45,350][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-06 20:41:45,351][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-06 20:41:45,351][__main__][INFO] - Use LSTM: True
[2025-08-06 20:41:45,351][__main__][INFO] - Dataset: d=19, rounds_max=19, p=2.1
[2025-08-06 20:41:45,351][__main__][INFO] - Accelerator: auto
[2025-08-06 20:41:45,351][__main__][INFO] - Devices: auto
[2025-08-06 20:41:45,351][__main__][INFO] - Strategy: auto
[2025-08-06 20:41:45,351][__main__][INFO] - Num Nodes: 1
[2025-08-06 20:41:45,351][__main__][INFO] - Sync BatchNorm: True
[2025-08-06 20:41:45,351][__main__][INFO] - MWPM filtering: True
[2025-08-06 20:41:45,351][__main__][INFO] - Batch Size: auto-tuned
[2025-08-06 20:41:45,352][__main__][INFO] - Precision: bf16-mixed
[2025-08-06 20:41:45,352][__main__][INFO] - Max Steps: 50000
[2025-08-06 20:41:45,352][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-06 20:41:45,352][__main__][INFO] - Log every 100 steps
[2025-08-06 20:41:45,352][__main__][INFO] - Num Workers: 15
[2025-08-06 20:41:45,352][__main__][INFO] - Prefetch Factor: 4
[2025-08-06 20:41:45,352][__main__][INFO] - Persistent Workers: True
[2025-08-06 20:41:45,352][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/resnet50_lstm
[2025-08-06 20:41:45,374][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-06 20:41:45,374][__main__][INFO] - Initializing wandb logger with params
[2025-08-06 20:41:47,618][__main__][INFO] - Saved new W&B run ID to file: mmyvoi9d
[2025-08-06 20:41:47,742][__main__][INFO] - === AUTO-TUNING BATCH SIZE ===
[2025-08-06 20:41:50,646][__main__][INFO] - Set seed 42 for local rank 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     [2025-08-06 20:45:03,612][__main__][INFO] - Found optimal batch size 296
[2025-08-06 20:45:03,629][__main__][INFO] - Saved batch size 236 to file
[2025-08-06 20:45:03,629][__main__][INFO] - Optimal per-GPU batch size found: 236
[2025-08-06 20:45:03,629][__main__][INFO] - Effective total batch size across 4 device(s): 944
[2025-08-06 20:45:03,637][__main__][INFO] - Saved metadata: {'timestamp': 1754527503.6295946, 'slurm_job_id': '28962711', 'batch_size': 236, 'num_devices': 4, 'effective_batch_size': 944}
[2025-08-06 20:45:04,080][__main__][INFO] - === STARTING TRAINING ===
[2025-08-06 20:45:59,971][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 20:46:34,357][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 20:46:34,358][__main__][INFO] - === STARTING EXPERIMENT: resnet50_lstm_1gpu ===
[2025-08-06 20:46:34,358][__main__][INFO] - PID: 2084698
[2025-08-06 20:46:34,358][__main__][INFO] - SLURM_JOB_ID: 28962839
[2025-08-06 20:46:34,358][__main__][INFO] - Architecture: resnet50
[2025-08-06 20:46:34,358][__main__][INFO] - Embedding Dim: 64
[2025-08-06 20:46:34,358][__main__][INFO] - Learning Rate: 0.0003
[2025-08-06 20:46:34,358][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-06 20:46:34,358][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-06 20:46:34,358][__main__][INFO] - Use LSTM: True
[2025-08-06 20:46:34,358][__main__][INFO] - Dataset: d=19, rounds_max=19, p=2.1
[2025-08-06 20:46:34,358][__main__][INFO] - Accelerator: auto
[2025-08-06 20:46:34,359][__main__][INFO] - Devices: auto
[2025-08-06 20:46:34,359][__main__][INFO] - Strategy: auto
[2025-08-06 20:46:34,359][__main__][INFO] - Num Nodes: 1
[2025-08-06 20:46:34,359][__main__][INFO] - Sync BatchNorm: True
[2025-08-06 20:46:34,359][__main__][INFO] - MWPM filtering: True
[2025-08-06 20:46:34,359][__main__][INFO] - Batch Size: auto-tuned
[2025-08-06 20:46:34,359][__main__][INFO] - Precision: bf16-mixed
[2025-08-06 20:46:34,359][__main__][INFO] - Max Steps: 50000
[2025-08-06 20:46:34,359][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-06 20:46:34,359][__main__][INFO] - Log every 100 steps
[2025-08-06 20:46:34,359][__main__][INFO] - Num Workers: 15
[2025-08-06 20:46:34,359][__main__][INFO] - Prefetch Factor: 4
[2025-08-06 20:46:34,359][__main__][INFO] - Persistent Workers: True
[2025-08-06 20:46:34,360][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/resnet50_lstm_1gpu
[2025-08-06 20:46:34,378][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-06 20:46:34,378][__main__][INFO] - Initializing wandb logger with params
[2025-08-06 20:46:36,454][__main__][INFO] - Saved new W&B run ID to file: xgqhejsy
[2025-08-06 20:46:36,566][__main__][INFO] - === AUTO-TUNING BATCH SIZE ===
[2025-08-06 20:46:37,377][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 20:49:43,461][__main__][INFO] - Found optimal batch size 296
[2025-08-06 20:49:43,475][__main__][INFO] - Saved batch size 236 to file
[2025-08-06 20:49:43,476][__main__][INFO] - Optimal per-GPU batch size found: 236
[2025-08-06 20:49:43,476][__main__][INFO] - Effective total batch size across 1 device(s): 236
[2025-08-06 20:49:43,482][__main__][INFO] - Saved metadata: {'timestamp': 1754527783.476463, 'slurm_job_id': '28962839', 'batch_size': 236, 'num_devices': 1, 'effective_batch_size': 236}
[2025-08-06 20:49:43,940][__main__][INFO] - === STARTING TRAINING ===
[2025-08-06 20:49:43,957][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 21:10:17,827][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 21:10:17,828][__main__][INFO] - === STARTING EXPERIMENT: resnet101_filt_4gpu ===
[2025-08-06 21:10:17,828][__main__][INFO] - PID: 301137
[2025-08-06 21:10:17,828][__main__][INFO] - SLURM_JOB_ID: 28962714
[2025-08-06 21:10:17,828][__main__][INFO] - Architecture: resnet101
[2025-08-06 21:10:17,828][__main__][INFO] - Embedding Dim: 64
[2025-08-06 21:10:17,828][__main__][INFO] - Learning Rate: 0.001
[2025-08-06 21:10:17,828][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-06 21:10:17,828][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-06 21:10:17,828][__main__][INFO] - Use LSTM: False
[2025-08-06 21:10:17,829][__main__][INFO] - Dataset: d=19, rounds_max=19, p=2.1
[2025-08-06 21:10:17,829][__main__][INFO] - Accelerator: auto
[2025-08-06 21:10:17,829][__main__][INFO] - Devices: auto
[2025-08-06 21:10:17,829][__main__][INFO] - Strategy: auto
[2025-08-06 21:10:17,829][__main__][INFO] - Num Nodes: 1
[2025-08-06 21:10:17,829][__main__][INFO] - Sync BatchNorm: True
[2025-08-06 21:10:17,829][__main__][INFO] - MWPM filtering: True
[2025-08-06 21:10:17,829][__main__][INFO] - Batch Size: auto-tuned
[2025-08-06 21:10:17,829][__main__][INFO] - Precision: bf16-mixed
[2025-08-06 21:10:17,829][__main__][INFO] - Max Steps: 50000
[2025-08-06 21:10:17,829][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-06 21:10:17,829][__main__][INFO] - Log every 100 steps
[2025-08-06 21:10:17,829][__main__][INFO] - Num Workers: 15
[2025-08-06 21:10:17,829][__main__][INFO] - Prefetch Factor: 4
[2025-08-06 21:10:17,829][__main__][INFO] - Persistent Workers: True
[2025-08-06 21:10:17,829][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/resnet101_filt_4gpu
[2025-08-06 21:10:17,849][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-06 21:10:17,849][__main__][INFO] - Initializing wandb logger with params
[2025-08-06 21:10:20,963][__main__][INFO] - Saved new W&B run ID to file: wqqx9gan
[2025-08-06 21:10:21,089][__main__][INFO] - === AUTO-TUNING BATCH SIZE ===
=
[2025-08-06 21:10:20,552][__main__][INFO] - PID: 2020253
[2025-08-06 21:10:20,552][__main__][INFO] - SLURM_JOB_ID: 28964162
[2025-08-06 21:10:20,552][__main__][INFO] - Architecture: resnet50
[2025-08-06 21:10:20,552][__main__][INFO] - Embedding Dim: 64
[2025-08-06 21:10:20,552][__main__][INFO] - Learning Rate: 0.0003
[2025-08-06 21:10:20,552][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-06 21:10:20,553][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-06 21:10:20,553][__main__][INFO] - Use LSTM: False
[2025-08-06 21:10:20,553][__main__][INFO] - Dataset: d=19, rounds_max=19, p=1.0
[2025-08-06 21:10:20,553][__main__][INFO] - Accelerator: auto
[2025-08-06 21:10:20,553][__main__][INFO] - Devices: auto
[2025-08-06 21:10:20,553][__main__][INFO] - Strategy: auto
[2025-08-06 21:10:20,553][__main__][INFO] - Num Nodes: 1
[2025-08-06 21:10:20,553][__main__][INFO] - Sync BatchNorm: True
[2025-08-06 21:10:20,553][__main__][INFO] - MWPM filtering: False
[2025-08-06 21:10:20,553][__main__][INFO] - Batch Size: auto-tuned
[2025-08-06 21:10:20,553][__main__][INFO] - Precision: bf16-mixed
[2025-08-06 21:10:20,553][__main__][INFO] - Max Steps: 50000
[2025-08-06 21:10:20,554][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-06 21:10:20,554][__main__][INFO] - Log every 100 steps
[2025-08-06 21:10:20,554][__main__][INFO] - Num Workers: 15
[2025-08-06 21:10:20,554][__main__][INFO] - Prefetch Factor: 4
[2025-08-06 21:10:20,554][__main__][INFO] - Persistent Workers: True
[2025-08-06 21:10:20,554][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/resnet50_lowp
[2025-08-06 21:10:20,565][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-06 21:10:20,565][__main__][INFO] - Initializing wandb logger with params
[2025-08-06 21:10:25,150][__main__][INFO] - Saved new W&B run ID to file: xpmg2cnz
[2025-08-06 21:10:25,324][__main__][INFO] - === AUTO-TUNING BATCH SIZE ===
[2025-08-06 21:10:26,296][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 21:11:58,903][__main__][INFO] - Found optimal batch size 296
[2025-08-06 21:11:58,912][__main__][INFO] - Saved batch size 236 to file
[2025-08-06 21:11:58,913][__main__][INFO] - Optimal per-GPU batch size found: 236
[2025-08-06 21:11:58,913][__main__][INFO] - Effective total batch size across 1 device(s): 236
[2025-08-06 21:11:58,919][__main__][INFO] - Saved metadata: {'timestamp': 1754529118.9132912, 'slurm_job_id': '28964162', 'batch_size': 236, 'num_devices': 1, 'effective_batch_size': 236}
[2025-08-06 21:11:59,350][__main__][INFO] - === STARTING TRAINING ===
[2025-08-06 21:11:59,365][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 21:14:59,650][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 21:14:59,652][__main__][INFO] - === STARTING EXPERIMENT: resnet101_filt_4gpu ===
[2025-08-06 21:14:59,652][__main__][INFO] - PID: 2133471
[2025-08-06 21:14:59,652][__main__][INFO] - SLURM_JOB_ID: 28962714
[2025-08-06 21:14:59,652][__main__][INFO] - Architecture: resnet101
[2025-08-06 21:14:59,652][__main__][INFO] - Embedding Dim: 64
[2025-08-06 21:14:59,652][__main__][INFO] - Learning Rate: 0.001
[2025-08-06 21:14:59,652][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-06 21:14:59,652][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-06 21:14:59,652][__main__][INFO] - Use LSTM: False
[2025-08-06 21:14:59,652][__main__][INFO] - Dataset: d=19, rounds_max=19, p=2.1
[2025-08-06 21:14:59,652][__main__][INFO] - Accelerator: auto
[2025-08-06 21:14:59,652][__main__][INFO] - Devices: auto
[2025-08-06 21:14:59,652][__main__][INFO] - Strategy: auto
[2025-08-06 21:14:59,652][__main__][INFO] - Num Nodes: 1
[2025-08-06 21:14:59,652][__main__][INFO] - Sync BatchNorm: True
[2025-08-06 21:14:59,653][__main__][INFO] - MWPM filtering: True
[2025-08-06 21:14:59,653][__main__][INFO] - Batch Size: auto-tuned
[2025-08-06 21:14:59,653][__main__][INFO] - Precision: bf16-mixed
[2025-08-06 21:14:59,653][__main__][INFO] - Max Steps: 50000
[2025-08-06 21:14:59,653][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-06 21:14:59,653][__main__][INFO] - Log every 100 steps
[2025-08-06 21:14:59,653][__main__][INFO] - Num Workers: 15
[2025-08-06 21:14:59,653][__main__][INFO] - Prefetch Factor: 4
[2025-08-06 21:14:59,653][__main__][INFO] - Persistent Workers: True
[2025-08-06 21:14:59,653][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/resnet101_filt_4gpu
[2025-08-06 21:14:59,674][__main__][INFO] - Loaded W&B run ID from file: wqqx9gan
[2025-08-06 21:14:59,674][__main__][INFO] - Setting up W&B logger with existing run ID: wqqx9gan
[2025-08-06 21:14:59,674][__main__][INFO] - Initializing wandb logger with params
[2025-08-06 21:14:59,849][__main__][INFO] - === AUTO-TUNING BATCH SIZE ===
[2025-08-06 21:15:02,689][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 21:15:57,575][__main__][INFO] - === TRAINING COMPLETED SUCCESSFULLY ===
[2025-08-06 21:22:11,189][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 21:22:11,190][__main__][INFO] - === STARTING EXPERIMENT: resnet101_filt_4gpu ===
[2025-08-06 21:22:11,190][__main__][INFO] - PID: 555437
[2025-08-06 21:22:11,190][__main__][INFO] - SLURM_JOB_ID: 28962714
[2025-08-06 21:22:11,190][__main__][INFO] - Architecture: resnet101
[2025-08-06 21:22:11,190][__main__][INFO] - Embedding Dim: 64
[2025-08-06 21:22:11,190][__main__][INFO] - Learning Rate: 0.001
[2025-08-06 21:22:11,190][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-06 21:22:11,190][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-06 21:22:11,190][__main__][INFO] - Use LSTM: False
[2025-08-06 21:22:11,191][__main__][INFO] - Dataset: d=19, rounds_max=19, p=2.1
[2025-08-06 21:22:11,191][__main__][INFO] - Accelerator: auto
[2025-08-06 21:22:11,191][__main__][INFO] - Devices: auto
[2025-08-06 21:22:11,191][__main__][INFO] - Strategy: auto
[2025-08-06 21:22:11,191][__main__][INFO] - Num Nodes: 1
[2025-08-06 21:22:11,191][__main__][INFO] - Sync BatchNorm: True
[2025-08-06 21:22:11,191][__main__][INFO] - MWPM filtering: True
[2025-08-06 21:22:11,191][__main__][INFO] - Batch Size: auto-tuned
[2025-08-06 21:22:11,191][__main__][INFO] - Precision: bf16-mixed
[2025-08-06 21:22:11,191][__main__][INFO] - Max Steps: 50000
[2025-08-06 21:22:11,191][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-06 21:22:11,191][__main__][INFO] - Log every 100 steps
[2025-08-06 21:22:11,191][__main__][INFO] - Num Workers: 15
[2025-08-06 21:22:11,191][__main__][INFO] - Prefetch Factor: 4
[2025-08-06 21:22:11,191][__main__][INFO] - Persistent Workers: True
[2025-08-06 21:22:11,191][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/resnet101_filt_4gpu
[2025-08-06 21:22:11,209][__main__][INFO] - Loaded W&B run ID from file: wqqx9gan
[2025-08-06 21:22:11,209][__main__][INFO] - Setting up W&B logger with existing run ID: wqqx9gan
[2025-08-06 21:22:11,209][__main__][INFO] - Initializing wandb logger with params
[2025-08-06 21:22:11,339][__main__][INFO] - === AUTO-TUNING BATCH SIZE ===
[2025-08-06 21:22:14,125][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 21:27:59,501][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 21:27:59,502][__main__][INFO] - === STARTING EXPERIMENT: resnet50_lstm_1gpu ===
[2025-08-06 21:27:59,502][__main__][INFO] - PID: 2560904
[2025-08-06 21:27:59,502][__main__][INFO] - SLURM_JOB_ID: 28962839
[2025-08-06 21:27:59,502][__main__][INFO] - Architecture: resnet50
[2025-08-06 21:27:59,502][__main__][INFO] - Embedding Dim: 64
[2025-08-06 21:27:59,502][__main__][INFO] - Learning Rate: 0.0003
[2025-08-06 21:27:59,502][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-06 21:27:59,502][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-06 21:27:59,502][__main__][INFO] - Use LSTM: True
[2025-08-06 21:27:59,502][__main__][INFO] - Dataset: d=19, rounds_max=19, p=2.1
[2025-08-06 21:27:59,502][__main__][INFO] - Accelerator: auto
[2025-08-06 21:27:59,502][__main__][INFO] - Devices: auto
[2025-08-06 21:27:59,502][__main__][INFO] - Strategy: auto
[2025-08-06 21:27:59,502][__main__][INFO] - Num Nodes: 1
[2025-08-06 21:27:59,502][__main__][INFO] - Sync BatchNorm: True
[2025-08-06 21:27:59,502][__main__][INFO] - MWPM filtering: True
[2025-08-06 21:27:59,502][__main__][INFO] - Batch Size: auto-tuned
[2025-08-06 21:27:59,502][__main__][INFO] - Precision: bf16-mixed
[2025-08-06 21:27:59,502][__main__][INFO] - Max Steps: 50000
[2025-08-06 21:27:59,503][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-06 21:27:59,503][__main__][INFO] - Log every 100 steps
[2025-08-06 21:27:59,503][__main__][INFO] - Num Workers: 15
[2025-08-06 21:27:59,503][__main__][INFO] - Prefetch Factor: 4
[2025-08-06 21:27:59,503][__main__][INFO] - Persistent Workers: True
[2025-08-06 21:27:59,503][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/resnet50_lstm_1gpu
[2025-08-06 21:27:59,502][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 21:27:59,503][__main__][INFO] - === STARTING EXPERIMENT: resnet50_lowp ===
[2025-08-06 21:27:59,503][__main__][INFO] - PID: 2560905
[2025-08-06 21:27:59,503][__main__][INFO] - SLURM_JOB_ID: 28964162
[2025-08-06 21:27:59,503][__main__][INFO] - Architecture: resnet50
[2025-08-06 21:27:59,503][__main__][INFO] - Embedding Dim: 64
[2025-08-06 21:27:59,503][__main__][INFO] - Learning Rate: 0.0003
[2025-08-06 21:27:59,503][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-06 21:27:59,504][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-06 21:27:59,504][__main__][INFO] - Use LSTM: False
[2025-08-06 21:27:59,504][__main__][INFO] - Dataset: d=19, rounds_max=19, p=1.0
[2025-08-06 21:27:59,504][__main__][INFO] - Accelerator: auto
[2025-08-06 21:27:59,504][__main__][INFO] - Devices: auto
[2025-08-06 21:27:59,504][__main__][INFO] - Strategy: auto
[2025-08-06 21:27:59,504][__main__][INFO] - Num Nodes: 1
[2025-08-06 21:27:59,504][__main__][INFO] - Sync BatchNorm: True
[2025-08-06 21:27:59,504][__main__][INFO] - MWPM filtering: False
[2025-08-06 21:27:59,504][__main__][INFO] - Batch Size: auto-tuned
[2025-08-06 21:27:59,504][__main__][INFO] - Precision: bf16-mixed
[2025-08-06 21:27:59,504][__main__][INFO] - Max Steps: 50000
[2025-08-06 21:27:59,504][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-06 21:27:59,504][__main__][INFO] - Log every 100 steps
[2025-08-06 21:27:59,504][__main__][INFO] - Num Workers: 15
[2025-08-06 21:27:59,504][__main__][INFO] - Prefetch Factor: 4
[2025-08-06 21:27:59,504][__main__][INFO] - Persistent Workers: True
[2025-08-06 21:27:59,504][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/resnet50_lowp
[2025-08-06 21:27:59,525][__main__][INFO] - Loaded W&B run ID from file: xpmg2cnz
[2025-08-06 21:27:59,525][__main__][INFO] - Setting up W&B logger with existing run ID: xpmg2cnz
[2025-08-06 21:27:59,526][__main__][INFO] - Initializing wandb logger with params
[2025-08-06 21:27:59,528][__main__][INFO] - Found latest checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/resnet50_lstm_1gpu/checkpoints/resnet50_lstm_1gpu-7504-0.4707.ckpt
[2025-08-06 21:27:59,531][__main__][INFO] - Loaded W&B run ID from file: xgqhejsy
[2025-08-06 21:27:59,531][__main__][INFO] - Setting up W&B logger with existing run ID: xgqhejsy
[2025-08-06 21:27:59,531][__main__][INFO] - Initializing wandb logger with params
[2025-08-06 21:27:59,656][__main__][INFO] - Loaded batch size 236 from file
[2025-08-06 21:27:59,659][__main__][INFO] - Loaded batch size 236 from file
[2025-08-06 21:27:59,763][__main__][INFO] - === STARTING TRAINING ===
[2025-08-06 21:27:59,763][__main__][INFO] - Resuming from checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/resnet50_lstm_1gpu/checkpoints/resnet50_lstm_1gpu-7504-0.4707.ckpt
[2025-08-06 21:27:59,764][__main__][INFO] - === STARTING TRAINING ===
[2025-08-06 21:28:04,010][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 21:28:04,010][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 21:50:35,687][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 21:50:35,687][__main__][INFO] - === STARTING EXPERIMENT: d7-extrap ===
[2025-08-06 21:50:35,687][__main__][INFO] - PID: 1661508
[2025-08-06 21:50:35,687][__main__][INFO] - SLURM_JOB_ID: 28965458
[2025-08-06 21:50:35,687][__main__][INFO] - Architecture: resnet50
[2025-08-06 21:50:35,687][__main__][INFO] - Embedding Dim: 64
[2025-08-06 21:50:35,687][__main__][INFO] - Learning Rate: 0.001
[2025-08-06 21:50:35,688][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-06 21:50:35,688][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-06 21:50:35,688][__main__][INFO] - Use LSTM: False
[2025-08-06 21:50:35,688][__main__][INFO] - Dataset: d=7, rounds_max=7, p=1.0
[2025-08-06 21:50:35,688][__main__][INFO] - Accelerator: auto
[2025-08-06 21:50:35,688][__main__][INFO] - Devices: auto
[2025-08-06 21:50:35,688][__main__][INFO] - Strategy: auto
[2025-08-06 21:50:35,688][__main__][INFO] - Num Nodes: 1
[2025-08-06 21:50:35,688][__main__][INFO] - Sync BatchNorm: True
[2025-08-06 21:50:35,688][__main__][INFO] - MWPM filtering: False
[2025-08-06 21:50:35,688][__main__][INFO] - Batch Size: 512
[2025-08-06 21:50:35,688][__main__][INFO] - Precision: bf16-mixed
[2025-08-06 21:50:35,688][__main__][INFO] - Max Steps: 50000
[2025-08-06 21:50:35,689][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-06 21:50:35,689][__main__][INFO] - Log every 100 steps
[2025-08-06 21:50:35,689][__main__][INFO] - Num Workers: 11
[2025-08-06 21:50:35,689][__main__][INFO] - Prefetch Factor: 4
[2025-08-06 21:50:35,689][__main__][INFO] - Persistent Workers: True
[2025-08-06 21:50:35,689][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d7-extrap
[2025-08-06 21:50:35,708][__main__][INFO] - W&B logging disabled in config
[2025-08-06 21:50:35,798][__main__][INFO] - Using manual batch size from config: 512
[2025-08-06 21:50:35,886][__main__][INFO] - === STARTING TRAINING ===
[2025-08-06 21:50:35,903][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 22:15:42,166][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 22:15:42,167][__main__][INFO] - === STARTING EXPERIMENT: resnet50_lstm_1gpu ===
[2025-08-06 22:15:42,167][__main__][INFO] - PID: 2609491
[2025-08-06 22:15:42,167][__main__][INFO] - SLURM_JOB_ID: 28962839
[2025-08-06 22:15:42,167][__main__][INFO] - Architecture: resnet50
[2025-08-06 22:15:42,167][__main__][INFO] - Embedding Dim: 64
[2025-08-06 22:15:42,167][__main__][INFO] - Learning Rate: 0.0003
[2025-08-06 22:15:42,168][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-06 22:15:42,168][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-06 22:15:42,168][__main__][INFO] - Use LSTM: True
[2025-08-06 22:15:42,168][__main__][INFO] - Dataset: d=19, rounds_max=19, p=2.1
[2025-08-06 22:15:42,168][__main__][INFO] - Accelerator: auto
[2025-08-06 22:15:42,168][__main__][INFO] - Devices: auto
[2025-08-06 22:15:42,168][__main__][INFO] - Strategy: auto
[2025-08-06 22:15:42,168][__main__][INFO] - Num Nodes: 1
[2025-08-06 22:15:42,168][__main__][INFO] - Sync BatchNorm: True
[2025-08-06 22:15:42,168][__main__][INFO] - MWPM filtering: True
[2025-08-06 22:15:42,168][__main__][INFO] - Batch Size: auto-tuned
[2025-08-06 22:15:42,168][__main__][INFO] - Precision: bf16-mixed
[2025-08-06 22:15:42,168][__main__][INFO] - Max Steps: 50000
[2025-08-06 22:15:42,168][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-06 22:15:42,168][__main__][INFO] - Log every 100 steps
[2025-08-06 22:15:42,168][__main__][INFO] - Num Workers: 15
[2025-08-06 22:15:42,168][__main__][INFO] - Prefetch Factor: 4
[2025-08-06 22:15:42,168][__main__][INFO] - Persistent Workers: True
[2025-08-06 22:15:42,168][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/resnet50_lstm_1gpu
[2025-08-06 22:15:42,189][__main__][INFO] - Found latest checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/resnet50_lstm_1gpu/checkpoints/resnet50_lstm_1gpu-14980-0.3562.ckpt
[2025-08-06 22:15:42,192][__main__][INFO] - Loaded W&B run ID from file: xgqhejsy
[2025-08-06 22:15:42,192][__main__][INFO] - Setting up W&B logger with existing run ID: xgqhejsy
[2025-08-06 22:15:42,192][__main__][INFO] - Initializing wandb logger with params
[2025-08-06 22:15:42,330][__main__][INFO] - Loaded batch size 236 from file
[2025-08-06 22:15:42,421][__main__][INFO] - === STARTING TRAINING ===
[2025-08-06 22:15:42,422][__main__][INFO] - Resuming from checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/resnet50_lstm_1gpu/checkpoints/resnet50_lstm_1gpu-14980-0.3562.ckpt
[2025-08-06 22:15:47,429][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 22:22:21,348][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 22:22:21,349][__main__][INFO] - === STARTING EXPERIMENT: 50_no_chunk ===
[2025-08-06 22:22:21,349][__main__][INFO] - PID: 586343
[2025-08-06 22:22:21,349][__main__][INFO] - SLURM_JOB_ID: 28966327
[2025-08-06 22:22:21,349][__main__][INFO] - Architecture: resnet50
[2025-08-06 22:22:21,349][__main__][INFO] - Embedding Dim: 64
[2025-08-06 22:22:21,350][__main__][INFO] - Learning Rate: 0.0003
[2025-08-06 22:22:21,350][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-06 22:22:21,350][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-06 22:22:21,350][__main__][INFO] - Use LSTM: False
[2025-08-06 22:22:21,350][__main__][INFO] - Dataset: d=19, rounds_max=19, p=2.1
[2025-08-06 22:22:21,350][__main__][INFO] - Accelerator: auto
[2025-08-06 22:22:21,350][__main__][INFO] - Devices: auto
[2025-08-06 22:22:21,350][__main__][INFO] - Strategy: auto
[2025-08-06 22:22:21,350][__main__][INFO] - Num Nodes: 1
[2025-08-06 22:22:21,350][__main__][INFO] - Sync BatchNorm: True
[2025-08-06 22:22:21,350][__main__][INFO] - MWPM filtering: True
[2025-08-06 22:22:21,350][__main__][INFO] - Batch Size: auto-tuned
[2025-08-06 22:22:21,350][__main__][INFO] - Precision: bf16-mixed
[2025-08-06 22:22:21,350][__main__][INFO] - Max Steps: 50000
[2025-08-06 22:22:21,350][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-06 22:22:21,350][__main__][INFO] - Log every 100 steps
[2025-08-06 22:22:21,350][__main__][INFO] - Num Workers: 15
[2025-08-06 22:22:21,350][__main__][INFO] - Prefetch Factor: 4
[2025-08-06 22:22:21,350][__main__][INFO] - Persistent Workers: True
[2025-08-06 22:22:21,351][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/50_no_chunk
[2025-08-06 22:22:21,364][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-06 22:22:21,364][__main__][INFO] - Initializing wandb logger with params
[2025-08-06 22:22:23,513][__main__][INFO] - Saved new W&B run ID to file: b7dvoeri
[2025-08-06 22:22:23,591][__main__][INFO] - === AUTO-TUNING BATCH SIZE ===
[2025-08-06 22:22:26,466][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 22:23:37,997][__main__][INFO] - Found optimal batch size 72
[2025-08-06 22:23:38,011][__main__][INFO] - Saved batch size 57 to file
[2025-08-06 22:23:38,011][__main__][INFO] - Optimal per-GPU batch size found: 57
[2025-08-06 22:23:38,011][__main__][INFO] - Effective total batch size across 4 device(s): 228
[2025-08-06 22:23:38,016][__main__][INFO] - Saved metadata: {'timestamp': 1754533418.0113318, 'slurm_job_id': '28966327', 'batch_size': 57, 'num_devices': 4, 'effective_batch_size': 228}
[2025-08-06 22:23:38,431][__main__][INFO] - === STARTING TRAINING ===
[2025-08-06 22:24:31,486][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 22:26:47,585][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 22:26:47,587][__main__][INFO] - === STARTING EXPERIMENT: resnet101_filt_4gpu ===
[2025-08-06 22:26:47,587][__main__][INFO] - PID: 333025
[2025-08-06 22:26:47,587][__main__][INFO] - SLURM_JOB_ID: 28962714
[2025-08-06 22:26:47,587][__main__][INFO] - Architecture: resnet101
[2025-08-06 22:26:47,587][__main__][INFO] - Embedding Dim: 64
[2025-08-06 22:26:47,587][__main__][INFO] - Learning Rate: 0.001
[2025-08-06 22:26:47,587][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-06 22:26:47,587][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-06 22:26:47,587][__main__][INFO] - Use LSTM: False
[2025-08-06 22:26:47,587][__main__][INFO] - Dataset: d=19, rounds_max=19, p=2.1
[2025-08-06 22:26:47,587][__main__][INFO] - Accelerator: auto
[2025-08-06 22:26:47,587][__main__][INFO] - Devices: auto
[2025-08-06 22:26:47,587][__main__][INFO] - Strategy: auto
[2025-08-06 22:26:47,587][__main__][INFO] - Num Nodes: 1
[2025-08-06 22:26:47,588][__main__][INFO] - Sync BatchNorm: True
[2025-08-06 22:26:47,588][__main__][INFO] - MWPM filtering: True
[2025-08-06 22:26:47,588][__main__][INFO] - Batch Size: auto-tuned
[2025-08-06 22:26:47,588][__main__][INFO] - Precision: bf16-mixed
[2025-08-06 22:26:47,588][__main__][INFO] - Max Steps: 50000
[2025-08-06 22:26:47,588][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-06 22:26:47,588][__main__][INFO] - Log every 100 steps
[2025-08-06 22:26:47,588][__main__][INFO] - Num Workers: 15
[2025-08-06 22:26:47,588][__main__][INFO] - Prefetch Factor: 4
[2025-08-06 22:26:47,588][__main__][INFO] - Persistent Workers: True
[2025-08-06 22:26:47,588][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/resnet101_filt_4gpu
[2025-08-06 22:26:47,598][__main__][INFO] - Loaded W&B run ID from file: wqqx9gan
[2025-08-06 22:26:47,598][__main__][INFO] - Setting up W&B logger with existing run ID: wqqx9gan
[2025-08-06 22:26:47,598][__main__][INFO] - Initializing wandb logger with params
[2025-08-06 22:26:47,730][__main__][INFO] - === AUTO-TUNING BATCH SIZE ===
[2025-08-06 22:26:55,508][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 22:28:30,936][__main__][INFO] - Found optimal batch size 142
[2025-08-06 22:28:30,950][__main__][INFO] - Saved batch size 113 to file
[2025-08-06 22:28:30,950][__main__][INFO] - Optimal per-GPU batch size found: 113
[2025-08-06 22:28:30,950][__main__][INFO] - Effective total batch size across 4 device(s): 452
[2025-08-06 22:28:30,957][__main__][INFO] - Saved metadata: {'timestamp': 1754533710.9502654, 'slurm_job_id': '28962714', 'batch_size': 113, 'num_devices': 4, 'effective_batch_size': 452}
[2025-08-06 22:28:33,998][__main__][INFO] - === STARTING TRAINING ===
[2025-08-06 22:29:47,892][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 22:31:29,250][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 22:31:29,251][__main__][INFO] - === STARTING EXPERIMENT: 50_no_chunk ===
[2025-08-06 22:31:29,251][__main__][INFO] - PID: 3901536
[2025-08-06 22:31:29,251][__main__][INFO] - SLURM_JOB_ID: 28966327
[2025-08-06 22:31:29,251][__main__][INFO] - Architecture: resnet50
[2025-08-06 22:31:29,251][__main__][INFO] - Embedding Dim: 64
[2025-08-06 22:31:29,251][__main__][INFO] - Learning Rate: 0.0003
[2025-08-06 22:31:29,251][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-06 22:31:29,251][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-06 22:31:29,252][__main__][INFO] - Use LSTM: False
[2025-08-06 22:31:29,252][__main__][INFO] - Dataset: d=19, rounds_max=19, p=2.1
[2025-08-06 22:31:29,252][__main__][INFO] - Accelerator: auto
[2025-08-06 22:31:29,252][__main__][INFO] - Devices: auto
[2025-08-06 22:31:29,252][__main__][INFO] - Strategy: auto
[2025-08-06 22:31:29,252][__main__][INFO] - Num Nodes: 1
[2025-08-06 22:31:29,252][__main__][INFO] - Sync BatchNorm: True
[2025-08-06 22:31:29,252][__main__][INFO] - MWPM filtering: True
[2025-08-06 22:31:29,252][__main__][INFO] - Batch Size: auto-tuned
[2025-08-06 22:31:29,252][__main__][INFO] - Precision: bf16-mixed
[2025-08-06 22:31:29,252][__main__][INFO] - Max Steps: 50000
[2025-08-06 22:31:29,252][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-06 22:31:29,252][__main__][INFO] - Log every 100 steps
[2025-08-06 22:31:29,252][__main__][INFO] - Num Workers: 15
[2025-08-06 22:31:29,252][__main__][INFO] - Prefetch Factor: 4
[2025-08-06 22:31:29,252][__main__][INFO] - Persistent Workers: True
[2025-08-06 22:31:29,252][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/50_no_chunk
[2025-08-06 22:31:29,278][__main__][INFO] - Loaded W&B run ID from file: b7dvoeri
[2025-08-06 22:31:29,278][__main__][INFO] - Setting up W&B logger with existing run ID: b7dvoeri
[2025-08-06 22:31:29,278][__main__][INFO] - Initializing wandb logger with params
[2025-08-06 22:31:29,364][__main__][INFO] - Loaded batch size 57 from file
[2025-08-06 22:31:29,445][__main__][INFO] - === STARTING TRAINING ===
[2025-08-06 22:32:04,361][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 22:42:09,565][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 22:42:09,565][__main__][INFO] - === STARTING EXPERIMENT: 50_no_chunk ===
[2025-08-06 22:42:09,565][__main__][INFO] - PID: 3832170
[2025-08-06 22:42:09,565][__main__][INFO] - SLURM_JOB_ID: 28966327
[2025-08-06 22:42:09,565][__main__][INFO] - Architecture: resnet50
[2025-08-06 22:42:09,566][__main__][INFO] - Embedding Dim: 64
[2025-08-06 22:42:09,566][__main__][INFO] - Learning Rate: 0.0003
[2025-08-06 22:42:09,566][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-06 22:42:09,566][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-06 22:42:09,566][__main__][INFO] - Use LSTM: False
[2025-08-06 22:42:09,566][__main__][INFO] - Dataset: d=19, rounds_max=19, p=2.1
[2025-08-06 22:42:09,566][__main__][INFO] - Accelerator: auto
[2025-08-06 22:42:09,566][__main__][INFO] - Devices: auto
[2025-08-06 22:42:09,566][__main__][INFO] - Strategy: auto
[2025-08-06 22:42:09,566][__main__][INFO] - Num Nodes: 1
[2025-08-06 22:42:09,566][__main__][INFO] - Sync BatchNorm: True
[2025-08-06 22:42:09,566][__main__][INFO] - MWPM filtering: True
[2025-08-06 22:42:09,566][__main__][INFO] - Batch Size: auto-tuned
[2025-08-06 22:42:09,566][__main__][INFO] - Precision: bf16-mixed
[2025-08-06 22:42:09,566][__main__][INFO] - Max Steps: 50000
[2025-08-06 22:42:09,566][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-06 22:42:09,566][__main__][INFO] - Log every 100 steps
[2025-08-06 22:42:09,566][__main__][INFO] - Num Workers: 15
[2025-08-06 22:42:09,566][__main__][INFO] - Prefetch Factor: 4
[2025-08-06 22:42:09,567][__main__][INFO] - Persistent Workers: True
[2025-08-06 22:42:09,567][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/50_no_chunk
[2025-08-06 22:42:09,588][__main__][INFO] - Loaded W&B run ID from file: b7dvoeri
[2025-08-06 22:42:09,589][__main__][INFO] - Setting up W&B logger with existing run ID: b7dvoeri
[2025-08-06 22:42:09,589][__main__][INFO] - Initializing wandb logger with params
[2025-08-06 22:42:09,671][__main__][INFO] - Loaded batch size 57 from file
[2025-08-06 22:42:09,759][__main__][INFO] - === STARTING TRAINING ===
[2025-08-06 22:42:46,624][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 22:50:42,169][__main__][ERROR] - === TRAINING FAILED: DataLoader worker (pid 2970306) is killed by signal: Terminated.  ===
[2025-08-06 22:52:42,846][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 22:52:42,846][__main__][INFO] - === STARTING EXPERIMENT: 50_no_chunk ===
[2025-08-06 22:52:42,846][__main__][INFO] - PID: 3918322
[2025-08-06 22:52:42,847][__main__][INFO] - SLURM_JOB_ID: 28966820
[2025-08-06 22:52:42,847][__main__][INFO] - Architecture: resnet50
[2025-08-06 22:52:42,847][__main__][INFO] - Embedding Dim: 64
[2025-08-06 22:52:42,847][__main__][INFO] - Learning Rate: 0.0003
[2025-08-06 22:52:42,847][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-06 22:52:42,847][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-06 22:52:42,847][__main__][INFO] - Use LSTM: False
[2025-08-06 22:52:42,847][__main__][INFO] - Dataset: d=9, rounds_max=19, p=2.1
[2025-08-06 22:52:42,847][__main__][INFO] - Accelerator: auto
[2025-08-06 22:52:42,847][__main__][INFO] - Devices: auto
[2025-08-06 22:52:42,847][__main__][INFO] - Strategy: auto
[2025-08-06 22:52:42,847][__main__][INFO] - Num Nodes: 1
[2025-08-06 22:52:42,847][__main__][INFO] - Sync BatchNorm: True
[2025-08-06 22:52:42,847][__main__][INFO] - MWPM filtering: False
[2025-08-06 22:52:42,847][__main__][INFO] - Batch Size: auto-tuned
[2025-08-06 22:52:42,847][__main__][INFO] - Precision: bf16-mixed
[2025-08-06 22:52:42,847][__main__][INFO] - Max Steps: 50000
[2025-08-06 22:52:42,847][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-06 22:52:42,848][__main__][INFO] - Log every 100 steps
[2025-08-06 22:52:42,848][__main__][INFO] - Num Workers: 15
[2025-08-06 22:52:42,848][__main__][INFO] - Prefetch Factor: 4
[2025-08-06 22:52:42,848][__main__][INFO] - Persistent Workers: True
[2025-08-06 22:52:42,848][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/50_no_chunk
[2025-08-06 22:52:42,868][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-06 22:52:42,869][__main__][INFO] - Initializing wandb logger with params
[2025-08-06 22:52:44,898][__main__][INFO] - Saved new W&B run ID to file: toi2sl1m
[2025-08-06 22:52:44,974][__main__][INFO] - === AUTO-TUNING BATCH SIZE ===
[2025-08-06 22:52:47,727][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 22:53:36,631][__main__][INFO] - Found optimal batch size 296
[2025-08-06 22:53:36,646][__main__][INFO] - Saved batch size 236 to file
[2025-08-06 22:53:36,646][__main__][INFO] - Optimal per-GPU batch size found: 236
[2025-08-06 22:53:36,646][__main__][INFO] - Effective total batch size across 4 device(s): 944
[2025-08-06 22:53:36,654][__main__][INFO] - Saved metadata: {'timestamp': 1754535216.6463408, 'slurm_job_id': '28966820', 'batch_size': 236, 'num_devices': 4, 'effective_batch_size': 944}
[2025-08-06 22:53:37,053][__main__][INFO] - === STARTING TRAINING ===
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               [2025-08-06 22:54:30,075][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 23:08:53,388][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 23:08:53,389][__main__][INFO] - === STARTING EXPERIMENT: resnet101_filt_4gpu ===
[2025-08-06 23:08:53,389][__main__][INFO] - PID: 3942100
[2025-08-06 23:08:53,389][__main__][INFO] - SLURM_JOB_ID: 28962714
[2025-08-06 23:08:53,389][__main__][INFO] - Architecture: resnet101
[2025-08-06 23:08:53,389][__main__][INFO] - Embedding Dim: 64
[2025-08-06 23:08:53,389][__main__][INFO] - Learning Rate: 0.001
[2025-08-06 23:08:53,389][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-06 23:08:53,390][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-06 23:08:53,390][__main__][INFO] - Use LSTM: False
[2025-08-06 23:08:53,390][__main__][INFO] - Dataset: d=19, rounds_max=19, p=2.1
[2025-08-06 23:08:53,390][__main__][INFO] - Accelerator: auto
[2025-08-06 23:08:53,390][__main__][INFO] - Devices: auto
[2025-08-06 23:08:53,390][__main__][INFO] - Strategy: auto
[2025-08-06 23:08:53,390][__main__][INFO] - Num Nodes: 1
[2025-08-06 23:08:53,390][__main__][INFO] - Sync BatchNorm: True
[2025-08-06 23:08:53,390][__main__][INFO] - MWPM filtering: True
[2025-08-06 23:08:53,390][__main__][INFO] - Batch Size: auto-tuned
[2025-08-06 23:08:53,390][__main__][INFO] - Precision: bf16-mixed
[2025-08-06 23:08:53,390][__main__][INFO] - Max Steps: 50000
[2025-08-06 23:08:53,390][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-06 23:08:53,390][__main__][INFO] - Log every 100 steps
[2025-08-06 23:08:53,390][__main__][INFO] - Num Workers: 15
[2025-08-06 23:08:53,390][__main__][INFO] - Prefetch Factor: 4
[2025-08-06 23:08:53,390][__main__][INFO] - Persistent Workers: True
[2025-08-06 23:08:53,390][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/resnet101_filt_4gpu
[2025-08-06 23:08:53,411][__main__][INFO] - Loaded W&B run ID from file: wqqx9gan
[2025-08-06 23:08:53,411][__main__][INFO] - Setting up W&B logger with existing run ID: wqqx9gan
[2025-08-06 23:08:53,411][__main__][INFO] - Initializing wandb logger with params
[2025-08-06 23:08:53,598][__main__][INFO] - Loaded batch size 113 from file
[2025-08-06 23:08:53,699][__main__][INFO] - === STARTING TRAINING ===
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                [2025-08-06 23:09:49,817][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 23:18:34,101][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 23:18:34,102][__main__][INFO] - === STARTING EXPERIMENT: 50_no_chunk ===
[2025-08-06 23:18:34,102][__main__][INFO] - PID: 854159
[2025-08-06 23:18:34,102][__main__][INFO] - SLURM_JOB_ID: 28966820
[2025-08-06 23:18:34,102][__main__][INFO] - Architecture: resnet50
[2025-08-06 23:18:34,102][__main__][INFO] - Embedding Dim: 64
[2025-08-06 23:18:34,102][__main__][INFO] - Learning Rate: 0.0003
[2025-08-06 23:18:34,102][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-06 23:18:34,103][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-06 23:18:34,103][__main__][INFO] - Use LSTM: False
[2025-08-06 23:18:34,103][__main__][INFO] - Dataset: d=9, rounds_max=19, p=2.1
[2025-08-06 23:18:34,103][__main__][INFO] - Accelerator: auto
[2025-08-06 23:18:34,103][__main__][INFO] - Devices: auto
[2025-08-06 23:18:34,103][__main__][INFO] - Strategy: auto
[2025-08-06 23:18:34,103][__main__][INFO] - Num Nodes: 1
[2025-08-06 23:18:34,103][__main__][INFO] - Sync BatchNorm: True
[2025-08-06 23:18:34,103][__main__][INFO] - MWPM filtering: False
[2025-08-06 23:18:34,103][__main__][INFO] - Batch Size: auto-tuned
[2025-08-06 23:18:34,103][__main__][INFO] - Precision: bf16-mixed
[2025-08-06 23:18:34,103][__main__][INFO] - Max Steps: 50000
[2025-08-06 23:18:34,103][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-06 23:18:34,103][__main__][INFO] - Log every 100 steps
[2025-08-06 23:18:34,103][__main__][INFO] - Num Workers: 15
[2025-08-06 23:18:34,103][__main__][INFO] - Prefetch Factor: 4
[2025-08-06 23:18:34,103][__main__][INFO] - Persistent Workers: True
[2025-08-06 23:18:34,103][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/50_no_chunk
[2025-08-06 23:18:34,128][__main__][INFO] - Loaded W&B run ID from file: toi2sl1m
[2025-08-06 23:18:34,128][__main__][INFO] - Setting up W&B logger with existing run ID: toi2sl1m
[2025-08-06 23:18:34,128][__main__][INFO] - Initializing wandb logger with params
[2025-08-06 23:18:34,212][__main__][INFO] - Loaded batch size 236 from file
[2025-08-06 23:18:34,292][__main__][INFO] - === STARTING TRAINING ===
[2025-08-06 23:19:09,519][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 23:42:09,088][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-06 23:42:09,089][__main__][INFO] - === STARTING EXPERIMENT: 50_no_chunk ===
[2025-08-06 23:42:09,089][__main__][INFO] - PID: 4164131
[2025-08-06 23:42:09,089][__main__][INFO] - SLURM_JOB_ID: 28966820
[2025-08-06 23:42:09,089][__main__][INFO] - Architecture: resnet50
[2025-08-06 23:42:09,089][__main__][INFO] - Embedding Dim: 64
[2025-08-06 23:42:09,089][__main__][INFO] - Learning Rate: 0.0003
[2025-08-06 23:42:09,089][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-06 23:42:09,089][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-06 23:42:09,090][__main__][INFO] - Use LSTM: False
[2025-08-06 23:42:09,090][__main__][INFO] - Dataset: d=9, rounds_max=19, p=2.1
[2025-08-06 23:42:09,090][__main__][INFO] - Accelerator: auto
[2025-08-06 23:42:09,090][__main__][INFO] - Devices: auto
[2025-08-06 23:42:09,090][__main__][INFO] - Strategy: auto
[2025-08-06 23:42:09,090][__main__][INFO] - Num Nodes: 1
[2025-08-06 23:42:09,090][__main__][INFO] - Sync BatchNorm: True
[2025-08-06 23:42:09,090][__main__][INFO] - MWPM filtering: False
[2025-08-06 23:42:09,090][__main__][INFO] - Batch Size: auto-tuned
[2025-08-06 23:42:09,090][__main__][INFO] - Precision: bf16-mixed
[2025-08-06 23:42:09,090][__main__][INFO] - Max Steps: 50000
[2025-08-06 23:42:09,090][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-06 23:42:09,090][__main__][INFO] - Log every 100 steps
[2025-08-06 23:42:09,090][__main__][INFO] - Num Workers: 15
[2025-08-06 23:42:09,090][__main__][INFO] - Prefetch Factor: 4
[2025-08-06 23:42:09,090][__main__][INFO] - Persistent Workers: True
[2025-08-06 23:42:09,090][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/50_no_chunk
[2025-08-06 23:42:09,114][__main__][INFO] - Found latest checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/50_no_chunk/checkpoints/50_no_chunk-3295-0.1767.ckpt
[2025-08-06 23:42:09,117][__main__][INFO] - Loaded W&B run ID from file: toi2sl1m
[2025-08-06 23:42:09,117][__main__][INFO] - Setting up W&B logger with existing run ID: toi2sl1m
[2025-08-06 23:42:09,117][__main__][INFO] - Initializing wandb logger with params
[2025-08-06 23:42:09,208][__main__][INFO] - Loaded batch size 236 from file
[2025-08-06 23:42:09,287][__main__][INFO] - === STARTING TRAINING ===
[2025-08-06 23:42:09,287][__main__][INFO] - Resuming from checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/50_no_chunk/checkpoints/50_no_chunk-3295-0.1767.ckpt
[2025-08-06 23:43:02,501][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 00:00:26,269][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 00:00:26,269][__main__][INFO] - === STARTING EXPERIMENT: resnet101_filt_4gpu ===
[2025-08-07 00:00:26,269][__main__][INFO] - PID: 3950657
[2025-08-07 00:00:26,269][__main__][INFO] - SLURM_JOB_ID: 28962714
[2025-08-07 00:00:26,269][__main__][INFO] - Architecture: resnet101
[2025-08-07 00:00:26,269][__main__][INFO] - Embedding Dim: 64
[2025-08-07 00:00:26,270][__main__][INFO] - Learning Rate: 0.001
[2025-08-07 00:00:26,270][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-07 00:00:26,270][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-07 00:00:26,270][__main__][INFO] - Use LSTM: False
[2025-08-07 00:00:26,270][__main__][INFO] - Dataset: d=19, rounds_max=19, p=2.1
[2025-08-07 00:00:26,270][__main__][INFO] - Accelerator: auto
[2025-08-07 00:00:26,270][__main__][INFO] - Devices: auto
[2025-08-07 00:00:26,270][__main__][INFO] - Strategy: auto
[2025-08-07 00:00:26,270][__main__][INFO] - Num Nodes: 1
[2025-08-07 00:00:26,270][__main__][INFO] - Sync BatchNorm: True
[2025-08-07 00:00:26,270][__main__][INFO] - MWPM filtering: True
[2025-08-07 00:00:26,270][__main__][INFO] - Batch Size: auto-tuned
[2025-08-07 00:00:26,270][__main__][INFO] - Precision: bf16-mixed
[2025-08-07 00:00:26,270][__main__][INFO] - Max Steps: 50000
[2025-08-07 00:00:26,270][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-07 00:00:26,270][__main__][INFO] - Log every 100 steps
[2025-08-07 00:00:26,270][__main__][INFO] - Num Workers: 15
[2025-08-07 00:00:26,270][__main__][INFO] - Prefetch Factor: 4
[2025-08-07 00:00:26,270][__main__][INFO] - Persistent Workers: True
[2025-08-07 00:00:26,271][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/resnet101_filt_4gpu
[2025-08-07 00:00:26,274][__main__][INFO] - Found latest checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/resnet101_filt_4gpu/checkpoints/resnet101_filt_4gpu-9319-0.2955.ckpt
[2025-08-07 00:00:26,275][__main__][INFO] - Loaded W&B run ID from file: wqqx9gan
[2025-08-07 00:00:26,276][__main__][INFO] - Setting up W&B logger with existing run ID: wqqx9gan
[2025-08-07 00:00:26,276][__main__][INFO] - Initializing wandb logger with params
[2025-08-07 00:00:26,407][__main__][INFO] - Loaded batch size 113 from file
[2025-08-07 00:00:26,485][__main__][INFO] - === STARTING TRAINING ===
[2025-08-07 00:00:26,485][__main__][INFO] - Resuming from checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/resnet101_filt_4gpu/checkpoints/resnet101_filt_4gpu-9319-0.2955.ckpt
[2025-08-07 00:01:01,726][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 00:15:53,971][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 00:15:53,973][__main__][INFO] - === STARTING EXPERIMENT: resnet101_filt_4gpu ===
[2025-08-07 00:15:53,973][__main__][INFO] - PID: 3941774
[2025-08-07 00:15:53,973][__main__][INFO] - SLURM_JOB_ID: 28962714
[2025-08-07 00:15:53,973][__main__][INFO] - Architecture: resnet101
[2025-08-07 00:15:53,973][__main__][INFO] - Embedding Dim: 64
[2025-08-07 00:15:53,973][__main__][INFO] - Learning Rate: 0.001
[2025-08-07 00:15:53,973][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-07 00:15:53,974][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-07 00:15:53,974][__main__][INFO] - Use LSTM: False
[2025-08-07 00:15:53,974][__main__][INFO] - Dataset: d=19, rounds_max=19, p=2.1
[2025-08-07 00:15:53,974][__main__][INFO] - Accelerator: auto
[2025-08-07 00:15:53,974][__main__][INFO] - Devices: auto
[2025-08-07 00:15:53,974][__main__][INFO] - Strategy: auto
[2025-08-07 00:15:53,974][__main__][INFO] - Num Nodes: 1
[2025-08-07 00:15:53,974][__main__][INFO] - Sync BatchNorm: True
[2025-08-07 00:15:53,974][__main__][INFO] - MWPM filtering: True
[2025-08-07 00:15:53,974][__main__][INFO] - Batch Size: auto-tuned
[2025-08-07 00:15:53,975][__main__][INFO] - Precision: bf16-mixed
[2025-08-07 00:15:53,975][__main__][INFO] - Max Steps: 50000
[2025-08-07 00:15:53,975][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-07 00:15:53,975][__main__][INFO] - Log every 100 steps
[2025-08-07 00:15:53,975][__main__][INFO] - Num Workers: 15
[2025-08-07 00:15:53,975][__main__][INFO] - Prefetch Factor: 4
[2025-08-07 00:15:53,975][__main__][INFO] - Persistent Workers: True
[2025-08-07 00:15:53,975][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/resnet101_filt_4gpu
[2025-08-07 00:15:53,990][__main__][INFO] - Found latest checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/resnet101_filt_4gpu/checkpoints/resnet101_filt_4gpu-9319-0.2955.ckpt
[2025-08-07 00:15:53,992][__main__][INFO] - Loaded W&B run ID from file: wqqx9gan
[2025-08-07 00:15:53,993][__main__][INFO] - Setting up W&B logger with existing run ID: wqqx9gan
[2025-08-07 00:15:53,993][__main__][INFO] - Initializing wandb logger with params
[2025-08-07 00:15:54,216][__main__][INFO] - Loaded batch size 113 from file
[2025-08-07 00:15:54,305][__main__][INFO] - === STARTING TRAINING ===
[2025-08-07 00:15:54,305][__main__][INFO] - Resuming from checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/resnet101_filt_4gpu/checkpoints/resnet101_filt_4gpu-9319-0.2955.ckpt
[2025-08-07 00:16:37,512][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 00:21:35,431][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 00:21:35,433][__main__][INFO] - === STARTING EXPERIMENT: resnet50_lstm ===
[2025-08-07 00:21:35,433][__main__][INFO] - PID: 762373
[2025-08-07 00:21:35,433][__main__][INFO] - SLURM_JOB_ID: 28962711
[2025-08-07 00:21:35,433][__main__][INFO] - Architecture: resnet50
[2025-08-07 00:21:35,433][__main__][INFO] - Embedding Dim: 64
[2025-08-07 00:21:35,433][__main__][INFO] - Learning Rate: 0.0003
[2025-08-07 00:21:35,433][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-07 00:21:35,433][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-07 00:21:35,433][__main__][INFO] - Use LSTM: True
[2025-08-07 00:21:35,433][__main__][INFO] - Dataset: d=19, rounds_max=19, p=2.1
[2025-08-07 00:21:35,433][__main__][INFO] - Accelerator: auto
[2025-08-07 00:21:35,434][__main__][INFO] - Devices: auto
[2025-08-07 00:21:35,434][__main__][INFO] - Strategy: auto
[2025-08-07 00:21:35,434][__main__][INFO] - Num Nodes: 1
[2025-08-07 00:21:35,434][__main__][INFO] - Sync BatchNorm: True
[2025-08-07 00:21:35,434][__main__][INFO] - MWPM filtering: True
[2025-08-07 00:21:35,434][__main__][INFO] - Batch Size: auto-tuned
[2025-08-07 00:21:35,434][__main__][INFO] - Precision: bf16-mixed
[2025-08-07 00:21:35,434][__main__][INFO] - Max Steps: 50000
[2025-08-07 00:21:35,434][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-07 00:21:35,434][__main__][INFO] - Log every 100 steps
[2025-08-07 00:21:35,434][__main__][INFO] - Num Workers: 15
[2025-08-07 00:21:35,434][__main__][INFO] - Prefetch Factor: 4
[2025-08-07 00:21:35,434][__main__][INFO] - Persistent Workers: True
[2025-08-07 00:21:35,434][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/resnet50_lstm
[2025-08-07 00:21:35,451][__main__][INFO] - Found latest checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/resnet50_lstm/checkpoints/resnet50_lstm-9481-0.2916.ckpt
[2025-08-07 00:21:35,455][__main__][INFO] - Loaded W&B run ID from file: mmyvoi9d
[2025-08-07 00:21:35,456][__main__][INFO] - Setting up W&B logger with existing run ID: mmyvoi9d
[2025-08-07 00:21:35,456][__main__][INFO] - Initializing wandb logger with params
[2025-08-07 00:21:35,539][__main__][INFO] - Loaded batch size 236 from file
[2025-08-07 00:21:35,617][__main__][INFO] - === STARTING TRAINING ===
[2025-08-07 00:21:35,617][__main__][INFO] - Resuming from checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/resnet50_lstm/checkpoints/resnet50_lstm-9481-0.2916.ckpt
[2025-08-07 00:21:52,891][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 00:21:52,892][__main__][INFO] - === STARTING EXPERIMENT: 50_no_chunk ===
[2025-08-07 00:21:52,892][__main__][INFO] - PID: 4176919
[2025-08-07 00:21:52,892][__main__][INFO] - SLURM_JOB_ID: 28966820
[2025-08-07 00:21:52,892][__main__][INFO] - Architecture: resnet50
[2025-08-07 00:21:52,892][__main__][INFO] - Embedding Dim: 64
[2025-08-07 00:21:52,893][__main__][INFO] - Learning Rate: 0.0003
[2025-08-07 00:21:52,893][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-07 00:21:52,893][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-07 00:21:52,893][__main__][INFO] - Use LSTM: False
[2025-08-07 00:21:52,893][__main__][INFO] - Dataset: d=9, rounds_max=19, p=2.1
[2025-08-07 00:21:52,893][__main__][INFO] - Accelerator: auto
[2025-08-07 00:21:52,893][__main__][INFO] - Devices: auto
[2025-08-07 00:21:52,893][__main__][INFO] - Strategy: auto
[2025-08-07 00:21:52,893][__main__][INFO] - Num Nodes: 1
[2025-08-07 00:21:52,893][__main__][INFO] - Sync BatchNorm: True
[2025-08-07 00:21:52,893][__main__][INFO] - MWPM filtering: False
[2025-08-07 00:21:52,893][__main__][INFO] - Batch Size: auto-tuned
[2025-08-07 00:21:52,893][__main__][INFO] - Precision: bf16-mixed
[2025-08-07 00:21:52,893][__main__][INFO] - Max Steps: 50000
[2025-08-07 00:21:52,893][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-07 00:21:52,893][__main__][INFO] - Log every 100 steps
[2025-08-07 00:21:52,893][__main__][INFO] - Num Workers: 15
[2025-08-07 00:21:52,893][__main__][INFO] - Prefetch Factor: 4
[2025-08-07 00:21:52,893][__main__][INFO] - Persistent Workers: True
[2025-08-07 00:21:52,894][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/50_no_chunk
[2025-08-07 00:21:52,924][__main__][INFO] - Found latest checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/50_no_chunk/checkpoints/50_no_chunk-6581-0.1265.ckpt
[2025-08-07 00:21:52,930][__main__][INFO] - Loaded W&B run ID from file: toi2sl1m
[2025-08-07 00:21:52,930][__main__][INFO] - Setting up W&B logger with existing run ID: toi2sl1m
[2025-08-07 00:21:52,930][__main__][INFO] - Initializing wandb logger with params
[2025-08-07 00:21:53,020][__main__][INFO] - Loaded batch size 236 from file
[2025-08-07 00:21:53,117][__main__][INFO] - === STARTING TRAINING ===
[2025-08-07 00:21:53,117][__main__][INFO] - Resuming from checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/50_no_chunk/checkpoints/50_no_chunk-6581-0.1265.ckpt
                                                                                                                                                                                                                                       [2025-08-07 00:22:35,125][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 00:22:35,569][__main__][ERROR] - === TRAINING FAILED: TemporalSurfaceCodeDataset.__init__() got an unexpected keyword argument 'use_chunking' ===
[2025-08-07 00:35:30,034][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 00:35:30,035][__main__][INFO] - === STARTING EXPERIMENT: 50-time-chunk ===
[2025-08-07 00:35:30,035][__main__][INFO] - PID: 4180035
[2025-08-07 00:35:30,035][__main__][INFO] - SLURM_JOB_ID: 28973425
[2025-08-07 00:35:30,035][__main__][INFO] - Architecture: resnet50
[2025-08-07 00:35:30,035][__main__][INFO] - Embedding Dim: 64
[2025-08-07 00:35:30,036][__main__][INFO] - Learning Rate: 0.0003
[2025-08-07 00:35:30,036][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-07 00:35:30,036][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-07 00:35:30,036][__main__][INFO] - Use LSTM: False
[2025-08-07 00:35:30,036][__main__][INFO] - Chunking: [1, 1, 2]
[2025-08-07 00:35:30,036][__main__][INFO] - Dataset: d=9, rounds_max=19, p=1.75
[2025-08-07 00:35:30,036][__main__][INFO] - Accelerator: auto
[2025-08-07 00:35:30,036][__main__][INFO] - Devices: auto
[2025-08-07 00:35:30,036][__main__][INFO] - Strategy: auto
[2025-08-07 00:35:30,036][__main__][INFO] - Num Nodes: 1
[2025-08-07 00:35:30,036][__main__][INFO] - Sync BatchNorm: True
[2025-08-07 00:35:30,036][__main__][INFO] - MWPM filtering: False
[2025-08-07 00:35:30,036][__main__][INFO] - Batch Size: auto-tuned
[2025-08-07 00:35:30,036][__main__][INFO] - Precision: bf16-mixed
[2025-08-07 00:35:30,036][__main__][INFO] - Max Steps: 50000
[2025-08-07 00:35:30,036][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-07 00:35:30,036][__main__][INFO] - Log every 100 steps
[2025-08-07 00:35:30,036][__main__][INFO] - Num Workers: 16
[2025-08-07 00:35:30,036][__main__][INFO] - Prefetch Factor: 4
[2025-08-07 00:35:30,037][__main__][INFO] - Persistent Workers: True
[2025-08-07 00:35:30,037][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/50-time-chunk
[2025-08-07 00:35:30,047][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 00:35:30,048][__main__][INFO] - === STARTING EXPERIMENT: 50-space-chunk ===
[2025-08-07 00:35:30,049][__main__][INFO] - PID: 4180034
[2025-08-07 00:35:30,049][__main__][INFO] - SLURM_JOB_ID: 28973469
[2025-08-07 00:35:30,049][__main__][INFO] - Architecture: resnet50
[2025-08-07 00:35:30,049][__main__][INFO] - Embedding Dim: 64
[2025-08-07 00:35:30,049][__main__][INFO] - Learning Rate: 0.0003
[2025-08-07 00:35:30,049][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-07 00:35:30,049][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-07 00:35:30,049][__main__][INFO] - Use LSTM: False
[2025-08-07 00:35:30,049][__main__][INFO] - Chunking: [2, 2, 1]
[2025-08-07 00:35:30,049][__main__][INFO] - Dataset: d=9, rounds_max=19, p=1.75
[2025-08-07 00:35:30,049][__main__][INFO] - Accelerator: auto
[2025-08-07 00:35:30,049][__main__][INFO] - Devices: auto
[2025-08-07 00:35:30,049][__main__][INFO] - Strategy: auto
[2025-08-07 00:35:30,049][__main__][INFO] - Num Nodes: 1
[2025-08-07 00:35:30,049][__main__][INFO] - Sync BatchNorm: True
[2025-08-07 00:35:30,049][__main__][INFO] - MWPM filtering: False
[2025-08-07 00:35:30,049][__main__][INFO] - Batch Size: auto-tuned
[2025-08-07 00:35:30,049][__main__][INFO] - Precision: bf16-mixed
[2025-08-07 00:35:30,049][__main__][INFO] - Max Steps: 50000
[2025-08-07 00:35:30,050][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-07 00:35:30,050][__main__][INFO] - Log every 100 steps
[2025-08-07 00:35:30,050][__main__][INFO] - Num Workers: 16
[2025-08-07 00:35:30,050][__main__][INFO] - Prefetch Factor: 4
[2025-08-07 00:35:30,050][__main__][INFO] - Persistent Workers: True
[2025-08-07 00:35:30,050][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/50-space-chunk
[2025-08-07 00:35:30,050][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-07 00:35:30,050][__main__][INFO] - Initializing wandb logger with params
[2025-08-07 00:35:30,050][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 00:35:30,051][__main__][INFO] - === STARTING EXPERIMENT: 50-no-chunk ===
[2025-08-07 00:35:30,051][__main__][INFO] - PID: 4180033
[2025-08-07 00:35:30,051][__main__][INFO] - SLURM_JOB_ID: 28973561
[2025-08-07 00:35:30,051][__main__][INFO] - Architecture: resnet50
[2025-08-07 00:35:30,051][__main__][INFO] - Embedding Dim: 64
[2025-08-07 00:35:30,051][__main__][INFO] - Learning Rate: 0.0003
[2025-08-07 00:35:30,051][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-07 00:35:30,051][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-07 00:35:30,051][__main__][INFO] - Use LSTM: False
[2025-08-07 00:35:30,051][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-07 00:35:30,051][__main__][INFO] - Dataset: d=9, rounds_max=19, p=1.75
[2025-08-07 00:35:30,052][__main__][INFO] - Accelerator: auto
[2025-08-07 00:35:30,052][__main__][INFO] - Devices: auto
[2025-08-07 00:35:30,052][__main__][INFO] - Strategy: auto
[2025-08-07 00:35:30,052][__main__][INFO] - Num Nodes: 1
[2025-08-07 00:35:30,052][__main__][INFO] - Sync BatchNorm: True
[2025-08-07 00:35:30,052][__main__][INFO] - MWPM filtering: False
[2025-08-07 00:35:30,052][__main__][INFO] - Batch Size: auto-tuned
[2025-08-07 00:35:30,052][__main__][INFO] - Precision: bf16-mixed
[2025-08-07 00:35:30,052][__main__][INFO] - Max Steps: 50000
[2025-08-07 00:35:30,052][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-07 00:35:30,052][__main__][INFO] - Log every 100 steps
[2025-08-07 00:35:30,052][__main__][INFO] - Num Workers: 16
[2025-08-07 00:35:30,052][__main__][INFO] - Prefetch Factor: 4
[2025-08-07 00:35:30,052][__main__][INFO] - Persistent Workers: True
[2025-08-07 00:35:30,052][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/50-no-chunk
[2025-08-07 00:35:30,062][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-07 00:35:30,062][__main__][INFO] - Initializing wandb logger with params
[2025-08-07 00:35:30,067][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-07 00:35:30,067][__main__][INFO] - Initializing wandb logger with params
[2025-08-07 00:35:31,813][__main__][INFO] - Saved new W&B run ID to file: 86r2oz39
[2025-08-07 00:35:31,902][__main__][INFO] - Saved new W&B run ID to file: o8whusu3
[2025-08-07 00:35:31,998][__main__][INFO] - Saved new W&B run ID to file: f9bv4bqd
[2025-08-07 00:37:09,876][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 00:37:09,877][__main__][INFO] - === STARTING EXPERIMENT: 50-no-chunk ===
[2025-08-07 00:37:09,877][__main__][INFO] - PID: 4180472
[2025-08-07 00:37:09,877][__main__][INFO] - SLURM_JOB_ID: 28974507
[2025-08-07 00:37:09,877][__main__][INFO] - Architecture: resnet50
[2025-08-07 00:37:09,877][__main__][INFO] - Embedding Dim: 64
[2025-08-07 00:37:09,877][__main__][INFO] - Learning Rate: 0.0003
[2025-08-07 00:37:09,877][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-07 00:37:09,878][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-07 00:37:09,878][__main__][INFO] - Use LSTM: False
[2025-08-07 00:37:09,878][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-07 00:37:09,878][__main__][INFO] - Dataset: d=9, rounds_max=19, p=1.75
[2025-08-07 00:37:09,878][__main__][INFO] - Accelerator: auto
[2025-08-07 00:37:09,878][__main__][INFO] - Devices: auto
[2025-08-07 00:37:09,878][__main__][INFO] - Strategy: auto
[2025-08-07 00:37:09,878][__main__][INFO] - Num Nodes: 1
[2025-08-07 00:37:09,878][__main__][INFO] - Sync BatchNorm: True
[2025-08-07 00:37:09,878][__main__][INFO] - MWPM filtering: False
[2025-08-07 00:37:09,878][__main__][INFO] - Batch Size: auto-tuned
[2025-08-07 00:37:09,878][__main__][INFO] - Precision: bf16-mixed
[2025-08-07 00:37:09,878][__main__][INFO] - Max Steps: 50000
[2025-08-07 00:37:09,878][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-07 00:37:09,878][__main__][INFO] - Log every 100 steps
[2025-08-07 00:37:09,878][__main__][INFO] - Num Workers: 16
[2025-08-07 00:37:09,878][__main__][INFO] - Prefetch Factor: 4
[2025-08-07 00:37:09,878][__main__][INFO] - Persistent Workers: True
[2025-08-07 00:37:09,879][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/50-no-chunk
[2025-08-07 00:37:09,883][__main__][INFO] - Loaded W&B run ID from file: 86r2oz39
[2025-08-07 00:37:09,883][__main__][INFO] - Setting up W&B logger with existing run ID: 86r2oz39
[2025-08-07 00:37:09,883][__main__][INFO] - Initializing wandb logger with params
[2025-08-07 00:37:09,889][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 00:37:09,889][__main__][INFO] - === STARTING EXPERIMENT: 50-space-chunk ===
[2025-08-07 00:37:09,890][__main__][INFO] - PID: 4180474
[2025-08-07 00:37:09,890][__main__][INFO] - SLURM_JOB_ID: 28974538
[2025-08-07 00:37:09,890][__main__][INFO] - Architecture: resnet50
[2025-08-07 00:37:09,890][__main__][INFO] - Embedding Dim: 64
[2025-08-07 00:37:09,890][__main__][INFO] - Learning Rate: 0.0003
[2025-08-07 00:37:09,890][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-07 00:37:09,890][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-07 00:37:09,890][__main__][INFO] - Use LSTM: False
[2025-08-07 00:37:09,890][__main__][INFO] - Chunking: [2, 2, 1]
[2025-08-07 00:37:09,890][__main__][INFO] - Dataset: d=9, rounds_max=19, p=1.75
[2025-08-07 00:37:09,890][__main__][INFO] - Accelerator: auto
[2025-08-07 00:37:09,890][__main__][INFO] - Devices: auto
[2025-08-07 00:37:09,890][__main__][INFO] - Strategy: auto
[2025-08-07 00:37:09,890][__main__][INFO] - Num Nodes: 1
[2025-08-07 00:37:09,890][__main__][INFO] - Sync BatchNorm: True
[2025-08-07 00:37:09,890][__main__][INFO] - MWPM filtering: False
[2025-08-07 00:37:09,890][__main__][INFO] - Batch Size: auto-tuned
[2025-08-07 00:37:09,890][__main__][INFO] - Precision: bf16-mixed
[2025-08-07 00:37:09,891][__main__][INFO] - Max Steps: 50000
[2025-08-07 00:37:09,891][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-07 00:37:09,891][__main__][INFO] - Log every 100 steps
[2025-08-07 00:37:09,891][__main__][INFO] - Num Workers: 16
[2025-08-07 00:37:09,891][__main__][INFO] - Prefetch Factor: 4
[2025-08-07 00:37:09,891][__main__][INFO] - Persistent Workers: True
[2025-08-07 00:37:09,891][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/50-space-chunk
[2025-08-07 00:37:09,892][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 00:37:09,893][__main__][INFO] - === STARTING EXPERIMENT: 50-time-chunk ===
[2025-08-07 00:37:09,893][__main__][INFO] - PID: 4180473
[2025-08-07 00:37:09,893][__main__][INFO] - SLURM_JOB_ID: 28974559
[2025-08-07 00:37:09,893][__main__][INFO] - Architecture: resnet50
[2025-08-07 00:37:09,893][__main__][INFO] - Embedding Dim: 64
[2025-08-07 00:37:09,893][__main__][INFO] - Learning Rate: 0.0003
[2025-08-07 00:37:09,894][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-07 00:37:09,894][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-07 00:37:09,894][__main__][INFO] - Use LSTM: False
[2025-08-07 00:37:09,894][__main__][INFO] - Chunking: [1, 1, 2]
[2025-08-07 00:37:09,894][__main__][INFO] - Dataset: d=9, rounds_max=19, p=1.75
[2025-08-07 00:37:09,894][__main__][INFO] - Accelerator: auto
[2025-08-07 00:37:09,894][__main__][INFO] - Devices: auto
[2025-08-07 00:37:09,894][__main__][INFO] - Strategy: auto
[2025-08-07 00:37:09,894][__main__][INFO] - Num Nodes: 1
[2025-08-07 00:37:09,894][__main__][INFO] - Sync BatchNorm: True
[2025-08-07 00:37:09,894][__main__][INFO] - MWPM filtering: False
[2025-08-07 00:37:09,894][__main__][INFO] - Batch Size: auto-tuned
[2025-08-07 00:37:09,894][__main__][INFO] - Precision: bf16-mixed
[2025-08-07 00:37:09,894][__main__][INFO] - Max Steps: 50000
[2025-08-07 00:37:09,894][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-07 00:37:09,894][__main__][INFO] - Log every 100 steps
[2025-08-07 00:37:09,894][__main__][INFO] - Num Workers: 16
[2025-08-07 00:37:09,894][__main__][INFO] - Prefetch Factor: 4
[2025-08-07 00:37:09,894][__main__][INFO] - Persistent Workers: True
[2025-08-07 00:37:09,895][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/50-time-chunk
[2025-08-07 00:37:09,895][__main__][INFO] - Loaded W&B run ID from file: o8whusu3
[2025-08-07 00:37:09,895][__main__][INFO] - Setting up W&B logger with existing run ID: o8whusu3
[2025-08-07 00:37:09,895][__main__][INFO] - Initializing wandb logger with params
[2025-08-07 00:37:09,897][__main__][INFO] - Loaded W&B run ID from file: f9bv4bqd
[2025-08-07 00:37:09,897][__main__][INFO] - Setting up W&B logger with existing run ID: f9bv4bqd
[2025-08-07 00:37:09,897][__main__][INFO] - Initializing wandb logger with params
[2025-08-07 00:37:32,162][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 00:37:32,162][__main__][INFO] - === STARTING EXPERIMENT: 50-all-chunk ===
[2025-08-07 00:37:32,162][__main__][INFO] - PID: 3550273
[2025-08-07 00:37:32,162][__main__][INFO] - SLURM_JOB_ID: 28974455
[2025-08-07 00:37:32,162][__main__][INFO] - Architecture: resnet50
[2025-08-07 00:37:32,162][__main__][INFO] - Embedding Dim: 64
[2025-08-07 00:37:32,162][__main__][INFO] - Learning Rate: 0.0003
[2025-08-07 00:37:32,162][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-07 00:37:32,162][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-07 00:37:32,163][__main__][INFO] - Use LSTM: False
[2025-08-07 00:37:32,163][__main__][INFO] - Chunking: [2, 2, 2]
[2025-08-07 00:37:32,163][__main__][INFO] - Dataset: d=9, rounds_max=19, p=1.75
[2025-08-07 00:37:32,163][__main__][INFO] - Accelerator: auto
[2025-08-07 00:37:32,163][__main__][INFO] - Devices: auto
[2025-08-07 00:37:32,163][__main__][INFO] - Strategy: auto
[2025-08-07 00:37:32,163][__main__][INFO] - Num Nodes: 1
[2025-08-07 00:37:32,163][__main__][INFO] - Sync BatchNorm: True
[2025-08-07 00:37:32,163][__main__][INFO] - MWPM filtering: False
[2025-08-07 00:37:32,163][__main__][INFO] - Batch Size: auto-tuned
[2025-08-07 00:37:32,163][__main__][INFO] - Precision: bf16-mixed
[2025-08-07 00:37:32,163][__main__][INFO] - Max Steps: 50000
[2025-08-07 00:37:32,163][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-07 00:37:32,163][__main__][INFO] - Log every 100 steps
[2025-08-07 00:37:32,163][__main__][INFO] - Num Workers: 16
[2025-08-07 00:37:32,163][__main__][INFO] - Prefetch Factor: 4
[2025-08-07 00:37:32,163][__main__][INFO] - Persistent Workers: True
[2025-08-07 00:37:32,163][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/50-all-chunk
[2025-08-07 00:37:32,177][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-07 00:37:32,177][__main__][INFO] - Initializing wandb logger with params
[2025-08-07 00:37:34,638][__main__][INFO] - Saved new W&B run ID to file: m1if5kc2
[2025-08-07 00:39:57,172][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 00:39:57,172][__main__][INFO] - === STARTING EXPERIMENT: 50-space-chunk ===
[2025-08-07 00:39:57,172][__main__][INFO] - PID: 4181689
[2025-08-07 00:39:57,172][__main__][INFO] - SLURM_JOB_ID: 28975970
[2025-08-07 00:39:57,172][__main__][INFO] - Architecture: resnet50
[2025-08-07 00:39:57,173][__main__][INFO] - Embedding Dim: 64
[2025-08-07 00:39:57,173][__main__][INFO] - Learning Rate: 0.0003
[2025-08-07 00:39:57,173][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-07 00:39:57,173][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-07 00:39:57,173][__main__][INFO] - Use LSTM: False
[2025-08-07 00:39:57,173][__main__][INFO] - Chunking: [2, 2, 1]
[2025-08-07 00:39:57,173][__main__][INFO] - Dataset: d=9, rounds_max=19, p=1.75
[2025-08-07 00:39:57,173][__main__][INFO] - Accelerator: auto
[2025-08-07 00:39:57,173][__main__][INFO] - Devices: auto
[2025-08-07 00:39:57,173][__main__][INFO] - Strategy: auto
[2025-08-07 00:39:57,173][__main__][INFO] - Num Nodes: 1
[2025-08-07 00:39:57,173][__main__][INFO] - Sync BatchNorm: True
[2025-08-07 00:39:57,173][__main__][INFO] - MWPM filtering: False
[2025-08-07 00:39:57,173][__main__][INFO] - Batch Size: auto-tuned
[2025-08-07 00:39:57,173][__main__][INFO] - Precision: bf16-mixed
[2025-08-07 00:39:57,173][__main__][INFO] - Max Steps: 50000
[2025-08-07 00:39:57,173][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-07 00:39:57,173][__main__][INFO] - Log every 100 steps
[2025-08-07 00:39:57,173][__main__][INFO] - Num Workers: 16
[2025-08-07 00:39:57,174][__main__][INFO] - Prefetch Factor: 4
[2025-08-07 00:39:57,174][__main__][INFO] - Persistent Workers: True
[2025-08-07 00:39:57,174][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/50-space-chunk
[2025-08-07 00:39:57,183][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-07 00:39:57,183][__main__][INFO] - Initializing wandb logger with params
[2025-08-07 00:39:57,186][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 00:39:57,186][__main__][INFO] - === STARTING EXPERIMENT: 50-time-chunk ===
[2025-08-07 00:39:57,187][__main__][INFO] - PID: 4181690
[2025-08-07 00:39:57,187][__main__][INFO] - SLURM_JOB_ID: 28976021
[2025-08-07 00:39:57,187][__main__][INFO] - Architecture: resnet50
[2025-08-07 00:39:57,187][__main__][INFO] - Embedding Dim: 64
[2025-08-07 00:39:57,187][__main__][INFO] - Learning Rate: 0.0003
[2025-08-07 00:39:57,187][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-07 00:39:57,187][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-07 00:39:57,187][__main__][INFO] - Use LSTM: False
[2025-08-07 00:39:57,187][__main__][INFO] - Chunking: [1, 1, 2]
[2025-08-07 00:39:57,187][__main__][INFO] - Dataset: d=9, rounds_max=19, p=1.75
[2025-08-07 00:39:57,187][__main__][INFO] - Accelerator: auto
[2025-08-07 00:39:57,187][__main__][INFO] - Devices: auto
[2025-08-07 00:39:57,187][__main__][INFO] - Strategy: auto
[2025-08-07 00:39:57,187][__main__][INFO] - Num Nodes: 1
[2025-08-07 00:39:57,187][__main__][INFO] - Sync BatchNorm: True
[2025-08-07 00:39:57,187][__main__][INFO] - MWPM filtering: False
[2025-08-07 00:39:57,187][__main__][INFO] - Batch Size: auto-tuned
[2025-08-07 00:39:57,187][__main__][INFO] - Precision: bf16-mixed
[2025-08-07 00:39:57,187][__main__][INFO] - Max Steps: 50000
[2025-08-07 00:39:57,188][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-07 00:39:57,188][__main__][INFO] - Log every 100 steps
[2025-08-07 00:39:57,188][__main__][INFO] - Num Workers: 16
[2025-08-07 00:39:57,188][__main__][INFO] - Prefetch Factor: 4
[2025-08-07 00:39:57,188][__main__][INFO] - Persistent Workers: True
[2025-08-07 00:39:57,188][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/50-time-chunk
[2025-08-07 00:39:57,189][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 00:39:57,189][__main__][INFO] - === STARTING EXPERIMENT: 50-no-chunk ===
[2025-08-07 00:39:57,189][__main__][INFO] - PID: 4181688
[2025-08-07 00:39:57,189][__main__][INFO] - SLURM_JOB_ID: 28975948
[2025-08-07 00:39:57,190][__main__][INFO] - Architecture: resnet50
[2025-08-07 00:39:57,190][__main__][INFO] - Embedding Dim: 64
[2025-08-07 00:39:57,190][__main__][INFO] - Learning Rate: 0.0003
[2025-08-07 00:39:57,190][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-07 00:39:57,190][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-07 00:39:57,190][__main__][INFO] - Use LSTM: False
[2025-08-07 00:39:57,190][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-07 00:39:57,190][__main__][INFO] - Dataset: d=9, rounds_max=19, p=1.75
[2025-08-07 00:39:57,190][__main__][INFO] - Accelerator: auto
[2025-08-07 00:39:57,190][__main__][INFO] - Devices: auto
[2025-08-07 00:39:57,190][__main__][INFO] - Strategy: auto
[2025-08-07 00:39:57,190][__main__][INFO] - Num Nodes: 1
[2025-08-07 00:39:57,190][__main__][INFO] - Sync BatchNorm: True
[2025-08-07 00:39:57,190][__main__][INFO] - MWPM filtering: False
[2025-08-07 00:39:57,190][__main__][INFO] - Batch Size: auto-tuned
[2025-08-07 00:39:57,190][__main__][INFO] - Precision: bf16-mixed
[2025-08-07 00:39:57,190][__main__][INFO] - Max Steps: 50000
[2025-08-07 00:39:57,190][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-07 00:39:57,190][__main__][INFO] - Log every 100 steps
[2025-08-07 00:39:57,190][__main__][INFO] - Num Workers: 16
[2025-08-07 00:39:57,191][__main__][INFO] - Prefetch Factor: 4
[2025-08-07 00:39:57,191][__main__][INFO] - Persistent Workers: True
[2025-08-07 00:39:57,191][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/50-no-chunk
[2025-08-07 00:39:57,196][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-07 00:39:57,196][__main__][INFO] - Initializing wandb logger with params
[2025-08-07 00:39:57,201][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-07 00:39:57,201][__main__][INFO] - Initializing wandb logger with params
[2025-08-07 00:39:59,026][__main__][INFO] - Saved new W&B run ID to file: 2nnvr6eb
[2025-08-07 00:39:59,100][__main__][INFO] - Saved new W&B run ID to file: 2gg7o8ev
[2025-08-07 00:39:59,104][__main__][INFO] - === AUTO-TUNING BATCH SIZE ===
[2025-08-07 00:39:59,168][__main__][INFO] - === AUTO-TUNING BATCH SIZE ===
[2025-08-07 00:39:59,173][__main__][INFO] - Saved new W&B run ID to file: 0js70bar
[2025-08-07 00:39:59,242][__main__][INFO] - === AUTO-TUNING BATCH SIZE ===
[2025-08-07 00:39:59,567][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 00:39:59,934][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 00:40:00,478][__main__][INFO] - Set seed 42 for local rank 0
:00,729][__main__][INFO] - Chunking: [2, 2, 2]
[2025-08-07 00:40:00,729][__main__][INFO] - Dataset: d=9, rounds_max=19, p=1.75
[2025-08-07 00:40:00,729][__main__][INFO] - Accelerator: auto
[2025-08-07 00:40:00,729][__main__][INFO] - Devices: auto
[2025-08-07 00:40:00,729][__main__][INFO] - Strategy: auto
[2025-08-07 00:40:00,729][__main__][INFO] - Num Nodes: 1
[2025-08-07 00:40:00,729][__main__][INFO] - Sync BatchNorm: True
[2025-08-07 00:40:00,729][__main__][INFO] - MWPM filtering: False
[2025-08-07 00:40:00,729][__main__][INFO] - Batch Size: auto-tuned
[2025-08-07 00:40:00,729][__main__][INFO] - Precision: bf16-mixed
[2025-08-07 00:40:00,730][__main__][INFO] - Max Steps: 50000
[2025-08-07 00:40:00,730][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-07 00:40:00,730][__main__][INFO] - Log every 100 steps
[2025-08-07 00:40:00,730][__main__][INFO] - Num Workers: 16
[2025-08-07 00:40:00,730][__main__][INFO] - Prefetch Factor: 4
[2025-08-07 00:40:00,730][__main__][INFO] - Persistent Workers: True
[2025-08-07 00:40:00,730][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/50-all-chunk
[2025-08-07 00:40:00,741][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-07 00:40:00,741][__main__][INFO] - Initializing wandb logger with params
[2025-08-07 00:40:02,621][__main__][INFO] - Saved new W&B run ID to file: w80ql2ni
[2025-08-07 00:40:02,741][__main__][INFO] - === AUTO-TUNING BATCH SIZE ===
[2025-08-07 00:40:03,580][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 00:41:15,810][__main__][INFO] - Found optimal batch size 2335
[2025-08-07 00:41:15,823][__main__][INFO] - Saved batch size 1868 to file
[2025-08-07 00:41:15,824][__main__][INFO] - Optimal per-GPU batch size found: 1868
[2025-08-07 00:41:15,824][__main__][INFO] - Effective total batch size across 1 device(s): 1868
[2025-08-07 00:41:15,829][__main__][INFO] - Saved metadata: {'timestamp': 1754541675.8242233, 'slurm_job_id': '28975722', 'batch_size': 1868, 'num_devices': 1, 'effective_batch_size': 1868}
[2025-08-07 00:41:16,243][__main__][INFO] - === STARTING TRAINING ===
[2025-08-07 00:41:16,249][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 00:44:21,645][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 00:44:21,646][__main__][INFO] - === STARTING EXPERIMENT: 50-no-chunk ===
[2025-08-07 00:44:21,646][__main__][INFO] - PID: 4182858
[2025-08-07 00:44:21,646][__main__][INFO] - SLURM_JOB_ID: 28976124
[2025-08-07 00:44:21,646][__main__][INFO] - Architecture: resnet50
[2025-08-07 00:44:21,646][__main__][INFO] - Embedding Dim: 64
[2025-08-07 00:44:21,646][__main__][INFO] - Learning Rate: 0.0003
[2025-08-07 00:44:21,646][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-07 00:44:21,646][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-07 00:44:21,646][__main__][INFO] - Use LSTM: False
[2025-08-07 00:44:21,646][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-07 00:44:21,646][__main__][INFO] - Dataset: d=9, rounds_max=19, p=1.75
[2025-08-07 00:44:21,647][__main__][INFO] - Accelerator: auto
[2025-08-07 00:44:21,647][__main__][INFO] - Devices: auto
[2025-08-07 00:44:21,647][__main__][INFO] - Strategy: auto
[2025-08-07 00:44:21,647][__main__][INFO] - Num Nodes: 1
[2025-08-07 00:44:21,647][__main__][INFO] - Sync BatchNorm: True
[2025-08-07 00:44:21,647][__main__][INFO] - MWPM filtering: False
[2025-08-07 00:44:21,647][__main__][INFO] - Batch Size: auto-tuned
[2025-08-07 00:44:21,647][__main__][INFO] - Precision: bf16-mixed
[2025-08-07 00:44:21,647][__main__][INFO] - Max Steps: 50000
[2025-08-07 00:44:21,647][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-07 00:44:21,647][__main__][INFO] - Log every 100 steps
[2025-08-07 00:44:21,647][__main__][INFO] - Num Workers: 16
[2025-08-07 00:44:21,647][__main__][INFO] - Prefetch Factor: 4
[2025-08-07 00:44:21,647][__main__][INFO] - Persistent Workers: True
[2025-08-07 00:44:21,647][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/50-no-chunk
[2025-08-07 00:44:21,659][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-07 00:44:21,659][__main__][INFO] - Initializing wandb logger with params
[2025-08-07 00:44:21,660][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 00:44:21,660][__main__][INFO] - === STARTING EXPERIMENT: 50-time-chunk ===
[2025-08-07 00:44:21,661][__main__][INFO] - PID: 4182859
[2025-08-07 00:44:21,661][__main__][INFO] - SLURM_JOB_ID: 28976126
[2025-08-07 00:44:21,661][__main__][INFO] - Architecture: resnet50
[2025-08-07 00:44:21,661][__main__][INFO] - Embedding Dim: 64
[2025-08-07 00:44:21,661][__main__][INFO] - Learning Rate: 0.0003
[2025-08-07 00:44:21,661][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-07 00:44:21,661][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-07 00:44:21,661][__main__][INFO] - Use LSTM: False
[2025-08-07 00:44:21,661][__main__][INFO] - Chunking: [1, 1, 2]
[2025-08-07 00:44:21,661][__main__][INFO] - Dataset: d=9, rounds_max=19, p=1.75
[2025-08-07 00:44:21,661][__main__][INFO] - Accelerator: auto
[2025-08-07 00:44:21,661][__main__][INFO] - Devices: auto
[2025-08-07 00:44:21,661][__main__][INFO] - Strategy: auto
[2025-08-07 00:44:21,661][__main__][INFO] - Num Nodes: 1
[2025-08-07 00:44:21,661][__main__][INFO] - Sync BatchNorm: True
[2025-08-07 00:44:21,661][__main__][INFO] - MWPM filtering: False
[2025-08-07 00:44:21,661][__main__][INFO] - Batch Size: auto-tuned
[2025-08-07 00:44:21,661][__main__][INFO] - Precision: bf16-mixed
[2025-08-07 00:44:21,662][__main__][INFO] - Max Steps: 50000
[2025-08-07 00:44:21,662][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-07 00:44:21,662][__main__][INFO] - Log every 100 steps
[2025-08-07 00:44:21,662][__main__][INFO] - Num Workers: 16
[2025-08-07 00:44:21,662][__main__][INFO] - Prefetch Factor: 4
[2025-08-07 00:44:21,662][__main__][INFO] - Persistent Workers: True
[2025-08-07 00:44:21,662][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/50-time-chunk
[2025-08-07 00:44:21,663][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 00:44:21,664][__main__][INFO] - === STARTING EXPERIMENT: 50-space-chunk ===
[2025-08-07 00:44:21,664][__main__][INFO] - PID: 4182860
[2025-08-07 00:44:21,664][__main__][INFO] - SLURM_JOB_ID: 28976125
[2025-08-07 00:44:21,664][__main__][INFO] - Architecture: resnet50
[2025-08-07 00:44:21,664][__main__][INFO] - Embedding Dim: 64
[2025-08-07 00:44:21,664][__main__][INFO] - Learning Rate: 0.0003
[2025-08-07 00:44:21,664][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-07 00:44:21,664][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-07 00:44:21,664][__main__][INFO] - Use LSTM: False
[2025-08-07 00:44:21,664][__main__][INFO] - Chunking: [2, 2, 1]
[2025-08-07 00:44:21,664][__main__][INFO] - Dataset: d=9, rounds_max=19, p=1.75
[2025-08-07 00:44:21,664][__main__][INFO] - Accelerator: auto
[2025-08-07 00:44:21,664][__main__][INFO] - Devices: auto
[2025-08-07 00:44:21,664][__main__][INFO] - Strategy: auto
[2025-08-07 00:44:21,664][__main__][INFO] - Num Nodes: 1
[2025-08-07 00:44:21,664][__main__][INFO] - Sync BatchNorm: True
[2025-08-07 00:44:21,664][__main__][INFO] - MWPM filtering: False
[2025-08-07 00:44:21,665][__main__][INFO] - Batch Size: auto-tuned
[2025-08-07 00:44:21,665][__main__][INFO] - Precision: bf16-mixed
[2025-08-07 00:44:21,665][__main__][INFO] - Max Steps: 50000
[2025-08-07 00:44:21,665][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-07 00:44:21,665][__main__][INFO] - Log every 100 steps
[2025-08-07 00:44:21,665][__main__][INFO] - Num Workers: 16
[2025-08-07 00:44:21,665][__main__][INFO] - Prefetch Factor: 4
[2025-08-07 00:44:21,665][__main__][INFO] - Persistent Workers: True
[2025-08-07 00:44:21,665][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/50-space-chunk
[2025-08-07 00:44:21,672][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-07 00:44:21,672][__main__][INFO] - Initializing wandb logger with params
[2025-08-07 00:44:21,676][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-07 00:44:21,676][__main__][INFO] - Initializing wandb logger with params
[2025-08-07 00:44:23,518][__main__][INFO] - Saved new W&B run ID to file: 7l0kf5jc
[2025-08-07 00:44:23,588][__main__][INFO] - Saved new W&B run ID to file: avb6pjvi
[2025-08-07 00:44:23,593][__main__][INFO] - === AUTO-TUNING BATCH SIZE ===
[2025-08-07 00:44:23,658][__main__][INFO] - === AUTO-TUNING BATCH SIZE ===
[2025-08-07 00:44:23,672][__main__][INFO] - Saved new W&B run ID to file: kezk6bgx
[2025-08-07 00:44:23,742][__main__][INFO] - === AUTO-TUNING BATCH SIZE ===
[2025-025-08-07 00:44:23,217][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-07 00:44:23,217][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-07 00:44:23,217][__main__][INFO] - Use LSTM: False
[2025-08-07 00:44:23,217][__main__][INFO] - Chunking: [2, 2, 2]
[2025-08-07 00:44:23,218][__main__][INFO] - Dataset: d=9, rounds_max=19, p=1.75
[2025-08-07 00:44:23,218][__main__][INFO] - Accelerator: auto
[2025-08-07 00:44:23,218][__main__][INFO] - Devices: auto
[2025-08-07 00:44:23,218][__main__][INFO] - Strategy: auto
[2025-08-07 00:44:23,218][__main__][INFO] - Num Nodes: 1
[2025-08-07 00:44:23,218][__main__][INFO] - Sync BatchNorm: True
[2025-08-07 00:44:23,218][__main__][INFO] - MWPM filtering: False
[2025-08-07 00:44:23,218][__main__][INFO] - Batch Size: auto-tuned
[2025-08-07 00:44:23,218][__main__][INFO] - Precision: bf16-mixed
[2025-08-07 00:44:23,218][__main__][INFO] - Max Steps: 50000
[2025-08-07 00:44:23,218][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-07 00:44:23,218][__main__][INFO] - Log every 100 steps
[2025-08-07 00:44:23,218][__main__][INFO] - Num Workers: 16
[2025-08-07 00:44:23,218][__main__][INFO] - Prefetch Factor: 4
[2025-08-07 00:44:23,218][__main__][INFO] - Persistent Workers: True
[2025-08-07 00:44:23,218][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/50-all-chunk
[2025-08-07 00:44:23,229][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-07 00:44:23,229][__main__][INFO] - Initializing wandb logger with params
[2025-08-07 00:44:25,085][__main__][INFO] - Saved new W&B run ID to file: zjwagxnn
[2025-08-07 00:44:25,161][__main__][INFO] - === AUTO-TUNING BATCH SIZE ===
[2025-08-07 00:44:25,940][__main__][INFO] - Set seed 42 for local rank 0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          [2025-08-07 00:45:32,516][__main__][INFO] - Found optimal batch size 2335
[2025-08-07 00:45:32,528][__main__][INFO] - Saved batch size 1868 to file
[2025-08-07 00:45:32,528][__main__][INFO] - Optimal per-GPU batch size found: 1868
[2025-08-07 00:45:32,528][__main__][INFO] - Effective total batch size across 1 device(s): 1868
[2025-08-07 00:45:32,533][__main__][INFO] - Saved metadata: {'timestamp': 1754541932.5290208, 'slurm_job_id': '28976122', 'batch_size': 1868, 'num_devices': 1, 'effective_batch_size': 1868}
[2025-08-07 00:45:32,953][__main__][INFO] - === STARTING TRAINING ===
[2025-08-07 00:45:32,961][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 03:44:05,162][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 03:44:05,163][__main__][INFO] - === STARTING EXPERIMENT: time-chunk-lowp ===
[2025-08-07 03:44:05,164][__main__][INFO] - PID: 2204392
[2025-08-07 03:44:05,164][__main__][INFO] - SLURM_JOB_ID: 28979791
[2025-08-07 03:44:05,164][__main__][INFO] - Architecture: resnet50
[2025-08-07 03:44:05,164][__main__][INFO] - Embedding Dim: 64
[2025-08-07 03:44:05,164][__main__][INFO] - Learning Rate: 0.0003
[2025-08-07 03:44:05,164][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-07 03:44:05,164][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-07 03:44:05,164][__main__][INFO] - Use LSTM: False
[2025-08-07 03:44:05,164][__main__][INFO] - Chunking: [1, 1, 2]
[2025-08-07 03:44:05,164][__main__][INFO] - Dataset: d=9, rounds_max=19, p=1.0
[2025-08-07 03:44:05,164][__main__][INFO] - Accelerator: auto
[2025-08-07 03:44:05,165][__main__][INFO] - Devices: auto
[2025-08-07 03:44:05,165][__main__][INFO] - Strategy: auto
[2025-08-07 03:44:05,165][__main__][INFO] - Num Nodes: 1
[2025-08-07 03:44:05,165][__main__][INFO] - Sync BatchNorm: True
[2025-08-07 03:44:05,165][__main__][INFO] - MWPM filtering: False
[2025-08-07 03:44:05,165][__main__][INFO] - Batch Size: auto-tuned
[2025-08-07 03:44:05,165][__main__][INFO] - Precision: bf16-mixed
[2025-08-07 03:44:05,165][__main__][INFO] - Max Steps: 50000
[2025-08-07 03:44:05,165][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-07 03:44:05,165][__main__][INFO] - Log every 100 steps
[2025-08-07 03:44:05,165][__main__][INFO] - Num Workers: 16
[2025-08-07 03:44:05,165][__main__][INFO] - Prefetch Factor: 4
[2025-08-07 03:44:05,165][__main__][INFO] - Persistent Workers: True
[2025-08-07 03:44:05,166][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/time-chunk-lowp
[2025-08-07 03:44:05,180][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-07 03:44:05,180][__main__][INFO] - Initializing wandb logger with params
[2025-08-07 03:44:08,165][__main__][INFO] - Saved new W&B run ID to file: eas1nb07
[2025-08-07 03:44:08,297][__main__][INFO] - === AUTO-TUNING BATCH SIZE ===
[2025-08-07 03:44:08,959][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 03:45:23,490][__main__][INFO] - Found optimal batch size 597
[2025-08-07 03:45:23,502][__main__][INFO] - Saved batch size 477 to file
[2025-08-07 03:45:23,503][__main__][INFO] - Optimal per-GPU batch size found: 477
[2025-08-07 03:45:23,503][__main__][INFO] - Effective total batch size across 1 device(s): 477
[2025-08-07 03:45:23,507][__main__][INFO] - Saved metadata: {'timestamp': 1754552723.5034611, 'slurm_job_id': '28979791', 'batch_size': 477, 'num_devices': 1, 'effective_batch_size': 477}
[2025-08-07 03:45:23,962][__main__][INFO] - === STARTING TRAINING ===
[2025-08-07 03:45:23,969][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 03:45:39,486][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 03:45:39,488][__main__][INFO] - === STARTING EXPERIMENT: d19-lowp ===
[2025-08-07 03:45:39,488][__main__][INFO] - PID: 1029619
[2025-08-07 03:45:39,488][__main__][INFO] - SLURM_JOB_ID: 28979800
[2025-08-07 03:45:39,489][__main__][INFO] - Architecture: resnet50
[2025-08-07 03:45:39,489][__main__][INFO] - Embedding Dim: 64
[2025-08-07 03:45:39,489][__main__][INFO] - Learning Rate: 0.0003
[2025-08-07 03:45:39,489][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-07 03:45:39,489][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-07 03:45:39,489][__main__][INFO] - Use LSTM: False
[2025-08-07 03:45:39,489][__main__][INFO] - Chunking: [1, 1, 2]
[2025-08-07 03:45:39,489][__main__][INFO] - Dataset: d=19, rounds_max=19, p=1.0
[2025-08-07 03:45:39,489][__main__][INFO] - Accelerator: auto
[2025-08-07 03:45:39,489][__main__][INFO] - Devices: auto
[2025-08-07 03:45:39,489][__main__][INFO] - Strategy: auto
[2025-08-07 03:45:39,490][__main__][INFO] - Num Nodes: 1
[2025-08-07 03:45:39,490][__main__][INFO] - Sync BatchNorm: True
[2025-08-07 03:45:39,490][__main__][INFO] - MWPM filtering: False
[2025-08-07 03:45:39,490][__main__][INFO] - Batch Size: auto-tuned
[2025-08-07 03:45:39,490][__main__][INFO] - Precision: bf16-mixed
[2025-08-07 03:45:39,490][__main__][INFO] - Max Steps: 50000
[2025-08-07 03:45:39,490][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-07 03:45:39,490][__main__][INFO] - Log every 100 steps
[2025-08-07 03:45:39,490][__main__][INFO] - Num Workers: 16
[2025-08-07 03:45:39,490][__main__][INFO] - Prefetch Factor: 4
[2025-08-07 03:45:39,490][__main__][INFO] - Persistent Workers: True
[2025-08-07 03:45:39,490][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d19-lowp
[2025-08-07 03:45:39,507][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-07 03:45:39,507][__main__][INFO] - Initializing wandb logger with params
[2025-08-07 03:45:42,220][__main__][INFO] - Saved new W&B run ID to file: iwidl681
[2025-08-07 03:45:42,345][__main__][INFO] - === AUTO-TUNING BATCH SIZE ===
[2025-08-07 03:45:45,482][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 03:47:02,580][__main__][INFO] - Found optimal batch size 148
[2025-08-07 03:47:02,590][__main__][INFO] - Saved batch size 118 to file
[2025-08-07 03:47:02,590][__main__][INFO] - Optimal per-GPU batch size found: 118
[2025-08-07 03:47:02,590][__main__][INFO] - Effective total batch size across 4 device(s): 472
[2025-08-07 03:47:02,596][__main__][INFO] - Saved metadata: {'timestamp': 1754552822.5906227, 'slurm_job_id': '28979800', 'batch_size': 118, 'num_devices': 4, 'effective_batch_size': 472}
[2025-08-07 03:47:03,033][__main__][INFO] - === STARTING TRAINING ===
[2025-08-07 03:47:56,880][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 04:08:45,473][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 04:08:45,475][__main__][INFO] - === STARTING EXPERIMENT: d19-lowp-strided ===
[2025-08-07 04:08:45,475][__main__][INFO] - PID: 1538064
[2025-08-07 04:08:45,475][__main__][INFO] - SLURM_JOB_ID: 28980014
[2025-08-07 04:08:45,475][__main__][INFO] - Architecture: resnet50
[2025-08-07 04:08:45,475][__main__][INFO] - Embedding Dim: 64
[2025-08-07 04:08:45,475][__main__][INFO] - Learning Rate: 0.0003
[2025-08-07 04:08:45,475][__main__][INFO] - Stage3 Stride: [2, 2, 2]
[2025-08-07 04:08:45,475][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-07 04:08:45,475][__main__][INFO] - Use LSTM: False
[2025-08-07 04:08:45,475][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-07 04:08:45,475][__main__][INFO] - Dataset: d=19, rounds_max=19, p=1.0
[2025-08-07 04:08:45,475][__main__][INFO] - Accelerator: auto
[2025-08-07 04:08:45,475][__main__][INFO] - Devices: auto
[2025-08-07 04:08:45,475][__main__][INFO] - Strategy: auto
[2025-08-07 04:08:45,476][__main__][INFO] - Num Nodes: 1
[2025-08-07 04:08:45,476][__main__][INFO] - Sync BatchNorm: True
[2025-08-07 04:08:45,476][__main__][INFO] - MWPM filtering: False
[2025-08-07 04:08:45,476][__main__][INFO] - Batch Size: auto-tuned
[2025-08-07 04:08:45,476][__main__][INFO] - Precision: bf16-mixed
[2025-08-07 04:08:45,476][__main__][INFO] - Max Steps: 50000
[2025-08-07 04:08:45,476][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-07 04:08:45,476][__main__][INFO] - Log every 100 steps
[2025-08-07 04:08:45,476][__main__][INFO] - Num Workers: 16
[2025-08-07 04:08:45,476][__main__][INFO] - Prefetch Factor: 4
[2025-08-07 04:08:45,476][__main__][INFO] - Persistent Workers: True
[2025-08-07 04:08:45,476][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d19-lowp-strided
[2025-08-07 04:08:45,493][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-07 04:08:45,493][__main__][INFO] - Initializing wandb logger with params
[2025-08-07 04:08:50,368][__main__][INFO] - Saved new W&B run ID to file: jnta39ee
[2025-08-07 04:08:50,542][__main__][INFO] - === AUTO-TUNING BATCH SIZE ===
[2025-08-07 04:08:53,424][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 04:10:00,531][__main__][INFO] - Found optimal batch size 252
[2025-08-07 04:10:00,543][__main__][INFO] - Saved batch size 201 to file
[2025-08-07 04:10:00,543][__main__][INFO] - Optimal per-GPU batch size found: 201
[2025-08-07 04:10:00,543][__main__][INFO] - Effective total batch size across 4 device(s): 804
[2025-08-07 04:10:00,547][__main__][INFO] - Saved metadata: {'timestamp': 1754554200.5438902, 'slurm_job_id': '28980014', 'batch_size': 201, 'num_devices': 4, 'effective_batch_size': 804}
[2025-08-07 04:10:00,961][__main__][INFO] - === STARTING TRAINING ===
[2025-08-07 04:10:55,078][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 05:07:17,603][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 05:07:17,604][__main__][INFO] - === STARTING EXPERIMENT: time-chunk-lowp ===
[2025-08-07 05:07:17,605][__main__][INFO] - PID: 1647707
[2025-08-07 05:07:17,605][__main__][INFO] - SLURM_JOB_ID: 28979791
[2025-08-07 05:07:17,605][__main__][INFO] - Architecture: resnet50
[2025-08-07 05:07:17,605][__main__][INFO] - Embedding Dim: 64
[2025-08-07 05:07:17,605][__main__][INFO] - Learning Rate: 0.0003
[2025-08-07 05:07:17,605][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-07 05:07:17,605][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-07 05:07:17,605][__main__][INFO] - Use LSTM: False
[2025-08-07 05:07:17,605][__main__][INFO] - Chunking: [1, 1, 2]
[2025-08-07 05:07:17,605][__main__][INFO] - Dataset: d=9, rounds_max=19, p=1.0
[2025-08-07 05:07:17,605][__main__][INFO] - Accelerator: auto
[2025-08-07 05:07:17,605][__main__][INFO] - Devices: auto
[2025-08-07 05:07:17,605][__main__][INFO] - Strategy: auto
[2025-08-07 05:07:17,605][__main__][INFO] - Num Nodes: 1
[2025-08-07 05:07:17,605][__main__][INFO] - Sync BatchNorm: True
[2025-08-07 05:07:17,605][__main__][INFO] - MWPM filtering: False
[2025-08-07 05:07:17,605][__main__][INFO] - Batch Size: auto-tuned
[2025-08-07 05:07:17,605][__main__][INFO] - Precision: bf16-mixed
[2025-08-07 05:07:17,606][__main__][INFO] - Max Steps: 50000
[2025-08-07 05:07:17,606][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-07 05:07:17,606][__main__][INFO] - Log every 100 steps
[2025-08-07 05:07:17,606][__main__][INFO] - Num Workers: 16
[2025-08-07 05:07:17,606][__main__][INFO] - Prefetch Factor: 4
[2025-08-07 05:07:17,606][__main__][INFO] - Persistent Workers: True
[2025-08-07 05:07:17,606][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/time-chunk-lowp
[2025-08-07 05:07:17,624][__main__][INFO] - Found latest checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/time-chunk-lowp/checkpoints/time-chunk-lowp-18651-0.0082.ckpt
[2025-08-07 05:07:17,627][__main__][INFO] - Loaded W&B run ID from file: eas1nb07
[2025-08-07 05:07:17,627][__main__][INFO] - Setting up W&B logger with existing run ID: eas1nb07
[2025-08-07 05:07:17,627][__main__][INFO] - Initializing wandb logger with params
[2025-08-07 05:07:17,721][__main__][INFO] - Loaded batch size 477 from file
[2025-08-07 05:07:17,834][__main__][INFO] - === STARTING TRAINING ===
[2025-08-07 05:07:17,834][__main__][INFO] - Resuming from checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/time-chunk-lowp/checkpoints/time-chunk-lowp-18651-0.0082.ckpt
[2025-08-07 05:07:20,886][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 07:16:13,688][__main__][INFO] - === TRAINING COMPLETED SUCCESSFULLY ===
[2025-08-07 07:43:41,971][__main__][INFO] - === TRAINING COMPLETED SUCCESSFULLY ===
[2025-08-07 13:47:38,294][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 13:47:38,294][__main__][INFO] - === STARTING EXPERIMENT: no-mult ===
[2025-08-07 13:47:38,294][__main__][INFO] - PID: 3481700
[2025-08-07 13:47:38,294][__main__][INFO] - SLURM_JOB_ID: 29001391
[2025-08-07 13:47:38,295][__main__][INFO] - Architecture: resnet50
[2025-08-07 13:47:38,295][__main__][INFO] - Embedding Dim: 64
[2025-08-07 13:47:38,295][__main__][INFO] - Learning Rate: 0.0003
[2025-08-07 13:47:38,295][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-07 13:47:38,295][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-07 13:47:38,295][__main__][INFO] - Channel Multipliers: [1, 1, 1, 1]
[2025-08-07 13:47:38,295][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-07 13:47:38,295][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-07 13:47:38,295][__main__][INFO] - Use LSTM: False
[2025-08-07 13:47:38,295][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-07 13:47:38,295][__main__][INFO] - Dataset: d=9, rounds_max=19, p=1.75
[2025-08-07 13:47:38,295][__main__][INFO] - Accelerator: auto
[2025-08-07 13:47:38,295][__main__][INFO] - Devices: auto
[2025-08-07 13:47:38,295][__main__][INFO] - Strategy: auto
[2025-08-07 13:47:38,295][__main__][INFO] - Num Nodes: 1
[2025-08-07 13:47:38,295][__main__][INFO] - Sync BatchNorm: True
[2025-08-07 13:47:38,295][__main__][INFO] - MWPM filtering: False
[2025-08-07 13:47:38,295][__main__][INFO] - Batch Size: auto-tuned
[2025-08-07 13:47:38,295][__main__][INFO] - Precision: bf16-mixed
[2025-08-07 13:47:38,296][__main__][INFO] - Max Steps: 50000
[2025-08-07 13:47:38,296][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-07 13:47:38,296][__main__][INFO] - Log every 100 steps
[2025-08-07 13:47:38,296][__main__][INFO] - Num Workers: 16
[2025-08-07 13:47:38,296][__main__][INFO] - Prefetch Factor: 4
[2025-08-07 13:47:38,296][__main__][INFO] - Persistent Workers: True
[2025-08-07 13:47:38,296][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/no-mult
[2025-08-07 13:47:38,296][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 13:47:38,296][__main__][INFO] - === STARTING EXPERIMENT: default-mult ===
[2025-08-07 13:47:38,296][__main__][INFO] - PID: 3481702
[2025-08-07 13:47:38,296][__main__][INFO] - SLURM_JOB_ID: 29001395
[2025-08-07 13:47:38,296][__main__][INFO] - Architecture: resnet50
[2025-08-07 13:47:38,296][__main__][INFO] - Embedding Dim: 64
[2025-08-07 13:47:38,296][__main__][INFO] - Learning Rate: 0.0003
[2025-08-07 13:47:38,297][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-07 13:47:38,297][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-07 13:47:38,297][__main__][INFO] - Channel Multipliers: [2, 4, 8, 16]
[2025-08-07 13:47:38,297][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-07 13:47:38,297][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-07 13:47:38,297][__main__][INFO] - Use LSTM: False
[2025-08-07 13:47:38,297][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-07 13:47:38,297][__main__][INFO] - Dataset: d=9, rounds_max=19, p=1.75
[2025-08-07 13:47:38,297][__main__][INFO] - Accelerator: auto
[2025-08-07 13:47:38,297][__main__][INFO] - Devices: auto
[2025-08-07 13:47:38,297][__main__][INFO] - Strategy: auto
[2025-08-07 13:47:38,297][__main__][INFO] - Num Nodes: 1
[2025-08-07 13:47:38,297][__main__][INFO] - Sync BatchNorm: True
[2025-08-07 13:47:38,297][__main__][INFO] - MWPM filtering: False
[2025-08-07 13:47:38,297][__main__][INFO] - Batch Size: auto-tuned
[2025-08-07 13:47:38,297][__main__][INFO] - Precision: bf16-mixed
[2025-08-07 13:47:38,297][__main__][INFO] - Max Steps: 50000
[2025-08-07 13:47:38,297][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-07 13:47:38,297][__main__][INFO] - Log every 100 steps
[2025-08-07 13:47:38,297][__main__][INFO] - Num Workers: 16
[2025-08-07 13:47:38,298][__main__][INFO] - Prefetch Factor: 4
[2025-08-07 13:47:38,298][__main__][INFO] - Persistent Workers: True
[2025-08-07 13:47:38,298][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/default-mult
[2025-08-07 13:47:38,306][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 13:47:38,307][__main__][INFO] - === STARTING EXPERIMENT: small-mult ===
[2025-08-07 13:47:38,307][__main__][INFO] - PID: 3481701
[2025-08-07 13:47:38,307][__main__][INFO] - SLURM_JOB_ID: 29001393
[2025-08-07 13:47:38,307][__main__][INFO] - Architecture: resnet50
[2025-08-07 13:47:38,307][__main__][INFO] - Embedding Dim: 64
[2025-08-07 13:47:38,307][__main__][INFO] - Learning Rate: 0.0003
[2025-08-07 13:47:38,307][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-07 13:47:38,307][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-07 13:47:38,307][__main__][INFO] - Channel Multipliers: [2, 2.5, 3, 3.5]
[2025-08-07 13:47:38,307][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-07 13:47:38,307][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-07 13:47:38,307][__main__][INFO] - Use LSTM: False
[2025-08-07 13:47:38,307][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-07 13:47:38,307][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-07 13:47:38,307][__main__][INFO] - Initializing wandb logger with params
[2025-08-07 13:47:38,307][__main__][INFO] - Dataset: d=9, rounds_max=19, p=1.75
[2025-08-07 13:47:38,307][__main__][INFO] - Accelerator: auto
[2025-08-07 13:47:38,308][__main__][INFO] - Devices: auto
[2025-08-07 13:47:38,308][__main__][INFO] - Strategy: auto
[2025-08-07 13:47:38,308][__main__][INFO] - Num Nodes: 1
[2025-08-07 13:47:38,308][__main__][INFO] - Sync BatchNorm: True
[2025-08-07 13:47:38,308][__main__][INFO] - MWPM filtering: False
[2025-08-07 13:47:38,308][__main__][INFO] - Batch Size: auto-tuned
[2025-08-07 13:47:38,308][__main__][INFO] - Precision: bf16-mixed
[2025-08-07 13:47:38,308][__main__][INFO] - Max Steps: 50000
[2025-08-07 13:47:38,308][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-07 13:47:38,308][__main__][INFO] - Log every 100 steps
[2025-08-07 13:47:38,308][__main__][INFO] - Num Workers: 16
[2025-08-07 13:47:38,308][__main__][INFO] - Prefetch Factor: 4
[2025-08-07 13:47:38,308][__main__][INFO] - Persistent Workers: True
[2025-08-07 13:47:38,308][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/small-mult
[2025-08-07 13:47:38,310][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-07 13:47:38,310][__main__][INFO] - Initializing wandb logger with params
[2025-08-07 13:47:38,316][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-07 13:47:38,316][__main__][INFO] - Initializing wandb logger with params
[2025-08-07 13:47:41,028][__main__][INFO] - Saved new W&B run ID to file: owvbkbu9
[2025-08-07 13:47:41,029][__main__][INFO] - Saved new W&B run ID to file: dmk87sv6
[2025-08-07 13:47:41,031][__main__][INFO] - Saved new W&B run ID to file: 48mxg2vi
[2025-08-07 13:47:41,075][__main__][INFO] - === AUTO-TUNING BATCH SIZE ===
[2025-08-07 13:47:41,075][__main__][INFO] - === AUTO-TUNING BATCH SIZE ===
[2025-08-07 13:47:41,099][__main__][INFO] - === AUTO-TUNING BATCH SIZE ===
[2025-08-07 13:47:41,762][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 13:47:42,482][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 13:47:43,190][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 13:48:34,174][__main__][INFO] - Found optimal batch size 296
[2025-08-07 13:48:34,181][__main__][INFO] - Saved batch size 236 to file
[2025-08-07 13:48:34,181][__main__][INFO] - Optimal per-GPU batch size found: 236
[2025-08-07 13:48:34,181][__main__][INFO] - Effective total batch size across 1 device(s): 236
[2025-08-07 13:48:34,185][__main__][INFO] - Saved metadata: {'timestamp': 1754588914.182078, 'slurm_job_id': '29001395', 'batch_size': 236, 'num_devices': 1, 'effective_batch_size': 236}
[2025-08-07 13:48:34,309][__main__][INFO] - === STARTING TRAINING ===
[2025-08-07 13:48:34,314][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 13:48:48,629][__main__][INFO] - Found optimal batch size 767
[2025-08-07 13:48:48,639][__main__][INFO] - Saved batch size 613 to file
[2025-08-07 13:48:48,639][__main__][INFO] - Optimal per-GPU batch size found: 613
[2025-08-07 13:48:48,639][__main__][INFO] - Effective total batch size across 1 device(s): 613
[2025-08-07 13:48:48,642][__main__][INFO] - Saved metadata: {'timestamp': 1754588928.639696, 'slurm_job_id': '29001393', 'batch_size': 613, 'num_devices': 1, 'effective_batch_size': 613}
[2025-08-07 13:48:49,051][__main__][INFO] - === STARTING TRAINING ===
[2025-08-07 13:48:49,056][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 13:48:50,215][__main__][INFO] - Found optimal batch size 2090
[2025-08-07 13:48:50,220][__main__][INFO] - Saved batch size 1672 to file
[2025-08-07 13:48:50,220][__main__][INFO] - Optimal per-GPU batch size found: 1672
[2025-08-07 13:48:50,220][__main__][INFO] - Effective total batch size across 1 device(s): 1672
[2025-08-07 13:48:50,224][__main__][INFO] - Saved metadata: {'timestamp': 1754588930.2206068, 'slurm_job_id': '29001391', 'batch_size': 1672, 'num_devices': 1, 'effective_batch_size': 1672}
[2025-08-07 13:48:50,316][__main__][INFO] - === STARTING TRAINING ===
[2025-08-07 13:48:50,322][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 13:54:35,206][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 13:54:35,207][__main__][INFO] - === STARTING EXPERIMENT: no-mult ===
[2025-08-07 13:54:35,207][__main__][INFO] - PID: 4138759
[2025-08-07 13:54:35,207][__main__][INFO] - SLURM_JOB_ID: 29001391
[2025-08-07 13:54:35,207][__main__][INFO] - Architecture: resnet50
[2025-08-07 13:54:35,207][__main__][INFO] - Embedding Dim: 64
[2025-08-07 13:54:35,207][__main__][INFO] - Learning Rate: 0.0003
[2025-08-07 13:54:35,207][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-07 13:54:35,207][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-07 13:54:35,207][__main__][INFO] - Channel Multipliers: [1, 1, 1, 1]
[2025-08-07 13:54:35,207][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-07 13:54:35,207][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-07 13:54:35,207][__main__][INFO] - Use LSTM: False
[2025-08-07 13:54:35,207][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-07 13:54:35,207][__main__][INFO] - Dataset: d=9, rounds_max=19, p=1.75
[2025-08-07 13:54:35,207][__main__][INFO] - Accelerator: auto
[2025-08-07 13:54:35,208][__main__][INFO] - Devices: auto
[2025-08-07 13:54:35,208][__main__][INFO] - Strategy: auto
[2025-08-07 13:54:35,208][__main__][INFO] - Num Nodes: 1
[2025-08-07 13:54:35,208][__main__][INFO] - Sync BatchNorm: True
[2025-08-07 13:54:35,208][__main__][INFO] - MWPM filtering: False
[2025-08-07 13:54:35,208][__main__][INFO] - Batch Size: auto-tuned
[2025-08-07 13:54:35,208][__main__][INFO] - Precision: bf16-mixed
[2025-08-07 13:54:35,208][__main__][INFO] - Max Steps: 50000
[2025-08-07 13:54:35,208][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-07 13:54:35,208][__main__][INFO] - Log every 100 steps
[2025-08-07 13:54:35,208][__main__][INFO] - Num Workers: 16
[2025-08-07 13:54:35,208][__main__][INFO] - Prefetch Factor: 4
[2025-08-07 13:54:35,208][__main__][INFO] - Persistent Workers: True
[2025-08-07 13:54:35,208][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/no-mult
[2025-08-07 13:54:35,223][__main__][INFO] - Loaded W&B run ID from file: 48mxg2vi
[2025-08-07 13:54:35,223][__main__][INFO] - Setting up W&B logger with existing run ID: 48mxg2vi
[2025-08-07 13:54:35,224][__main__][INFO] - Initializing wandb logger with params
[2025-08-07 13:54:35,266][__main__][INFO] - Loaded batch size 1672 from file
[2025-08-07 13:54:37,737][__main__][INFO] - === STARTING TRAINING ===
[2025-08-07 13:54:38,572][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 13:54:46,347][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 13:54:46,347][__main__][INFO] - === STARTING EXPERIMENT: small-mult ===
[2025-08-07 13:54:46,347][__main__][INFO] - PID: 3488393
[2025-08-07 13:54:46,347][__main__][INFO] - SLURM_JOB_ID: 29001393
[2025-08-07 13:54:46,347][__main__][INFO] - Architecture: resnet50
[2025-08-07 13:54:46,347][__main__][INFO] - Embedding Dim: 64
[2025-08-07 13:54:46,347][__main__][INFO] - Learning Rate: 0.0003
[2025-08-07 13:54:46,347][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-07 13:54:46,347][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-07 13:54:46,347][__main__][INFO] - Channel Multipliers: [2, 2.5, 3, 3.5]
[2025-08-07 13:54:46,347][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-07 13:54:46,347][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-07 13:54:46,347][__main__][INFO] - Use LSTM: False
[2025-08-07 13:54:46,347][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-07 13:54:46,348][__main__][INFO] - Dataset: d=9, rounds_max=19, p=1.75
[2025-08-07 13:54:46,348][__main__][INFO] - Accelerator: auto
[2025-08-07 13:54:46,348][__main__][INFO] - Devices: auto
[2025-08-07 13:54:46,348][__main__][INFO] - Strategy: auto
[2025-08-07 13:54:46,348][__main__][INFO] - Num Nodes: 1
[2025-08-07 13:54:46,348][__main__][INFO] - Sync BatchNorm: True
[2025-08-07 13:54:46,348][__main__][INFO] - MWPM filtering: False
[2025-08-07 13:54:46,348][__main__][INFO] - Batch Size: auto-tuned
[2025-08-07 13:54:46,348][__main__][INFO] - Precision: bf16-mixed
[2025-08-07 13:54:46,348][__main__][INFO] - Max Steps: 50000
[2025-08-07 13:54:46,348][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-07 13:54:46,348][__main__][INFO] - Log every 100 steps
[2025-08-07 13:54:46,348][__main__][INFO] - Num Workers: 16
[2025-08-07 13:54:46,348][__main__][INFO] - Prefetch Factor: 4
[2025-08-07 13:54:46,348][__main__][INFO] - Persistent Workers: True
[2025-08-07 13:54:46,348][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/small-mult
[2025-08-07 13:54:46,351][__main__][INFO] - Loaded W&B run ID from file: dmk87sv6
[2025-08-07 13:54:46,351][__main__][INFO] - Setting up W&B logger with existing run ID: dmk87sv6
[2025-08-07 13:54:46,351][__main__][INFO] - Initializing wandb logger with params
[2025-08-07 13:54:46,356][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 13:54:46,356][__main__][INFO] - === STARTING EXPERIMENT: default-mult ===
[2025-08-07 13:54:46,356][__main__][INFO] - PID: 3488394
[2025-08-07 13:54:46,356][__main__][INFO] - SLURM_JOB_ID: 29001395
[2025-08-07 13:54:46,356][__main__][INFO] - Architecture: resnet50
[2025-08-07 13:54:46,357][__main__][INFO] - Embedding Dim: 64
[2025-08-07 13:54:46,357][__main__][INFO] - Learning Rate: 0.0003
[2025-08-07 13:54:46,357][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-07 13:54:46,357][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-07 13:54:46,357][__main__][INFO] - Channel Multipliers: [2, 4, 8, 16]
[2025-08-07 13:54:46,357][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-07 13:54:46,357][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-07 13:54:46,357][__main__][INFO] - Use LSTM: False
[2025-08-07 13:54:46,357][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-07 13:54:46,357][__main__][INFO] - Dataset: d=9, rounds_max=19, p=1.75
[2025-08-07 13:54:46,357][__main__][INFO] - Accelerator: auto
[2025-08-07 13:54:46,357][__main__][INFO] - Devices: auto
[2025-08-07 13:54:46,357][__main__][INFO] - Strategy: auto
[2025-08-07 13:54:46,357][__main__][INFO] - Num Nodes: 1
[2025-08-07 13:54:46,357][__main__][INFO] - Sync BatchNorm: True
[2025-08-07 13:54:46,357][__main__][INFO] - MWPM filtering: False
[2025-08-07 13:54:46,357][__main__][INFO] - Batch Size: auto-tuned
[2025-08-07 13:54:46,357][__main__][INFO] - Precision: bf16-mixed
[2025-08-07 13:54:46,357][__main__][INFO] - Max Steps: 50000
[2025-08-07 13:54:46,358][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-07 13:54:46,358][__main__][INFO] - Log every 100 steps
[2025-08-07 13:54:46,358][__main__][INFO] - Num Workers: 16
[2025-08-07 13:54:46,358][__main__][INFO] - Prefetch Factor: 4
[2025-08-07 13:54:46,358][__main__][INFO] - Persistent Workers: True
[2025-08-07 13:54:46,358][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/default-mult
[2025-08-07 13:54:46,360][__main__][INFO] - Loaded W&B run ID from file: owvbkbu9
[2025-08-07 13:54:46,360][__main__][INFO] - Setting up W&B logger with existing run ID: owvbkbu9
[2025-08-07 13:54:46,360][__main__][INFO] - Initializing wandb logger with params
[2025-08-07 13:54:46,388][__main__][INFO] - Loaded batch size 613 from file
[2025-08-07 13:54:46,433][__main__][INFO] - Loaded batch size 236 from file
[2025-08-07 13:54:48,424][__main__][INFO] - === STARTING TRAINING ===
[2025-08-07 13:54:48,426][__main__][INFO] - === STARTING TRAINING ===
[2025-08-07 13:54:48,915][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 13:54:49,469][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 14:30:57,270][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 14:30:57,271][__main__][INFO] - === STARTING EXPERIMENT: no-mult ===
[2025-08-07 14:30:57,271][__main__][INFO] - PID: 3615071
[2025-08-07 14:30:57,271][__main__][INFO] - SLURM_JOB_ID: 29001391
[2025-08-07 14:30:57,271][__main__][INFO] - Architecture: resnet50
[2025-08-07 14:30:57,271][__main__][INFO] - Embedding Dim: 64
[2025-08-07 14:30:57,271][__main__][INFO] - Learning Rate: 0.0003
[2025-08-07 14:30:57,271][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-07 14:30:57,271][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-07 14:30:57,271][__main__][INFO] - Channel Multipliers: [1, 1, 1, 1]
[2025-08-07 14:30:57,271][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-07 14:30:57,271][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-07 14:30:57,271][__main__][INFO] - Use LSTM: False
[2025-08-07 14:30:57,272][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-07 14:30:57,272][__main__][INFO] - Dataset: d=9, rounds_max=19, p=1.75
[2025-08-07 14:30:57,272][__main__][INFO] - Accelerator: auto
[2025-08-07 14:30:57,272][__main__][INFO] - Devices: auto
[2025-08-07 14:30:57,272][__main__][INFO] - Strategy: auto
[2025-08-07 14:30:57,272][__main__][INFO] - Num Nodes: 1
[2025-08-07 14:30:57,272][__main__][INFO] - Sync BatchNorm: True
[2025-08-07 14:30:57,272][__main__][INFO] - MWPM filtering: False
[2025-08-07 14:30:57,272][__main__][INFO] - Batch Size: auto-tuned
[2025-08-07 14:30:57,272][__main__][INFO] - Precision: bf16-mixed
[2025-08-07 14:30:57,272][__main__][INFO] - Max Steps: 50000
[2025-08-07 14:30:57,272][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-07 14:30:57,272][__main__][INFO] - Log every 100 steps
[2025-08-07 14:30:57,272][__main__][INFO] - Num Workers: 16
[2025-08-07 14:30:57,272][__main__][INFO] - Prefetch Factor: 4
[2025-08-07 14:30:57,272][__main__][INFO] - Persistent Workers: True
[2025-08-07 14:30:57,272][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/no-mult
[2025-08-07 14:30:57,285][__main__][INFO] - Found latest checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/no-mult/checkpoints/no-mult-6932-0.2201.ckpt
[2025-08-07 14:30:57,288][__main__][INFO] - Loaded W&B run ID from file: 48mxg2vi
[2025-08-07 14:30:57,288][__main__][INFO] - Setting up W&B logger with existing run ID: 48mxg2vi
[2025-08-07 14:30:57,288][__main__][INFO] - Initializing wandb logger with params
[2025-08-07 14:30:57,323][__main__][INFO] - Loaded batch size 1672 from file
[2025-08-07 14:30:59,828][__main__][INFO] - === STARTING TRAINING ===
[2025-08-07 14:30:59,828][__main__][INFO] - Resuming from checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/no-mult/checkpoints/no-mult-6932-0.2201.ckpt
[2025-08-07 14:31:00,436][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 14:57:40,121][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 14:57:40,122][__main__][INFO] - === STARTING EXPERIMENT: no-mult ===
[2025-08-07 14:57:40,122][__main__][INFO] - PID: 3594721
[2025-08-07 14:57:40,122][__main__][INFO] - SLURM_JOB_ID: 29001391
[2025-08-07 14:57:40,122][__main__][INFO] - Architecture: resnet50
[2025-08-07 14:57:40,122][__main__][INFO] - Embedding Dim: 64
[2025-08-07 14:57:40,122][__main__][INFO] - Learning Rate: 0.0003
[2025-08-07 14:57:40,122][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-07 14:57:40,122][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-07 14:57:40,123][__main__][INFO] - Channel Multipliers: [1, 1, 1, 1]
[2025-08-07 14:57:40,123][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-07 14:57:40,123][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-07 14:57:40,123][__main__][INFO] - Use LSTM: False
[2025-08-07 14:57:40,123][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-07 14:57:40,123][__main__][INFO] - Dataset: d=9, rounds_max=19, p=1.75
[2025-08-07 14:57:40,123][__main__][INFO] - Accelerator: auto
[2025-08-07 14:57:40,123][__main__][INFO] - Devices: auto
[2025-08-07 14:57:40,123][__main__][INFO] - Strategy: auto
[2025-08-07 14:57:40,123][__main__][INFO] - Num Nodes: 1
[2025-08-07 14:57:40,123][__main__][INFO] - Sync BatchNorm: True
[2025-08-07 14:57:40,123][__main__][INFO] - MWPM filtering: False
[2025-08-07 14:57:40,123][__main__][INFO] - Batch Size: auto-tuned
[2025-08-07 14:57:40,123][__main__][INFO] - Precision: bf16-mixed
[2025-08-07 14:57:40,123][__main__][INFO] - Max Steps: 50000
[2025-08-07 14:57:40,123][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-07 14:57:40,123][__main__][INFO] - Log every 100 steps
[2025-08-07 14:57:40,123][__main__][INFO] - Num Workers: 16
[2025-08-07 14:57:40,123][__main__][INFO] - Prefetch Factor: 4
[2025-08-07 14:57:40,123][__main__][INFO] - Persistent Workers: True
[2025-08-07 14:57:40,124][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/no-mult
[2025-08-07 14:57:40,136][__main__][INFO] - Found latest checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/no-mult/checkpoints/no-mult-10401-0.1762.ckpt
[2025-08-07 14:57:40,138][__main__][INFO] - Loaded W&B run ID from file: 48mxg2vi
[2025-08-07 14:57:40,138][__main__][INFO] - Setting up W&B logger with existing run ID: 48mxg2vi
[2025-08-07 14:57:40,139][__main__][INFO] - Initializing wandb logger with params
[2025-08-07 14:57:40,193][__main__][INFO] - Loaded batch size 1672 from file
[2025-08-07 14:57:43,126][__main__][INFO] - === STARTING TRAINING ===
[2025-08-07 14:57:43,126][__main__][INFO] - Resuming from checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/no-mult/checkpoints/no-mult-10401-0.1762.ckpt
[2025-08-07 14:57:43,929][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 15:25:16,841][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 15:25:16,842][__main__][INFO] - === STARTING EXPERIMENT: small-mult-big-emb ===
[2025-08-07 15:25:16,842][__main__][INFO] - PID: 1731206
[2025-08-07 15:25:16,842][__main__][INFO] - SLURM_JOB_ID: 29004377
[2025-08-07 15:25:16,842][__main__][INFO] - Architecture: resnet50
[2025-08-07 15:25:16,842][__main__][INFO] - Embedding Dim: 128
[2025-08-07 15:25:16,842][__main__][INFO] - Learning Rate: 0.0003
[2025-08-07 15:25:16,842][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-07 15:25:16,842][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-07 15:25:16,842][__main__][INFO] - Channel Multipliers: [2, 2.5, 3, 3.5]
[2025-08-07 15:25:16,842][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-07 15:25:16,842][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-07 15:25:16,843][__main__][INFO] - Use LSTM: False
[2025-08-07 15:25:16,843][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-07 15:25:16,843][__main__][INFO] - Dataset: d=9, rounds_max=19, p=1.75
[2025-08-07 15:25:16,843][__main__][INFO] - Accelerator: auto
[2025-08-07 15:25:16,843][__main__][INFO] - Devices: auto
[2025-08-07 15:25:16,843][__main__][INFO] - Strategy: auto
[2025-08-07 15:25:16,843][__main__][INFO] - Num Nodes: 1
[2025-08-07 15:25:16,843][__main__][INFO] - Sync BatchNorm: True
[2025-08-07 15:25:16,843][__main__][INFO] - MWPM filtering: False
[2025-08-07 15:25:16,843][__main__][INFO] - Batch Size: auto-tuned
[2025-08-07 15:25:16,843][__main__][INFO] - Precision: bf16-mixed
[2025-08-07 15:25:16,843][__main__][INFO] - Max Steps: 50000
[2025-08-07 15:25:16,843][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-07 15:25:16,843][__main__][INFO] - Log every 100 steps
[2025-08-07 15:25:16,843][__main__][INFO] - Num Workers: 16
[2025-08-07 15:25:16,843][__main__][INFO] - Prefetch Factor: 4
[2025-08-07 15:25:16,843][__main__][INFO] - Persistent Workers: True
[2025-08-07 15:25:16,843][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/small-mult-big-emb
[2025-08-07 15:25:16,851][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-07 15:25:16,851][__main__][INFO] - Initializing wandb logger with params
[2025-08-07 15:25:21,799][__main__][INFO] - Saved new W&B run ID to file: bk7le15v
[2025-08-07 15:25:21,918][__main__][INFO] - === AUTO-TUNING BATCH SIZE ===
[2025-08-07 15:25:22,754][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 15:26:20,436][__main__][INFO] - Found optimal batch size 384
[2025-08-07 15:26:20,443][__main__][INFO] - Saved batch size 307 to file
[2025-08-07 15:26:20,443][__main__][INFO] - Optimal per-GPU batch size found: 307
[2025-08-07 15:26:20,443][__main__][INFO] - Effective total batch size across 1 device(s): 307
[2025-08-07 15:26:20,447][__main__][INFO] - Saved metadata: {'timestamp': 1754594780.4440134, 'slurm_job_id': '29004377', 'batch_size': 307, 'num_devices': 1, 'effective_batch_size': 307}
[2025-08-07 15:26:20,631][__main__][INFO] - === STARTING TRAINING ===
[2025-08-07 15:26:20,635][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 15:58:58,928][__main__][ERROR] - === TRAINING FAILED: DataLoader worker (pid 3488598) is killed by signal: Terminated.  ===
[2025-08-07 16:02:33,579][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 16:02:33,580][__main__][INFO] - === STARTING EXPERIMENT: default-mult ===
[2025-08-07 16:02:33,580][__main__][INFO] - PID: 472486
[2025-08-07 16:02:33,581][__main__][INFO] - SLURM_JOB_ID: 29001395
[2025-08-07 16:02:33,581][__main__][INFO] - Architecture: resnet50
[2025-08-07 16:02:33,581][__main__][INFO] - Embedding Dim: 64
[2025-08-07 16:02:33,581][__main__][INFO] - Learning Rate: 0.0003
[2025-08-07 16:02:33,581][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-07 16:02:33,581][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-07 16:02:33,581][__main__][INFO] - Channel Multipliers: [2, 4, 8, 16]
[2025-08-07 16:02:33,581][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-07 16:02:33,581][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-07 16:02:33,581][__main__][INFO] - Use LSTM: False
[2025-08-07 16:02:33,582][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-07 16:02:33,582][__main__][INFO] - Dataset: d=9, rounds_max=19, p=1.75
[2025-08-07 16:02:33,582][__main__][INFO] - Accelerator: auto
[2025-08-07 16:02:33,582][__main__][INFO] - Devices: auto
[2025-08-07 16:02:33,582][__main__][INFO] - Strategy: auto
[2025-08-07 16:02:33,582][__main__][INFO] - Num Nodes: 1
[2025-08-07 16:02:33,582][__main__][INFO] - Sync BatchNorm: True
[2025-08-07 16:02:33,582][__main__][INFO] - MWPM filtering: False
[2025-08-07 16:02:33,582][__main__][INFO] - Batch Size: auto-tuned
[2025-08-07 16:02:33,582][__main__][INFO] - Precision: bf16-mixed
[2025-08-07 16:02:33,582][__main__][INFO] - Max Steps: 50000
[2025-08-07 16:02:33,583][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-07 16:02:33,583][__main__][INFO] - Log every 100 steps
[2025-08-07 16:02:33,583][__main__][INFO] - Num Workers: 16
[2025-08-07 16:02:33,583][__main__][INFO] - Prefetch Factor: 4
[2025-08-07 16:02:33,583][__main__][INFO] - Persistent Workers: True
[2025-08-07 16:02:33,583][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/default-mult
[2025-08-07 16:02:33,601][__main__][INFO] - Found latest checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/default-mult/checkpoints/default-mult-29577-0.0482.ckpt
[2025-08-07 16:02:33,604][__main__][INFO] - Loaded W&B run ID from file: owvbkbu9
[2025-08-07 16:02:33,604][__main__][INFO] - Setting up W&B logger with existing run ID: owvbkbu9
[2025-08-07 16:02:33,605][__main__][INFO] - Initializing wandb logger with params
[2025-08-07 16:02:33,742][__main__][INFO] - Loaded batch size 236 from file
[2025-08-07 16:02:35,983][__main__][INFO] - === STARTING TRAINING ===
[2025-08-07 16:02:35,983][__main__][INFO] - Resuming from checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/default-mult/checkpoints/default-mult-29577-0.0482.ckpt
[2025-08-07 16:02:36,817][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 16:15:20,764][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 16:15:20,764][__main__][INFO] - === STARTING EXPERIMENT: small-mult ===
[2025-08-07 16:15:20,764][__main__][INFO] - PID: 2045790
[2025-08-07 16:15:20,764][__main__][INFO] - SLURM_JOB_ID: 29001393
[2025-08-07 16:15:20,764][__main__][INFO] - Architecture: resnet50
[2025-08-07 16:15:20,764][__main__][INFO] - Embedding Dim: 64
[2025-08-07 16:15:20,764][__main__][INFO] - Learning Rate: 0.0003
[2025-08-07 16:15:20,764][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-07 16:15:20,765][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-07 16:15:20,765][__main__][INFO] - Channel Multipliers: [2, 2.5, 3, 3.5]
[2025-08-07 16:15:20,765][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-07 16:15:20,765][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-07 16:15:20,765][__main__][INFO] - Use LSTM: False
[2025-08-07 16:15:20,765][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-07 16:15:20,765][__main__][INFO] - Dataset: d=9, rounds_max=19, p=1.75
[2025-08-07 16:15:20,765][__main__][INFO] - Accelerator: auto
[2025-08-07 16:15:20,765][__main__][INFO] - Devices: auto
[2025-08-07 16:15:20,765][__main__][INFO] - Strategy: auto
[2025-08-07 16:15:20,765][__main__][INFO] - Num Nodes: 1
[2025-08-07 16:15:20,765][__main__][INFO] - Sync BatchNorm: True
[2025-08-07 16:15:20,765][__main__][INFO] - MWPM filtering: False
[2025-08-07 16:15:20,765][__main__][INFO] - Batch Size: auto-tuned
[2025-08-07 16:15:20,765][__main__][INFO] - Precision: bf16-mixed
[2025-08-07 16:15:20,765][__main__][INFO] - Max Steps: 50000
[2025-08-07 16:15:20,765][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-07 16:15:20,765][__main__][INFO] - Log every 100 steps
[2025-08-07 16:15:20,765][__main__][INFO] - Num Workers: 16
[2025-08-07 16:15:20,765][__main__][INFO] - Prefetch Factor: 4
[2025-08-07 16:15:20,766][__main__][INFO] - Persistent Workers: True
[2025-08-07 16:15:20,766][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/small-mult
[2025-08-07 16:15:20,776][__main__][INFO] - Found latest checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/small-mult/checkpoints/small-mult-28790-0.0533.ckpt
[2025-08-07 16:15:20,777][__main__][INFO] - Loaded W&B run ID from file: dmk87sv6
[2025-08-07 16:15:20,777][__main__][INFO] - Setting up W&B logger with existing run ID: dmk87sv6
[2025-08-07 16:15:20,777][__main__][INFO] - Initializing wandb logger with params
[2025-08-07 16:15:20,893][__main__][INFO] - Loaded batch size 613 from file
[2025-08-07 16:15:25,815][__main__][INFO] - === STARTING TRAINING ===
[2025-08-07 16:15:25,815][__main__][INFO] - Resuming from checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/small-mult/checkpoints/small-mult-28790-0.0533.ckpt
[2025-08-07 16:15:26,629][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 16:59:34,446][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 16:59:34,446][__main__][INFO] - === STARTING EXPERIMENT: small-mult-big-emb ===
[2025-08-07 16:59:34,446][__main__][INFO] - PID: 3644875
[2025-08-07 16:59:34,447][__main__][INFO] - SLURM_JOB_ID: 29004377
[2025-08-07 16:59:34,447][__main__][INFO] - Architecture: resnet50
[2025-08-07 16:59:34,447][__main__][INFO] - Embedding Dim: 128
[2025-08-07 16:59:34,447][__main__][INFO] - Learning Rate: 0.0003
[2025-08-07 16:59:34,447][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-07 16:59:34,447][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-07 16:59:34,447][__main__][INFO] - Channel Multipliers: [2, 2.5, 3, 3.5]
[2025-08-07 16:59:34,447][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-07 16:59:34,447][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-07 16:59:34,447][__main__][INFO] - Use LSTM: False
[2025-08-07 16:59:34,447][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-07 16:59:34,447][__main__][INFO] - Dataset: d=9, rounds_max=19, p=1.75
[2025-08-07 16:59:34,447][__main__][INFO] - Accelerator: auto
[2025-08-07 16:59:34,447][__main__][INFO] - Devices: auto
[2025-08-07 16:59:34,447][__main__][INFO] - Strategy: auto
[2025-08-07 16:59:34,447][__main__][INFO] - Num Nodes: 1
[2025-08-07 16:59:34,447][__main__][INFO] - Sync BatchNorm: True
[2025-08-07 16:59:34,447][__main__][INFO] - MWPM filtering: False
[2025-08-07 16:59:34,448][__main__][INFO] - Batch Size: auto-tuned
[2025-08-07 16:59:34,448][__main__][INFO] - Precision: bf16-mixed
[2025-08-07 16:59:34,448][__main__][INFO] - Max Steps: 50000
[2025-08-07 16:59:34,448][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-07 16:59:34,448][__main__][INFO] - Log every 100 steps
[2025-08-07 16:59:34,448][__main__][INFO] - Num Workers: 16
[2025-08-07 16:59:34,448][__main__][INFO] - Prefetch Factor: 4
[2025-08-07 16:59:34,448][__main__][INFO] - Persistent Workers: True
[2025-08-07 16:59:34,448][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/small-mult-big-emb
[2025-08-07 16:59:34,461][__main__][INFO] - Found latest checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/small-mult-big-emb/checkpoints/small-mult-big-emb-21807-0.0517.ckpt
[2025-08-07 16:59:34,463][__main__][INFO] - Loaded W&B run ID from file: bk7le15v
[2025-08-07 16:59:34,463][__main__][INFO] - Setting up W&B logger with existing run ID: bk7le15v
[2025-08-07 16:59:34,463][__main__][INFO] - Initializing wandb logger with params
[2025-08-07 16:59:34,510][__main__][INFO] - Loaded batch size 307 from file
[2025-08-07 16:59:36,434][__main__][INFO] - === STARTING TRAINING ===
[2025-08-07 16:59:36,435][__main__][INFO] - Resuming from checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/small-mult-big-emb/checkpoints/small-mult-big-emb-21807-0.0517.ckpt
[2025-08-07 16:59:37,135][__main__][INFO] - Set seed 42 for local rank 0
[2025-08-07 19:14:58,456][__main__][INFO] - === STARTING EXPERIMENT: curriculum-test-d7 ===
[2025-08-07 19:14:58,456][__main__][INFO] - PID: 3457545
[2025-08-07 19:14:58,456][__main__][INFO] - SLURM_JOB_ID: 29017838
[2025-08-07 19:14:58,456][__main__][INFO] - Architecture: resnet50
[2025-08-07 19:14:58,456][__main__][INFO] - Embedding Dim: 128
[2025-08-07 19:14:58,456][__main__][INFO] - Learning Rate: 0.0003
[2025-08-07 19:14:58,457][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-07 19:14:58,457][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-07 19:14:58,457][__main__][INFO] - Channel Multipliers: [2, 2.5, 3, 3.5]
[2025-08-07 19:14:58,457][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-07 19:14:58,457][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-07 19:14:58,457][__main__][INFO] - Use LSTM: False
[2025-08-07 19:14:58,457][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-07 19:14:58,457][__main__][INFO] - Dataset: d=7, rounds_max=9, p=2.1
[2025-08-07 19:14:58,457][__main__][INFO] - === 3-STAGE CURRICULUM LEARNING ENABLED ===
[2025-08-07 19:14:58,457][__main__][INFO] - Stage 1: p=0.5 for 500 steps
[2025-08-07 19:14:58,457][__main__][INFO] - Stage 2: p=0.5→1.5 over 500 steps
[2025-08-07 19:14:58,457][__main__][INFO] - Stage 3: p=1.5 for 500 steps
[2025-08-07 19:14:58,457][__main__][INFO] - Total curriculum steps: 1500
[2025-08-07 19:14:58,458][__main__][INFO] - Accelerator: auto
[2025-08-07 19:14:58,458][__main__][INFO] - Devices: auto
[2025-08-07 19:14:58,458][__main__][INFO] - Strategy: auto
[2025-08-07 19:14:58,458][__main__][INFO] - Num Nodes: 1
[2025-08-07 19:14:58,458][__main__][INFO] - Sync BatchNorm: True
[2025-08-07 19:14:58,458][__main__][INFO] - MWPM filtering: False
[2025-08-07 19:14:58,458][__main__][INFO] - Batch Size: auto-tuned
[2025-08-07 19:14:58,458][__main__][INFO] - Precision: bf16-mixed
[2025-08-07 19:14:58,458][__main__][INFO] - Max Steps: 1500 (curriculum override)
[2025-08-07 19:14:58,458][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-07 19:14:58,458][__main__][INFO] - Log every 100 steps
[2025-08-07 19:14:58,458][__main__][INFO] - Num Workers: 8
[2025-08-07 19:14:58,458][__main__][INFO] - Prefetch Factor: 4
[2025-08-07 19:14:58,458][__main__][INFO] - Persistent Workers: True
[2025-08-07 19:14:58,459][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/curriculum-test-d7
[2025-08-07 19:14:58,485][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-07 19:14:58,485][__main__][INFO] - Initializing wandb logger with params
[2025-08-07 19:15:01,278][__main__][INFO] - Saved new W&B run ID to file: xm51qon8
[2025-08-07 19:15:01,278][stage_manager][INFO] - Initialized 3-stage curriculum learning:
[2025-08-07 19:15:01,278][stage_manager][INFO] -   Stage 1: p=0.5 for 500 steps
[2025-08-07 19:15:01,278][stage_manager][INFO] -   Stage 2: p=0.5→1.5 over 500 steps
[2025-08-07 19:15:01,278][stage_manager][INFO] -   Stage 3: p=1.5 for 500 steps
[2025-08-07 19:15:01,278][stage_manager][INFO] -   Total steps: 1500
[2025-08-07 19:18:23,690][__main__][INFO] - === STARTING EXPERIMENT: curriculum-test-d7 ===
[2025-08-07 19:18:23,690][__main__][INFO] - PID: 3458114
[2025-08-07 19:18:23,690][__main__][INFO] - SLURM_JOB_ID: 29017888
[2025-08-07 19:18:23,690][__main__][INFO] - Architecture: resnet50
[2025-08-07 19:18:23,691][__main__][INFO] - Embedding Dim: 128
[2025-08-07 19:18:23,691][__main__][INFO] - Learning Rate: 0.0003
[2025-08-07 19:18:23,691][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-07 19:18:23,691][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-07 19:18:23,691][__main__][INFO] - Channel Multipliers: [2, 2.5, 3, 3.5]
[2025-08-07 19:18:23,691][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-07 19:18:23,691][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-07 19:18:23,691][__main__][INFO] - Use LSTM: False
[2025-08-07 19:18:23,691][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-07 19:18:23,691][__main__][INFO] - Dataset: d=7, rounds_max=9, p=2.1
[2025-08-07 19:18:23,691][__main__][INFO] - === 3-STAGE CURRICULUM LEARNING ENABLED ===
[2025-08-07 19:18:23,691][__main__][INFO] - Stage 1: p=0.5 for 500 steps
[2025-08-07 19:18:23,691][__main__][INFO] - Stage 2: p=0.5→1.5 over 500 steps
[2025-08-07 19:18:23,692][__main__][INFO] - Stage 3: p=1.5 for 500 steps
[2025-08-07 19:18:23,692][__main__][INFO] - Total curriculum steps: 1500
[2025-08-07 19:18:23,692][__main__][INFO] - Accelerator: auto
[2025-08-07 19:18:23,692][__main__][INFO] - Devices: auto
[2025-08-07 19:18:23,692][__main__][INFO] - Strategy: auto
[2025-08-07 19:18:23,692][__main__][INFO] - Num Nodes: 1
[2025-08-07 19:18:23,692][__main__][INFO] - Sync BatchNorm: True
[2025-08-07 19:18:23,692][__main__][INFO] - MWPM filtering: False
[2025-08-07 19:18:23,692][__main__][INFO] - Batch Size: auto-tuned
[2025-08-07 19:18:23,692][__main__][INFO] - Precision: bf16-mixed
[2025-08-07 19:18:23,692][__main__][INFO] - Max Steps: 1500 (curriculum override)
[2025-08-07 19:18:23,692][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-07 19:18:23,692][__main__][INFO] - Log every 100 steps
[2025-08-07 19:18:23,693][__main__][INFO] - Num Workers: 8
[2025-08-07 19:18:23,693][__main__][INFO] - Prefetch Factor: 4
[2025-08-07 19:18:23,693][__main__][INFO] - Persistent Workers: True
[2025-08-07 19:18:23,693][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/curriculum-test-d7
[2025-08-07 19:18:23,702][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-07 19:18:23,702][__main__][INFO] - Initializing wandb logger with params
[2025-08-07 19:18:25,584][__main__][INFO] - Saved new W&B run ID to file: 15lcjio2
[2025-08-07 19:18:25,584][stage_manager][INFO] - Initialized 3-stage curriculum learning:
[2025-08-07 19:18:25,584][stage_manager][INFO] -   Stage 1: p=0.5 for 500 steps
[2025-08-07 19:18:25,584][stage_manager][INFO] -   Stage 2: p=0.5→1.5 over 500 steps
[2025-08-07 19:18:25,585][stage_manager][INFO] -   Stage 3: p=1.5 for 500 steps
[2025-08-07 19:18:25,585][stage_manager][INFO] -   Total steps: 1500
[2025-08-07 19:18:25,784][__main__][INFO] - === AUTO-TUNING BATCH SIZE ===
[2025-08-07 19:18:25,890][data_module][INFO] - Created surface code dataset: d=7, rounds_max=9, p=2.1, batch_size=2
[2025-08-07 19:18:25,890][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 19:18:43,692][__main__][INFO] - Model loaded from checkpoint at global step 0
[2025-08-07 19:18:43,772][__main__][INFO] - Found optimal batch size 67108864
[2025-08-07 19:18:43,791][__main__][INFO] - Saved batch size 57042534 to file
[2025-08-07 19:18:43,791][__main__][INFO] - Optimal per-GPU batch size found: 57042534
[2025-08-07 19:18:43,791][__main__][INFO] - Effective total batch size across 1 device(s): 57042534
[2025-08-07 19:18:43,797][__main__][INFO] - Saved metadata: {'timestamp': 1754608723.791911, 'slurm_job_id': '29017888', 'batch_size': 57042534, 'num_devices': 1, 'effective_batch_size': 57042534}
[2025-08-07 19:18:43,885][__main__][INFO] - === STARTING TRAINING ===
[2025-08-07 19:18:43,889][data_module][INFO] - Created surface code dataset: d=7, rounds_max=9, p=2.1, batch_size=57042534
[2025-08-07 19:18:43,889][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 19:18:43,891][data_module][INFO] - Updated DataModule global_step_offset to 0 for resume
[2025-08-07 19:18:50,633][__main__][ERROR] - === TRAINING FAILED: DataLoader worker (pid(s) 3459095) exited unexpectedly ===
[2025-08-07 19:20:42,678][__main__][INFO] - === STARTING EXPERIMENT: curriculum-test-d7 ===
[2025-08-07 19:20:42,678][__main__][INFO] - PID: 3459328
[2025-08-07 19:20:42,678][__main__][INFO] - SLURM_JOB_ID: 29017925
[2025-08-07 19:20:42,679][__main__][INFO] - Architecture: resnet50
[2025-08-07 19:20:42,679][__main__][INFO] - Embedding Dim: 128
[2025-08-07 19:20:42,679][__main__][INFO] - Learning Rate: 0.0003
[2025-08-07 19:20:42,679][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-07 19:20:42,679][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-07 19:20:42,679][__main__][INFO] - Channel Multipliers: [2, 2.5, 3, 3.5]
[2025-08-07 19:20:42,679][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-07 19:20:42,679][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-07 19:20:42,679][__main__][INFO] - Use LSTM: False
[2025-08-07 19:20:42,679][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-07 19:20:42,679][__main__][INFO] - Dataset: d=7, rounds_max=9, p=2.1
[2025-08-07 19:20:42,679][__main__][INFO] - === 3-STAGE CURRICULUM LEARNING ENABLED ===
[2025-08-07 19:20:42,679][__main__][INFO] - Stage 1: p=0.5 for 500 steps
[2025-08-07 19:20:42,680][__main__][INFO] - Stage 2: p=0.5→1.5 over 500 steps
[2025-08-07 19:20:42,680][__main__][INFO] - Stage 3: p=1.5 for 500 steps
[2025-08-07 19:20:42,680][__main__][INFO] - Total curriculum steps: 1500
[2025-08-07 19:20:42,680][__main__][INFO] - Accelerator: auto
[2025-08-07 19:20:42,680][__main__][INFO] - Devices: auto
[2025-08-07 19:20:42,680][__main__][INFO] - Strategy: auto
[2025-08-07 19:20:42,680][__main__][INFO] - Num Nodes: 1
[2025-08-07 19:20:42,680][__main__][INFO] - Sync BatchNorm: True
[2025-08-07 19:20:42,680][__main__][INFO] - MWPM filtering: False
[2025-08-07 19:20:42,680][__main__][INFO] - Batch Size: auto-tuned
[2025-08-07 19:20:42,680][__main__][INFO] - Precision: bf16-mixed
[2025-08-07 19:20:42,680][__main__][INFO] - Max Steps: 1500 (curriculum override)
[2025-08-07 19:20:42,680][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-07 19:20:42,681][__main__][INFO] - Log every 100 steps
[2025-08-07 19:20:42,681][__main__][INFO] - Num Workers: 0
[2025-08-07 19:20:42,681][__main__][INFO] - Prefetch Factor: 4
[2025-08-07 19:20:42,681][__main__][INFO] - Persistent Workers: True
[2025-08-07 19:20:42,681][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/curriculum-test-d7
[2025-08-07 19:20:42,693][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-07 19:20:42,693][__main__][INFO] - Initializing wandb logger with params
[2025-08-07 19:20:44,609][__main__][INFO] - Saved new W&B run ID to file: gj0v81vg
[2025-08-07 19:20:44,610][stage_manager][INFO] - Initialized 3-stage curriculum learning:
[2025-08-07 19:20:44,610][stage_manager][INFO] -   Stage 1: p=0.5 for 500 steps
[2025-08-07 19:20:44,610][stage_manager][INFO] -   Stage 2: p=0.5→1.5 over 500 steps
[2025-08-07 19:20:44,610][stage_manager][INFO] -   Stage 3: p=1.5 for 500 steps
[2025-08-07 19:20:44,610][stage_manager][INFO] -   Total steps: 1500
[2025-08-07 19:20:44,771][__main__][INFO] - === AUTO-TUNING BATCH SIZE ===
[2025-08-07 19:20:44,872][data_module][INFO] - Created surface code dataset: d=7, rounds_max=9, p=2.1, batch_size=2
[2025-08-07 19:20:44,872][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 19:22:13,836][__main__][INFO] - === STARTING EXPERIMENT: curriculum-test-d7 ===
[2025-08-07 19:22:13,837][__main__][INFO] - PID: 3459643
[2025-08-07 19:22:13,838][__main__][INFO] - SLURM_JOB_ID: 29017951
[2025-08-07 19:22:13,838][__main__][INFO] - Architecture: resnet50
[2025-08-07 19:22:13,838][__main__][INFO] - Embedding Dim: 128
[2025-08-07 19:22:13,838][__main__][INFO] - Learning Rate: 0.0003
[2025-08-07 19:22:13,838][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-07 19:22:13,838][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-07 19:22:13,838][__main__][INFO] - Channel Multipliers: [2, 2.5, 3, 3.5]
[2025-08-07 19:22:13,838][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-07 19:22:13,838][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-07 19:22:13,838][__main__][INFO] - Use LSTM: False
[2025-08-07 19:22:13,838][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-07 19:22:13,838][__main__][INFO] - Dataset: d=7, rounds_max=9, p=2.1
[2025-08-07 19:22:13,838][__main__][INFO] - === 3-STAGE CURRICULUM LEARNING ENABLED ===
[2025-08-07 19:22:13,839][__main__][INFO] - Stage 1: p=0.5 for 500 steps
[2025-08-07 19:22:13,839][__main__][INFO] - Stage 2: p=0.5→1.5 over 500 steps
[2025-08-07 19:22:13,839][__main__][INFO] - Stage 3: p=1.5 for 500 steps
[2025-08-07 19:22:13,839][__main__][INFO] - Total curriculum steps: 1500
[2025-08-07 19:22:13,839][__main__][INFO] - Accelerator: auto
[2025-08-07 19:22:13,839][__main__][INFO] - Devices: auto
[2025-08-07 19:22:13,839][__main__][INFO] - Strategy: auto
[2025-08-07 19:22:13,839][__main__][INFO] - Num Nodes: 1
[2025-08-07 19:22:13,839][__main__][INFO] - Sync BatchNorm: True
[2025-08-07 19:22:13,839][__main__][INFO] - MWPM filtering: False
[2025-08-07 19:22:13,839][__main__][INFO] - Batch Size: auto-tuned
[2025-08-07 19:22:13,839][__main__][INFO] - Precision: bf16-mixed
[2025-08-07 19:22:13,839][__main__][INFO] - Max Steps: 1500 (curriculum override)
[2025-08-07 19:22:13,840][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-07 19:22:13,840][__main__][INFO] - Log every 100 steps
[2025-08-07 19:22:13,840][__main__][INFO] - Num Workers: 0
[2025-08-07 19:22:13,840][__main__][INFO] - Prefetch Factor: 4
[2025-08-07 19:22:13,840][__main__][INFO] - Persistent Workers: True
[2025-08-07 19:22:13,840][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/curriculum-test-d7
[2025-08-07 19:22:13,851][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-07 19:22:13,851][__main__][INFO] - Initializing wandb logger with params
[2025-08-07 19:22:15,723][__main__][INFO] - Saved new W&B run ID to file: lz2pj7uy
[2025-08-07 19:22:15,723][stage_manager][INFO] - Initialized 3-stage curriculum learning:
[2025-08-07 19:22:15,723][stage_manager][INFO] -   Stage 1: p=0.5 for 500 steps
[2025-08-07 19:22:15,723][stage_manager][INFO] -   Stage 2: p=0.5→1.5 over 500 steps
[2025-08-07 19:22:15,723][stage_manager][INFO] -   Stage 3: p=1.5 for 500 steps
[2025-08-07 19:22:15,724][stage_manager][INFO] -   Total steps: 1500
[2025-08-07 19:22:15,900][__main__][INFO] - === AUTO-TUNING BATCH SIZE ===
[2025-08-07 19:22:15,998][data_module][INFO] - Created surface code dataset: d=7, rounds_max=9, p=2.1, batch_size=2
[2025-08-07 19:22:15,998][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 19:22:28,861][__main__][INFO] - Model loaded from checkpoint at global step 0
[2025-08-07 19:22:28,903][__main__][INFO] - Found optimal batch size 67108864
[2025-08-07 19:22:28,910][__main__][INFO] - Saved batch size 57042534 to file
[2025-08-07 19:22:28,910][__main__][INFO] - Optimal per-GPU batch size found: 57042534
[2025-08-07 19:22:28,910][__main__][INFO] - Effective total batch size across 1 device(s): 57042534
[2025-08-07 19:22:28,913][__main__][INFO] - Saved metadata: {'timestamp': 1754608948.9106736, 'slurm_job_id': '29017951', 'batch_size': 57042534, 'num_devices': 1, 'effective_batch_size': 57042534}
[2025-08-07 19:22:29,048][__main__][INFO] - === STARTING TRAINING ===
[2025-08-07 19:22:29,051][data_module][INFO] - Created surface code dataset: d=7, rounds_max=9, p=2.1, batch_size=57042534
[2025-08-07 19:22:29,051][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 19:22:29,052][data_module][INFO] - Updated DataModule global_step_offset to 0 for resume
[2025-08-07 19:31:20,722][__main__][INFO] - === STARTING EXPERIMENT: curriculum-test-d7 ===
[2025-08-07 19:31:20,723][__main__][INFO] - PID: 3464258
[2025-08-07 19:31:20,723][__main__][INFO] - SLURM_JOB_ID: 29018101
[2025-08-07 19:31:20,723][__main__][INFO] - Architecture: resnet50
[2025-08-07 19:31:20,723][__main__][INFO] - Embedding Dim: 128
[2025-08-07 19:31:20,723][__main__][INFO] - Learning Rate: 0.0003
[2025-08-07 19:31:20,724][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-07 19:31:20,724][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-07 19:31:20,724][__main__][INFO] - Channel Multipliers: [2, 2.5, 3, 3.5]
[2025-08-07 19:31:20,724][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-07 19:31:20,724][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-07 19:31:20,724][__main__][INFO] - Use LSTM: False
[2025-08-07 19:31:20,724][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-07 19:31:20,724][__main__][INFO] - Dataset: d=7, rounds_max=9, p=2.1
[2025-08-07 19:31:20,724][__main__][INFO] - === 3-STAGE CURRICULUM LEARNING ENABLED ===
[2025-08-07 19:31:20,724][__main__][INFO] - Stage 1: p=0.5 for 500 steps
[2025-08-07 19:31:20,724][__main__][INFO] - Stage 2: p=0.5→1.5 over 500 steps
[2025-08-07 19:31:20,724][__main__][INFO] - Stage 3: p=1.5 for 500 steps
[2025-08-07 19:31:20,725][__main__][INFO] - Total curriculum steps: 1500
[2025-08-07 19:31:20,725][__main__][INFO] - Accelerator: auto
[2025-08-07 19:31:20,725][__main__][INFO] - Devices: auto
[2025-08-07 19:31:20,725][__main__][INFO] - Strategy: auto
[2025-08-07 19:31:20,725][__main__][INFO] - Num Nodes: 1
[2025-08-07 19:31:20,725][__main__][INFO] - Sync BatchNorm: True
[2025-08-07 19:31:20,725][__main__][INFO] - MWPM filtering: False
[2025-08-07 19:31:20,725][__main__][INFO] - Batch Size: auto-tuned
[2025-08-07 19:31:20,725][__main__][INFO] - Precision: bf16-mixed
[2025-08-07 19:31:20,725][__main__][INFO] - Max Steps: 1500 (curriculum override)
[2025-08-07 19:31:20,725][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-07 19:31:20,725][__main__][INFO] - Log every 100 steps
[2025-08-07 19:31:20,725][__main__][INFO] - Num Workers: 0
[2025-08-07 19:31:20,725][__main__][INFO] - Prefetch Factor: 4
[2025-08-07 19:31:20,726][__main__][INFO] - Persistent Workers: True
[2025-08-07 19:31:20,726][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/curriculum-test-d7
[2025-08-07 19:31:20,747][__main__][INFO] - Loaded W&B run ID from file: lz2pj7uy
[2025-08-07 19:31:20,747][__main__][INFO] - Setting up W&B logger with existing run ID: lz2pj7uy
[2025-08-07 19:31:20,747][__main__][INFO] - Initializing wandb logger with params
[2025-08-07 19:31:20,751][stage_manager][INFO] - Initialized 3-stage curriculum learning:
[2025-08-07 19:31:20,751][stage_manager][INFO] -   Stage 1: p=0.5 for 500 steps
[2025-08-07 19:31:20,751][stage_manager][INFO] -   Stage 2: p=0.5→1.5 over 500 steps
[2025-08-07 19:31:20,751][stage_manager][INFO] -   Stage 3: p=1.5 for 500 steps
[2025-08-07 19:31:20,751][stage_manager][INFO] -   Total steps: 1500
[2025-08-07 19:31:20,926][__main__][INFO] - Loaded batch size 57042534 from file
[2025-08-07 19:31:22,874][__main__][INFO] - === STARTING TRAINING ===
[2025-08-07 19:31:22,885][data_module][INFO] - Created surface code dataset: d=7, rounds_max=9, p=2.1, batch_size=57042534
[2025-08-07 19:31:22,885][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 19:34:52,691][__main__][INFO] - === STARTING EXPERIMENT: curriculum-test-d7 ===
[2025-08-07 19:34:52,691][__main__][INFO] - PID: 3468166
[2025-08-07 19:34:52,691][__main__][INFO] - SLURM_JOB_ID: 29018776
[2025-08-07 19:34:52,691][__main__][INFO] - Architecture: resnet50
[2025-08-07 19:34:52,691][__main__][INFO] - Embedding Dim: 128
[2025-08-07 19:34:52,692][__main__][INFO] - Learning Rate: 0.0003
[2025-08-07 19:34:52,692][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-07 19:34:52,692][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-07 19:34:52,692][__main__][INFO] - Channel Multipliers: [2, 2.5, 3, 3.5]
[2025-08-07 19:34:52,692][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-07 19:34:52,692][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-07 19:34:52,692][__main__][INFO] - Use LSTM: False
[2025-08-07 19:34:52,692][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-07 19:34:52,692][__main__][INFO] - Dataset: d=7, rounds_max=9, p=2.1
[2025-08-07 19:34:52,692][__main__][INFO] - === 3-STAGE CURRICULUM LEARNING ENABLED ===
[2025-08-07 19:34:52,692][__main__][INFO] - Stage 1: p=0.5 for 500 steps
[2025-08-07 19:34:52,692][__main__][INFO] - Stage 2: p=0.5→1.5 over 500 steps
[2025-08-07 19:34:52,693][__main__][INFO] - Stage 3: p=1.5 for 500 steps
[2025-08-07 19:34:52,693][__main__][INFO] - Total curriculum steps: 1500
[2025-08-07 19:34:52,693][__main__][INFO] - Accelerator: auto
[2025-08-07 19:34:52,693][__main__][INFO] - Devices: auto
[2025-08-07 19:34:52,693][__main__][INFO] - Strategy: auto
[2025-08-07 19:34:52,693][__main__][INFO] - Num Nodes: 1
[2025-08-07 19:34:52,693][__main__][INFO] - Sync BatchNorm: True
[2025-08-07 19:34:52,693][__main__][INFO] - MWPM filtering: False
[2025-08-07 19:34:52,693][__main__][INFO] - Batch Size: auto-tuned
[2025-08-07 19:34:52,693][__main__][INFO] - Precision: bf16-mixed
[2025-08-07 19:34:52,693][__main__][INFO] - Max Steps: 1500 (curriculum override)
[2025-08-07 19:34:52,693][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-07 19:34:52,693][__main__][INFO] - Log every 100 steps
[2025-08-07 19:34:52,693][__main__][INFO] - Num Workers: 0
[2025-08-07 19:34:52,694][__main__][INFO] - Prefetch Factor: 4
[2025-08-07 19:34:52,694][__main__][INFO] - Persistent Workers: True
[2025-08-07 19:34:52,694][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/curriculum-test-d7
[2025-08-07 19:34:52,731][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-07 19:34:52,732][__main__][INFO] - Initializing wandb logger with params
[2025-08-07 19:34:54,612][__main__][INFO] - Saved new W&B run ID to file: lekuo31p
[2025-08-07 19:34:54,612][stage_manager][INFO] - Initialized 3-stage curriculum learning:
[2025-08-07 19:34:54,613][stage_manager][INFO] -   Stage 1: p=0.5 for 500 steps
[2025-08-07 19:34:54,613][stage_manager][INFO] -   Stage 2: p=0.5→1.5 over 500 steps
[2025-08-07 19:34:54,613][stage_manager][INFO] -   Stage 3: p=1.5 for 500 steps
[2025-08-07 19:34:54,613][stage_manager][INFO] -   Total steps: 1500
[2025-08-07 19:34:54,792][__main__][INFO] - === AUTO-TUNING BATCH SIZE ===
[2025-08-07 19:34:54,890][data_module][INFO] - Created surface code dataset: d=7, rounds_max=9, p=2.1, batch_size=2
[2025-08-07 19:34:54,891][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 19:37:23,998][__main__][INFO] - === STARTING EXPERIMENT: curriculum-test-d7 ===
[2025-08-07 19:37:23,998][__main__][INFO] - PID: 3469202
[2025-08-07 19:37:23,998][__main__][INFO] - SLURM_JOB_ID: 29018776
[2025-08-07 19:37:23,998][__main__][INFO] - Architecture: resnet50
[2025-08-07 19:37:23,999][__main__][INFO] - Embedding Dim: 128
[2025-08-07 19:37:23,999][__main__][INFO] - Learning Rate: 0.0003
[2025-08-07 19:37:23,999][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-07 19:37:23,999][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-07 19:37:23,999][__main__][INFO] - Channel Multipliers: [2, 2.5, 3, 3.5]
[2025-08-07 19:37:23,999][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-07 19:37:23,999][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-07 19:37:23,999][__main__][INFO] - Use LSTM: False
[2025-08-07 19:37:23,999][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-07 19:37:23,999][__main__][INFO] - Dataset: d=7, rounds_max=9, p=2.1
[2025-08-07 19:37:23,999][__main__][INFO] - === 3-STAGE CURRICULUM LEARNING ENABLED ===
[2025-08-07 19:37:23,999][__main__][INFO] - Stage 1: p=0.5 for 500 steps
[2025-08-07 19:37:23,999][__main__][INFO] - Stage 2: p=0.5→1.5 over 500 steps
[2025-08-07 19:37:24,000][__main__][INFO] - Stage 3: p=1.5 for 500 steps
[2025-08-07 19:37:24,000][__main__][INFO] - Total curriculum steps: 1500
[2025-08-07 19:37:24,000][__main__][INFO] - Accelerator: auto
[2025-08-07 19:37:24,000][__main__][INFO] - Devices: auto
[2025-08-07 19:37:24,000][__main__][INFO] - Strategy: auto
[2025-08-07 19:37:24,000][__main__][INFO] - Num Nodes: 1
[2025-08-07 19:37:24,000][__main__][INFO] - Sync BatchNorm: True
[2025-08-07 19:37:24,000][__main__][INFO] - MWPM filtering: False
[2025-08-07 19:37:24,000][__main__][INFO] - Batch Size: auto-tuned
[2025-08-07 19:37:24,000][__main__][INFO] - Precision: bf16-mixed
[2025-08-07 19:37:24,000][__main__][INFO] - Max Steps: 1500 (curriculum override)
[2025-08-07 19:37:24,000][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-07 19:37:24,000][__main__][INFO] - Log every 100 steps
[2025-08-07 19:37:24,001][__main__][INFO] - Num Workers: 0
[2025-08-07 19:37:24,001][__main__][INFO] - Prefetch Factor: 4
[2025-08-07 19:37:24,001][__main__][INFO] - Persistent Workers: True
[2025-08-07 19:37:24,001][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/curriculum-test-d7
[2025-08-07 19:37:24,007][__main__][INFO] - Loaded W&B run ID from file: lekuo31p
[2025-08-07 19:37:24,007][__main__][INFO] - Setting up W&B logger with existing run ID: lekuo31p
[2025-08-07 19:37:24,007][__main__][INFO] - Initializing wandb logger with params
[2025-08-07 19:37:24,011][stage_manager][INFO] - Initialized 3-stage curriculum learning:
[2025-08-07 19:37:24,011][stage_manager][INFO] -   Stage 1: p=0.5 for 500 steps
[2025-08-07 19:37:24,011][stage_manager][INFO] -   Stage 2: p=0.5→1.5 over 500 steps
[2025-08-07 19:37:24,011][stage_manager][INFO] -   Stage 3: p=1.5 for 500 steps
[2025-08-07 19:37:24,011][stage_manager][INFO] -   Total steps: 1500
[2025-08-07 19:37:24,186][__main__][INFO] - === AUTO-TUNING BATCH SIZE ===
[2025-08-07 19:37:24,737][data_module][INFO] - Created surface code dataset: d=7, rounds_max=9, p=2.1, batch_size=2
[2025-08-07 19:37:24,737][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 19:37:25,916][data_module][INFO] - Created surface code dataset: d=7, rounds_max=9, p=2.1, batch_size=4
[2025-08-07 19:37:25,916][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 19:37:26,766][data_module][INFO] - Created surface code dataset: d=7, rounds_max=9, p=2.1, batch_size=8
[2025-08-07 19:37:26,766][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 19:37:27,564][data_module][INFO] - Created surface code dataset: d=7, rounds_max=9, p=2.1, batch_size=16
[2025-08-07 19:37:27,564][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 19:37:28,380][data_module][INFO] - Created surface code dataset: d=7, rounds_max=9, p=2.1, batch_size=32
[2025-08-07 19:37:28,380][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 19:37:29,273][data_module][INFO] - Created surface code dataset: d=7, rounds_max=9, p=2.1, batch_size=64
[2025-08-07 19:37:29,273][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 19:37:30,337][data_module][INFO] - Created surface code dataset: d=7, rounds_max=9, p=2.1, batch_size=128
[2025-08-07 19:37:30,337][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 19:37:31,970][data_module][INFO] - Created surface code dataset: d=7, rounds_max=9, p=2.1, batch_size=256
[2025-08-07 19:37:31,970][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 19:37:34,819][data_module][INFO] - Created surface code dataset: d=7, rounds_max=9, p=2.1, batch_size=512
[2025-08-07 19:37:34,819][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 19:37:35,962][data_module][INFO] - Created surface code dataset: d=7, rounds_max=9, p=2.1, batch_size=384
[2025-08-07 19:37:35,962][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 19:37:36,291][data_module][INFO] - Created surface code dataset: d=7, rounds_max=9, p=2.1, batch_size=320
[2025-08-07 19:37:36,292][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 19:37:36,689][data_module][INFO] - Created surface code dataset: d=7, rounds_max=9, p=2.1, batch_size=288
[2025-08-07 19:37:36,689][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 19:37:36,977][data_module][INFO] - Created surface code dataset: d=7, rounds_max=9, p=2.1, batch_size=272
[2025-08-07 19:37:36,977][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 19:37:37,316][data_module][INFO] - Created surface code dataset: d=7, rounds_max=9, p=2.1, batch_size=264
[2025-08-07 19:37:37,316][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 19:37:37,602][data_module][INFO] - Created surface code dataset: d=7, rounds_max=9, p=2.1, batch_size=260
[2025-08-07 19:37:37,602][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 19:37:37,888][data_module][INFO] - Created surface code dataset: d=7, rounds_max=9, p=2.1, batch_size=258
[2025-08-07 19:37:37,889][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 19:37:38,174][data_module][INFO] - Created surface code dataset: d=7, rounds_max=9, p=2.1, batch_size=257
[2025-08-07 19:37:38,174][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 19:37:38,461][data_module][INFO] - Created surface code dataset: d=7, rounds_max=9, p=2.1, batch_size=256
[2025-08-07 19:37:38,461][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 19:37:38,604][data_module][INFO] - Created surface code dataset: d=7, rounds_max=9, p=2.1, batch_size=256
[2025-08-07 19:37:38,604][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 19:37:38,973][__main__][INFO] - Model loaded from checkpoint at global step 0
[2025-08-07 19:37:39,059][__main__][INFO] - Found optimal batch size 256
[2025-08-07 19:37:39,066][__main__][INFO] - Saved batch size 217 to file
[2025-08-07 19:37:39,066][__main__][INFO] - Optimal per-GPU batch size found: 217
[2025-08-07 19:37:39,066][__main__][INFO] - Effective total batch size across 1 device(s): 217
[2025-08-07 19:37:39,071][__main__][INFO] - Saved metadata: {'timestamp': 1754609859.0667248, 'slurm_job_id': '29018776', 'batch_size': 217, 'num_devices': 1, 'effective_batch_size': 217}
[2025-08-07 19:38:45,970][__main__][INFO] - === STARTING EXPERIMENT: curriculum-test-d7 ===
[2025-08-07 19:38:45,970][__main__][INFO] - PID: 3469543
[2025-08-07 19:38:45,970][__main__][INFO] - SLURM_JOB_ID: 29018776
[2025-08-07 19:38:45,970][__main__][INFO] - Architecture: resnet50
[2025-08-07 19:38:45,970][__main__][INFO] - Embedding Dim: 128
[2025-08-07 19:38:45,970][__main__][INFO] - Learning Rate: 0.0003
[2025-08-07 19:38:45,970][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-07 19:38:45,970][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-07 19:38:45,970][__main__][INFO] - Channel Multipliers: [2, 2.5, 3, 3.5]
[2025-08-07 19:38:45,971][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-07 19:38:45,971][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-07 19:38:45,971][__main__][INFO] - Use LSTM: False
[2025-08-07 19:38:45,971][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-07 19:38:45,971][__main__][INFO] - Dataset: d=7, rounds_max=9, p=2.1
[2025-08-07 19:38:45,971][__main__][INFO] - === 3-STAGE CURRICULUM LEARNING ENABLED ===
[2025-08-07 19:38:45,971][__main__][INFO] - Stage 1: p=0.5 for 500 steps
[2025-08-07 19:38:45,971][__main__][INFO] - Stage 2: p=0.5→1.5 over 500 steps
[2025-08-07 19:38:45,971][__main__][INFO] - Stage 3: p=1.5 for 500 steps
[2025-08-07 19:38:45,971][__main__][INFO] - Total curriculum steps: 1500
[2025-08-07 19:38:45,971][__main__][INFO] - Accelerator: auto
[2025-08-07 19:38:45,971][__main__][INFO] - Devices: auto
[2025-08-07 19:38:45,972][__main__][INFO] - Strategy: auto
[2025-08-07 19:38:45,972][__main__][INFO] - Num Nodes: 1
[2025-08-07 19:38:45,972][__main__][INFO] - Sync BatchNorm: True
[2025-08-07 19:38:45,972][__main__][INFO] - MWPM filtering: False
[2025-08-07 19:38:45,972][__main__][INFO] - Batch Size: auto-tuned
[2025-08-07 19:38:45,972][__main__][INFO] - Precision: bf16-mixed
[2025-08-07 19:38:45,972][__main__][INFO] - Max Steps: 1500 (curriculum override)
[2025-08-07 19:38:45,972][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-07 19:38:45,972][__main__][INFO] - Log every 100 steps
[2025-08-07 19:38:45,972][__main__][INFO] - Num Workers: 8
[2025-08-07 19:38:45,972][__main__][INFO] - Prefetch Factor: 4
[2025-08-07 19:38:45,972][__main__][INFO] - Persistent Workers: True
[2025-08-07 19:38:45,972][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/curriculum-test-d7
[2025-08-07 19:38:45,982][__main__][INFO] - Loaded W&B run ID from file: lekuo31p
[2025-08-07 19:38:45,982][__main__][INFO] - Setting up W&B logger with existing run ID: lekuo31p
[2025-08-07 19:38:45,982][__main__][INFO] - Initializing wandb logger with params
[2025-08-07 19:38:45,986][stage_manager][INFO] - Initialized 3-stage curriculum learning:
[2025-08-07 19:38:45,986][stage_manager][INFO] -   Stage 1: p=0.5 for 500 steps
[2025-08-07 19:38:45,986][stage_manager][INFO] -   Stage 2: p=0.5→1.5 over 500 steps
[2025-08-07 19:38:45,986][stage_manager][INFO] -   Stage 3: p=1.5 for 500 steps
[2025-08-07 19:38:45,986][stage_manager][INFO] -   Total steps: 1500
[2025-08-07 19:38:46,167][__main__][INFO] - Loaded batch size 217 from file
[2025-08-07 19:38:48,065][__main__][INFO] - === STARTING TRAINING ===
[2025-08-07 19:38:48,234][data_module][INFO] - Created surface code dataset: d=7, rounds_max=9, p=2.1, batch_size=217
[2025-08-07 19:38:48,234][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 19:40:47,658][stage_manager][INFO] - === STAGE TRANSITION: Stage 1 → Stage 2 ===
[2025-08-07 19:40:47,661][stage_manager][INFO] - Global step: 500
[2025-08-07 19:40:47,661][stage_manager][INFO] - Current p: 0.500
[2025-08-07 19:40:47,661][stage_manager][INFO] - Starting curriculum learning: p=0.5→1.5
[2025-08-07 19:42:47,512][stage_manager][INFO] - === STAGE TRANSITION: Stage 2 → Stage 3 ===
[2025-08-07 19:42:47,515][stage_manager][INFO] - Global step: 1000
[2025-08-07 19:42:47,515][stage_manager][INFO] - Current p: 1.500
[2025-08-07 19:42:47,515][stage_manager][INFO] - Starting final stage at p=1.5
[2025-08-07 19:49:57,746][__main__][INFO] - === STARTING EXPERIMENT: d19-curriculum ===
[2025-08-07 19:49:57,747][__main__][INFO] - PID: 1413034
[2025-08-07 19:49:57,747][__main__][INFO] - SLURM_JOB_ID: 29019696
[2025-08-07 19:49:57,747][__main__][INFO] - Architecture: resnet50
[2025-08-07 19:49:57,747][__main__][INFO] - Embedding Dim: 128
[2025-08-07 19:49:57,748][__main__][INFO] - Learning Rate: 0.0002
[2025-08-07 19:49:57,748][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-07 19:49:57,748][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-07 19:49:57,748][__main__][INFO] - Channel Multipliers: [2, 2.5, 3, 3.5]
[2025-08-07 19:49:57,748][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-07 19:49:57,748][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-07 19:49:57,748][__main__][INFO] - Use LSTM: False
[2025-08-07 19:49:57,748][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-07 19:49:57,748][__main__][INFO] - Dataset: d=19, rounds_max=19, p=2.1
[2025-08-07 19:49:57,748][__main__][INFO] - === 3-STAGE CURRICULUM LEARNING ENABLED ===
[2025-08-07 19:49:57,748][__main__][INFO] - Stage 1: p=0.5 for 200000 steps
[2025-08-07 19:49:57,749][__main__][INFO] - Stage 2: p=0.5→2.1 over 200000 steps
[2025-08-07 19:49:57,749][__main__][INFO] - Stage 3: p=2.1 for 100000 steps
[2025-08-07 19:49:57,749][__main__][INFO] - Total curriculum steps: 500000
[2025-08-07 19:49:57,749][__main__][INFO] - Accelerator: auto
[2025-08-07 19:49:57,749][__main__][INFO] - Devices: 4
[2025-08-07 19:49:57,749][__main__][INFO] - Strategy: auto
[2025-08-07 19:49:57,749][__main__][INFO] - Num Nodes: 1
[2025-08-07 19:49:57,749][__main__][INFO] - Sync BatchNorm: True
[2025-08-07 19:49:57,749][__main__][INFO] - MWPM filtering: False
[2025-08-07 19:49:57,749][__main__][INFO] - Batch Size: auto-tuned
[2025-08-07 19:49:57,749][__main__][INFO] - Precision: bf16-mixed
[2025-08-07 19:49:57,750][__main__][INFO] - Max Steps: 500000 (curriculum override)
[2025-08-07 19:49:57,750][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-07 19:49:57,750][__main__][INFO] - Log every 100 steps
[2025-08-07 19:49:57,750][__main__][INFO] - Num Workers: 16
[2025-08-07 19:49:57,750][__main__][INFO] - Prefetch Factor: 4
[2025-08-07 19:49:57,750][__main__][INFO] - Persistent Workers: True
[2025-08-07 19:49:57,750][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d19-curriculum
[2025-08-07 19:49:57,767][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-07 19:49:57,767][__main__][INFO] - Initializing wandb logger with params
[2025-08-07 19:50:02,710][__main__][INFO] - Saved new W&B run ID to file: w3dcxslc
[2025-08-07 19:50:02,711][stage_manager][INFO] - Initialized 3-stage curriculum learning:
[2025-08-07 19:50:02,711][stage_manager][INFO] -   Stage 1: p=0.5 for 200000 steps
[2025-08-07 19:50:02,711][stage_manager][INFO] -   Stage 2: p=0.5→2.1 over 200000 steps
[2025-08-07 19:50:02,711][stage_manager][INFO] -   Stage 3: p=2.1 for 100000 steps
[2025-08-07 19:50:02,711][stage_manager][INFO] -   Total steps: 500000
[2025-08-07 19:50:02,838][__main__][INFO] - === AUTO-TUNING BATCH SIZE ===
[2025-08-07 19:50:06,689][data_module][INFO] - Created surface code dataset: d=19, rounds_max=19, p=2.1, batch_size=2
[2025-08-07 19:50:06,689][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 19:50:16,370][data_module][INFO] - Created surface code dataset: d=19, rounds_max=19, p=2.1, batch_size=4
[2025-08-07 19:50:16,370][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 19:56:53,482][__main__][INFO] - === STARTING EXPERIMENT: d19-curriculum ===
[2025-08-07 19:56:53,482][__main__][INFO] - PID: 1416063
[2025-08-07 19:56:53,482][__main__][INFO] - SLURM_JOB_ID: 29019944
[2025-08-07 19:56:53,482][__main__][INFO] - Architecture: resnet50
[2025-08-07 19:56:53,483][__main__][INFO] - Embedding Dim: 128
[2025-08-07 19:56:53,483][__main__][INFO] - Learning Rate: 0.0001
[2025-08-07 19:56:53,483][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-07 19:56:53,483][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-07 19:56:53,483][__main__][INFO] - Channel Multipliers: [2, 2.5, 3, 3.5]
[2025-08-07 19:56:53,483][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-07 19:56:53,483][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-07 19:56:53,483][__main__][INFO] - Use LSTM: False
[2025-08-07 19:56:53,483][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-07 19:56:53,483][__main__][INFO] - Dataset: d=19, rounds_max=19, p=2.1
[2025-08-07 19:56:53,483][__main__][INFO] - === 3-STAGE CURRICULUM LEARNING ENABLED ===
[2025-08-07 19:56:53,484][__main__][INFO] - Stage 1: p=0.5 for 200000 steps
[2025-08-07 19:56:53,484][__main__][INFO] - Stage 2: p=0.5→2.1 over 200000 steps
[2025-08-07 19:56:53,484][__main__][INFO] - Stage 3: p=2.1 for 100000 steps
[2025-08-07 19:56:53,484][__main__][INFO] - Total curriculum steps: 500000
[2025-08-07 19:56:53,484][__main__][INFO] - Accelerator: auto
[2025-08-07 19:56:53,484][__main__][INFO] - Devices: 4
[2025-08-07 19:56:53,484][__main__][INFO] - Strategy: auto
[2025-08-07 19:56:53,484][__main__][INFO] - Num Nodes: 1
[2025-08-07 19:56:53,484][__main__][INFO] - Sync BatchNorm: True
[2025-08-07 19:56:53,484][__main__][INFO] - MWPM filtering: False
[2025-08-07 19:56:53,484][__main__][INFO] - Batch Size: auto-tuned
[2025-08-07 19:56:53,484][__main__][INFO] - Precision: bf16-mixed
[2025-08-07 19:56:53,485][__main__][INFO] - Max Steps: 500000 (curriculum override)
[2025-08-07 19:56:53,485][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-07 19:56:53,485][__main__][INFO] - Log every 100 steps
[2025-08-07 19:56:53,485][__main__][INFO] - Num Workers: 16
[2025-08-07 19:56:53,485][__main__][INFO] - Prefetch Factor: 4
[2025-08-07 19:56:53,485][__main__][INFO] - Persistent Workers: True
[2025-08-07 19:56:53,485][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d19-curriculum
[2025-08-07 19:56:53,494][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-07 19:56:53,494][__main__][INFO] - Initializing wandb logger with params
[2025-08-07 19:56:55,660][__main__][INFO] - Saved new W&B run ID to file: y1a634wa
[2025-08-07 19:56:55,661][stage_manager][INFO] - Initialized 3-stage curriculum learning:
[2025-08-07 19:56:55,661][stage_manager][INFO] -   Stage 1: p=0.5 for 200000 steps
[2025-08-07 19:56:55,661][stage_manager][INFO] -   Stage 2: p=0.5→2.1 over 200000 steps
[2025-08-07 19:56:55,661][stage_manager][INFO] -   Stage 3: p=2.1 for 100000 steps
[2025-08-07 19:56:55,661][stage_manager][INFO] -   Total steps: 500000
[2025-08-07 19:56:55,744][__main__][INFO] - === AUTO-TUNING BATCH SIZE ===
[2025-08-07 19:56:59,434][data_module][INFO] - Created surface code dataset: d=19, rounds_max=19, p=2.1, batch_size=2
[2025-08-07 19:56:59,435][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 19:57:03,704][data_module][INFO] - Created surface code dataset: d=19, rounds_max=19, p=2.1, batch_size=4
[2025-08-07 19:57:03,704][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 19:57:07,796][data_module][INFO] - Created surface code dataset: d=19, rounds_max=19, p=2.1, batch_size=8
[2025-08-07 19:57:07,796][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 19:57:11,950][data_module][INFO] - Created surface code dataset: d=19, rounds_max=19, p=2.1, batch_size=16
[2025-08-07 19:57:11,950][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 19:57:16,347][data_module][INFO] - Created surface code dataset: d=19, rounds_max=19, p=2.1, batch_size=32
[2025-08-07 19:57:16,347][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 19:57:20,828][data_module][INFO] - Created surface code dataset: d=19, rounds_max=19, p=2.1, batch_size=64
[2025-08-07 19:57:20,829][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 19:57:26,088][data_module][INFO] - Created surface code dataset: d=19, rounds_max=19, p=2.1, batch_size=128
[2025-08-07 19:57:26,088][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 19:57:31,634][data_module][INFO] - Created surface code dataset: d=19, rounds_max=19, p=2.1, batch_size=96
[2025-08-07 19:57:31,634][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 19:57:36,361][data_module][INFO] - Created surface code dataset: d=19, rounds_max=19, p=2.1, batch_size=80
[2025-08-07 19:57:36,361][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 19:57:41,708][data_module][INFO] - Created surface code dataset: d=19, rounds_max=19, p=2.1, batch_size=88
[2025-08-07 19:57:41,709][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 19:57:47,226][data_module][INFO] - Created surface code dataset: d=19, rounds_max=19, p=2.1, batch_size=92
[2025-08-07 19:57:47,226][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 19:57:53,172][data_module][INFO] - Created surface code dataset: d=19, rounds_max=19, p=2.1, batch_size=94
[2025-08-07 19:57:53,172][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 19:57:58,938][data_module][INFO] - Created surface code dataset: d=19, rounds_max=19, p=2.1, batch_size=95
[2025-08-07 19:57:58,939][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 19:58:03,965][data_module][INFO] - Created surface code dataset: d=19, rounds_max=19, p=2.1, batch_size=94
[2025-08-07 19:58:03,966][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 19:58:05,808][data_module][INFO] - Created surface code dataset: d=19, rounds_max=19, p=2.1, batch_size=94
[2025-08-07 19:58:05,808][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 19:58:07,772][__main__][INFO] - Model loaded from checkpoint at global step 0
[2025-08-07 19:58:07,990][__main__][INFO] - Found optimal batch size 94
[2025-08-07 19:58:08,003][__main__][INFO] - Saved batch size 79 to file
[2025-08-07 19:58:08,004][__main__][INFO] - Optimal per-GPU batch size found: 79
[2025-08-07 19:58:08,004][__main__][INFO] - Effective total batch size across 4 device(s): 316
[2025-08-07 19:58:08,009][__main__][INFO] - Saved metadata: {'timestamp': 1754611088.004462, 'slurm_job_id': '29019944', 'batch_size': 79, 'num_devices': 4, 'effective_batch_size': 316}
[2025-08-07 19:58:08,442][__main__][INFO] - === STARTING TRAINING ===
[2025-08-07 20:17:09,214][__main__][INFO] - === STARTING EXPERIMENT: d7-curriculum ===
[2025-08-07 20:17:09,215][__main__][INFO] - PID: 1357497
[2025-08-07 20:17:09,215][__main__][INFO] - SLURM_JOB_ID: 29021387
[2025-08-07 20:17:09,215][__main__][INFO] - Architecture: resnet50
[2025-08-07 20:17:09,215][__main__][INFO] - Embedding Dim: 128
[2025-08-07 20:17:09,215][__main__][INFO] - Learning Rate: 0.0006
[2025-08-07 20:17:09,215][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-07 20:17:09,215][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-07 20:17:09,215][__main__][INFO] - Channel Multipliers: [2, 2.5, 3, 3.5]
[2025-08-07 20:17:09,215][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-07 20:17:09,215][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-07 20:17:09,215][__main__][INFO] - Use LSTM: False
[2025-08-07 20:17:09,215][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-07 20:17:09,215][__main__][INFO] - Dataset: d=7, rounds_max=7, p=2.1
[2025-08-07 20:17:09,216][__main__][INFO] - === 3-STAGE CURRICULUM LEARNING ENABLED ===
[2025-08-07 20:17:09,216][__main__][INFO] - Stage 1: p=0.5 for 30000 steps
[2025-08-07 20:17:09,216][__main__][INFO] - Stage 2: p=0.5→2.1 over 50000 steps
[2025-08-07 20:17:09,216][__main__][INFO] - Stage 3: p=2.1 for 20000 steps
[2025-08-07 20:17:09,216][__main__][INFO] - Total curriculum steps: 100000
[2025-08-07 20:17:09,216][__main__][INFO] - Accelerator: auto
[2025-08-07 20:17:09,216][__main__][INFO] - Devices: 4
[2025-08-07 20:17:09,216][__main__][INFO] - Strategy: auto
[2025-08-07 20:17:09,216][__main__][INFO] - Num Nodes: 1
[2025-08-07 20:17:09,216][__main__][INFO] - Sync BatchNorm: True
[2025-08-07 20:17:09,216][__main__][INFO] - MWPM filtering: False
[2025-08-07 20:17:09,216][__main__][INFO] - Batch Size: auto-tuned
[2025-08-07 20:17:09,216][__main__][INFO] - Precision: bf16-mixed
[2025-08-07 20:17:09,217][__main__][INFO] - Max Steps: 100000 (curriculum override)
[2025-08-07 20:17:09,217][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-07 20:17:09,217][__main__][INFO] - Log every 100 steps
[2025-08-07 20:17:09,217][__main__][INFO] - Num Workers: 16
[2025-08-07 20:17:09,217][__main__][INFO] - Prefetch Factor: 4
[2025-08-07 20:17:09,217][__main__][INFO] - Persistent Workers: True
[2025-08-07 20:17:09,217][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d7-curriculum
[2025-08-07 20:17:09,230][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-07 20:17:09,230][__main__][INFO] - Initializing wandb logger with params
[2025-08-07 20:17:12,147][__main__][INFO] - Saved new W&B run ID to file: gezkn6p8
[2025-08-07 20:17:12,147][stage_manager][INFO] - Initialized 3-stage curriculum learning:
[2025-08-07 20:17:12,148][stage_manager][INFO] -   Stage 1: p=0.5 for 30000 steps
[2025-08-07 20:17:12,148][stage_manager][INFO] -   Stage 2: p=0.5→2.1 over 50000 steps
[2025-08-07 20:17:12,148][stage_manager][INFO] -   Stage 3: p=2.1 for 20000 steps
[2025-08-07 20:17:12,148][stage_manager][INFO] -   Total steps: 100000
[2025-08-07 20:17:12,257][__main__][INFO] - === AUTO-TUNING BATCH SIZE ===
[2025-08-07 20:17:13,513][data_module][INFO] - Created surface code dataset: d=7, rounds_max=7, p=2.1, batch_size=2
[2025-08-07 20:17:13,513][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 20:17:19,497][data_module][INFO] - Created surface code dataset: d=7, rounds_max=7, p=2.1, batch_size=4
[2025-08-07 20:17:19,497][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 20:17:21,321][data_module][INFO] - Created surface code dataset: d=7, rounds_max=7, p=2.1, batch_size=8
[2025-08-07 20:17:21,321][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 20:17:22,577][data_module][INFO] - Created surface code dataset: d=7, rounds_max=7, p=2.1, batch_size=16
[2025-08-07 20:17:22,577][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 20:17:23,797][data_module][INFO] - Created surface code dataset: d=7, rounds_max=7, p=2.1, batch_size=32
[2025-08-07 20:17:23,797][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 20:17:25,100][data_module][INFO] - Created surface code dataset: d=7, rounds_max=7, p=2.1, batch_size=64
[2025-08-07 20:17:25,100][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 20:17:26,555][data_module][INFO] - Created surface code dataset: d=7, rounds_max=7, p=2.1, batch_size=128
[2025-08-07 20:17:26,556][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 20:17:28,440][data_module][INFO] - Created surface code dataset: d=7, rounds_max=7, p=2.1, batch_size=256
[2025-08-07 20:17:28,441][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 20:17:31,368][data_module][INFO] - Created surface code dataset: d=7, rounds_max=7, p=2.1, batch_size=512
[2025-08-07 20:17:31,369][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 20:17:35,159][data_module][INFO] - Created surface code dataset: d=7, rounds_max=7, p=2.1, batch_size=384
[2025-08-07 20:17:35,159][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 20:17:39,275][data_module][INFO] - Created surface code dataset: d=7, rounds_max=7, p=2.1, batch_size=448
[2025-08-07 20:17:39,276][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 20:17:42,640][data_module][INFO] - Created surface code dataset: d=7, rounds_max=7, p=2.1, batch_size=416
[2025-08-07 20:17:42,641][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 20:17:45,738][data_module][INFO] - Created surface code dataset: d=7, rounds_max=7, p=2.1, batch_size=400
[2025-08-07 20:17:45,738][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 20:17:49,016][data_module][INFO] - Created surface code dataset: d=7, rounds_max=7, p=2.1, batch_size=392
[2025-08-07 20:17:49,016][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 20:17:52,883][data_module][INFO] - Created surface code dataset: d=7, rounds_max=7, p=2.1, batch_size=388
[2025-08-07 20:17:52,883][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 20:17:56,714][data_module][INFO] - Created surface code dataset: d=7, rounds_max=7, p=2.1, batch_size=386
[2025-08-07 20:17:56,715][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 20:18:00,472][data_module][INFO] - Created surface code dataset: d=7, rounds_max=7, p=2.1, batch_size=385
[2025-08-07 20:18:00,472][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 20:18:04,225][data_module][INFO] - Created surface code dataset: d=7, rounds_max=7, p=2.1, batch_size=384
[2025-08-07 20:18:04,226][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 20:18:04,951][data_module][INFO] - Created surface code dataset: d=7, rounds_max=7, p=2.1, batch_size=384
[2025-08-07 20:18:04,951][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 20:18:05,461][__main__][INFO] - Model loaded from checkpoint at global step 0
[2025-08-07 20:18:05,557][__main__][INFO] - Found optimal batch size 384
[2025-08-07 20:18:05,562][__main__][INFO] - Saved batch size 326 to file
[2025-08-07 20:18:05,562][__main__][INFO] - Optimal per-GPU batch size found: 326
[2025-08-07 20:18:05,562][__main__][INFO] - Effective total batch size across 4 device(s): 1304
[2025-08-07 20:18:05,565][__main__][INFO] - Saved metadata: {'timestamp': 1754612285.562896, 'slurm_job_id': '29021387', 'batch_size': 326, 'num_devices': 4, 'effective_batch_size': 1304}
[2025-08-07 20:20:11,200][__main__][INFO] - === STARTING EXPERIMENT: d7-curriculum ===
[2025-08-07 20:20:11,201][__main__][INFO] - PID: 1359317
[2025-08-07 20:20:11,201][__main__][INFO] - SLURM_JOB_ID: 29021482
[2025-08-07 20:20:11,201][__main__][INFO] - Architecture: resnet50
[2025-08-07 20:20:11,201][__main__][INFO] - Embedding Dim: 128
[2025-08-07 20:20:11,201][__main__][INFO] - Learning Rate: 0.0006
[2025-08-07 20:20:11,201][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-07 20:20:11,201][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-07 20:20:11,201][__main__][INFO] - Channel Multipliers: [2, 2.5, 3, 3.5]
[2025-08-07 20:20:11,201][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-07 20:20:11,201][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-07 20:20:11,201][__main__][INFO] - Use LSTM: False
[2025-08-07 20:20:11,202][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-07 20:20:11,202][__main__][INFO] - Dataset: d=7, rounds_max=7, p=2.1
[2025-08-07 20:20:11,202][__main__][INFO] - === 3-STAGE CURRICULUM LEARNING ENABLED ===
[2025-08-07 20:20:11,202][__main__][INFO] - Stage 1: p=0.5 for 30000 steps
[2025-08-07 20:20:11,202][__main__][INFO] - Stage 2: p=0.5→2.1 over 50000 steps
[2025-08-07 20:20:11,202][__main__][INFO] - Stage 3: p=2.1 for 20000 steps
[2025-08-07 20:20:11,202][__main__][INFO] - Total curriculum steps: 100000
[2025-08-07 20:20:11,202][__main__][INFO] - Accelerator: auto
[2025-08-07 20:20:11,202][__main__][INFO] - Devices: auto
[2025-08-07 20:20:11,202][__main__][INFO] - Strategy: auto
[2025-08-07 20:20:11,202][__main__][INFO] - Num Nodes: 1
[2025-08-07 20:20:11,202][__main__][INFO] - Sync BatchNorm: True
[2025-08-07 20:20:11,202][__main__][INFO] - MWPM filtering: False
[2025-08-07 20:20:11,203][__main__][INFO] - Batch Size: auto-tuned
[2025-08-07 20:20:11,203][__main__][INFO] - Precision: bf16-mixed
[2025-08-07 20:20:11,203][__main__][INFO] - Max Steps: 100000 (curriculum override)
[2025-08-07 20:20:11,203][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-07 20:20:11,203][__main__][INFO] - Log every 100 steps
[2025-08-07 20:20:11,203][__main__][INFO] - Num Workers: 16
[2025-08-07 20:20:11,203][__main__][INFO] - Prefetch Factor: 4
[2025-08-07 20:20:11,203][__main__][INFO] - Persistent Workers: True
[2025-08-07 20:20:11,203][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d7-curriculum
[2025-08-07 20:20:11,220][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-07 20:20:11,220][__main__][INFO] - Initializing wandb logger with params
[2025-08-07 20:20:13,168][__main__][INFO] - Saved new W&B run ID to file: 5a9j1vga
[2025-08-07 20:20:13,168][stage_manager][INFO] - Initialized 3-stage curriculum learning:
[2025-08-07 20:20:13,169][stage_manager][INFO] -   Stage 1: p=0.5 for 30000 steps
[2025-08-07 20:20:13,169][stage_manager][INFO] -   Stage 2: p=0.5→2.1 over 50000 steps
[2025-08-07 20:20:13,169][stage_manager][INFO] -   Stage 3: p=2.1 for 20000 steps
[2025-08-07 20:20:13,169][stage_manager][INFO] -   Total steps: 100000
[2025-08-07 20:20:13,315][__main__][INFO] - === AUTO-TUNING BATCH SIZE ===
[2025-08-07 20:20:13,932][data_module][INFO] - Created surface code dataset: d=7, rounds_max=7, p=2.1, batch_size=2
[2025-08-07 20:20:13,933][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 20:20:15,421][data_module][INFO] - Created surface code dataset: d=7, rounds_max=7, p=2.1, batch_size=4
[2025-08-07 20:20:15,422][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 20:20:16,704][data_module][INFO] - Created surface code dataset: d=7, rounds_max=7, p=2.1, batch_size=8
[2025-08-07 20:20:16,704][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 20:20:17,942][data_module][INFO] - Created surface code dataset: d=7, rounds_max=7, p=2.1, batch_size=16
[2025-08-07 20:20:17,942][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 20:20:19,194][data_module][INFO] - Created surface code dataset: d=7, rounds_max=7, p=2.1, batch_size=32
[2025-08-07 20:20:19,194][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 20:20:20,513][data_module][INFO] - Created surface code dataset: d=7, rounds_max=7, p=2.1, batch_size=64
[2025-08-07 20:20:20,514][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 20:20:22,005][data_module][INFO] - Created surface code dataset: d=7, rounds_max=7, p=2.1, batch_size=128
[2025-08-07 20:20:22,005][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 20:20:23,922][data_module][INFO] - Created surface code dataset: d=7, rounds_max=7, p=2.1, batch_size=256
[2025-08-07 20:20:23,922][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 20:20:26,871][data_module][INFO] - Created surface code dataset: d=7, rounds_max=7, p=2.1, batch_size=512
[2025-08-07 20:20:26,872][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 20:20:30,385][data_module][INFO] - Created surface code dataset: d=7, rounds_max=7, p=2.1, batch_size=384
[2025-08-07 20:20:30,386][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 20:20:34,464][data_module][INFO] - Created surface code dataset: d=7, rounds_max=7, p=2.1, batch_size=448
[2025-08-07 20:20:34,465][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 20:20:37,796][data_module][INFO] - Created surface code dataset: d=7, rounds_max=7, p=2.1, batch_size=416
[2025-08-07 20:20:37,797][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 20:20:40,947][data_module][INFO] - Created surface code dataset: d=7, rounds_max=7, p=2.1, batch_size=400
[2025-08-07 20:20:40,947][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 20:20:44,086][data_module][INFO] - Created surface code dataset: d=7, rounds_max=7, p=2.1, batch_size=392
[2025-08-07 20:20:44,086][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 20:20:48,010][data_module][INFO] - Created surface code dataset: d=7, rounds_max=7, p=2.1, batch_size=388
[2025-08-07 20:20:48,010][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 20:20:51,879][data_module][INFO] - Created surface code dataset: d=7, rounds_max=7, p=2.1, batch_size=386
[2025-08-07 20:20:51,880][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 20:20:55,712][data_module][INFO] - Created surface code dataset: d=7, rounds_max=7, p=2.1, batch_size=385
[2025-08-07 20:20:55,712][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 20:20:59,519][data_module][INFO] - Created surface code dataset: d=7, rounds_max=7, p=2.1, batch_size=384
[2025-08-07 20:20:59,519][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 20:21:00,274][data_module][INFO] - Created surface code dataset: d=7, rounds_max=7, p=2.1, batch_size=384
[2025-08-07 20:21:00,275][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-07 20:21:01,149][__main__][INFO] - Model loaded from checkpoint at global step 0
[2025-08-07 20:21:01,227][__main__][INFO] - Found optimal batch size 384
[2025-08-07 20:21:01,235][__main__][INFO] - Saved batch size 326 to file
[2025-08-07 20:21:01,235][__main__][INFO] - Optimal per-GPU batch size found: 326
[2025-08-07 20:21:01,235][__main__][INFO] - Effective total batch size across 1 device(s): 326
[2025-08-07 20:21:01,240][__main__][INFO] - Saved metadata: {'timestamp': 1754612461.235758, 'slurm_job_id': '29021482', 'batch_size': 326, 'num_devices': 1, 'effective_batch_size': 326}
[2025-08-07 20:21:01,704][__main__][INFO] - === STARTING TRAINING ===
[2025-08-07 20:21:01,709][data_module][INFO] - Set DataModule global_step_offset to 0 (will apply when dataset is created)
[2025-08-07 20:21:01,725][data_module][INFO] - Created surface code dataset: d=7, rounds_max=7, p=2.1, batch_size=326
[2025-08-07 20:21:01,726][data_module][INFO] - Dataset configured for curriculum learning
