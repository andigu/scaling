[2025-08-12 20:48:04,288][__main__][INFO] - === STARTING EXPERIMENT: d19-curriculum2 ===
[2025-08-12 20:48:04,288][__main__][INFO] - PID: 2059493
[2025-08-12 20:48:04,288][__main__][INFO] - SLURM_JOB_ID: 29866114
[2025-08-12 20:48:04,288][__main__][INFO] - NODE_RANK: 0
[2025-08-12 20:48:04,288][__main__][INFO] - WORLD_SIZE: 8
[2025-08-12 20:48:04,288][__main__][INFO] - MASTER_ADDR: holygpu8a10101
[2025-08-12 20:48:04,288][__main__][INFO] - MASTER_PORT: 12355
[2025-08-12 20:48:04,288][__main__][INFO] - SLURM_NODEID: 0
[2025-08-12 20:48:04,288][__main__][INFO] - SLURM_NNODES: 2
[2025-08-12 20:48:04,288][__main__][INFO] - SLURM_NODELIST: holygpu8a[10101,24405]
[2025-08-12 20:48:04,288][__main__][INFO] - Architecture: resnet50
[2025-08-12 20:48:04,288][__main__][INFO] - Embedding Dim: 128
[2025-08-12 20:48:04,288][__main__][INFO] - Learning Rate: 0.0003
[2025-08-12 20:48:04,288][__main__][INFO] - Weight Decay: 0.0
[2025-08-12 20:48:04,288][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-12 20:48:04,288][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-12 20:48:04,288][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-12 20:48:04,289][__main__][INFO] - Channel Multipliers: [2, 2.5, 3, 3.5]
[2025-08-12 20:48:04,289][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-12 20:48:04,289][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-12 20:48:04,289][__main__][INFO] - Use LSTM: False
[2025-08-12 20:48:04,289][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-12 20:48:04,289][__main__][INFO] - Dataset: code_type=surface_code, d=19, rounds_max=19, p=2.1
[2025-08-12 20:48:04,289][__main__][INFO] - === 3-STAGE CURRICULUM LEARNING ENABLED ===
[2025-08-12 20:48:04,289][__main__][INFO] - Stage 1: p=0.75 for 80000 steps
[2025-08-12 20:48:04,289][__main__][INFO] - Stage 2: p=0.75→2.1 over 200000 steps
[2025-08-12 20:48:04,289][__main__][INFO] - Stage 3: p=2.1 for 500000 steps
[2025-08-12 20:48:04,289][__main__][INFO] - Total curriculum steps: 780000
[2025-08-12 20:48:04,289][__main__][INFO] - Accelerator: auto
[2025-08-12 20:48:04,289][__main__][INFO] - Devices per node: 4
[2025-08-12 20:48:04,289][__main__][INFO] - Num Nodes: 2
[2025-08-12 20:48:04,289][__main__][INFO] - Total Devices: 8
[2025-08-12 20:48:04,289][__main__][INFO] - Strategy: ddp
[2025-08-12 20:48:04,289][__main__][INFO] - Sync BatchNorm: True
[2025-08-12 20:48:04,289][__main__][INFO] - MWPM filtering: False
[2025-08-12 20:48:04,289][__main__][INFO] - Batch Size: auto-tuned
[2025-08-12 20:48:04,290][__main__][INFO] - Precision: bf16-mixed
[2025-08-12 20:48:04,290][__main__][INFO] - Max Steps: 780000 (curriculum override)
[2025-08-12 20:48:04,290][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-12 20:48:04,290][__main__][INFO] - Log every 100 steps
[2025-08-12 20:48:04,290][__main__][INFO] - Num Workers: 8
[2025-08-12 20:48:04,290][__main__][INFO] - Prefetch Factor: 4
[2025-08-12 20:48:04,290][__main__][INFO] - Persistent Workers: True
[2025-08-12 20:48:04,290][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d19-curriculum2
[2025-08-12 20:48:04,305][__main__][INFO] - === STARTING EXPERIMENT: d19-curriculum2 ===
[2025-08-12 20:48:04,306][__main__][INFO] - PID: 2059494
[2025-08-12 20:48:04,306][__main__][INFO] - SLURM_JOB_ID: 29866114
[2025-08-12 20:48:04,306][__main__][INFO] - NODE_RANK: 0
[2025-08-12 20:48:04,306][__main__][INFO] - WORLD_SIZE: 8
[2025-08-12 20:48:04,306][__main__][INFO] - MASTER_ADDR: holygpu8a10101
[2025-08-12 20:48:04,306][__main__][INFO] - MASTER_PORT: 12355
[2025-08-12 20:48:04,306][__main__][INFO] - SLURM_NODEID: 0
[2025-08-12 20:48:04,306][__main__][INFO] - SLURM_NNODES: 2
[2025-08-12 20:48:04,306][__main__][INFO] - SLURM_NODELIST: holygpu8a[10101,24405]
[2025-08-12 20:48:04,306][__main__][INFO] - Architecture: resnet50
[2025-08-12 20:48:04,306][__main__][INFO] - Embedding Dim: 128
[2025-08-12 20:48:04,306][__main__][INFO] - Learning Rate: 0.0003
[2025-08-12 20:48:04,306][__main__][INFO] - Weight Decay: 0.0
[2025-08-12 20:48:04,306][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-12 20:48:04,306][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-12 20:48:04,306][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-12 20:48:04,306][__main__][INFO] - Channel Multipliers: [2, 2.5, 3, 3.5]
[2025-08-12 20:48:04,306][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-12 20:48:04,306][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-12 20:48:04,307][__main__][INFO] - Use LSTM: False
[2025-08-12 20:48:04,307][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-12 20:48:04,307][__main__][INFO] - Dataset: code_type=surface_code, d=19, rounds_max=19, p=2.1
[2025-08-12 20:48:04,307][__main__][INFO] - === 3-STAGE CURRICULUM LEARNING ENABLED ===
[2025-08-12 20:48:04,307][__main__][INFO] - Stage 1: p=0.75 for 80000 steps
[2025-08-12 20:48:04,307][__main__][INFO] - Stage 2: p=0.75→2.1 over 200000 steps
[2025-08-12 20:48:04,307][__main__][INFO] - Stage 3: p=2.1 for 500000 steps
[2025-08-12 20:48:04,307][__main__][INFO] - Total curriculum steps: 780000
[2025-08-12 20:48:04,307][__main__][INFO] - Accelerator: auto
[2025-08-12 20:48:04,307][__main__][INFO] - Devices per node: 4
[2025-08-12 20:48:04,307][__main__][INFO] - Num Nodes: 2
[2025-08-12 20:48:04,307][__main__][INFO] - Total Devices: 8
[2025-08-12 20:48:04,307][__main__][INFO] - Strategy: ddp
[2025-08-12 20:48:04,307][__main__][INFO] - Sync BatchNorm: True
[2025-08-12 20:48:04,307][__main__][INFO] - MWPM filtering: False
[2025-08-12 20:48:04,307][__main__][INFO] - Batch Size: auto-tuned
[2025-08-12 20:48:04,307][__main__][INFO] - Precision: bf16-mixed
[2025-08-12 20:48:04,307][__main__][INFO] - Max Steps: 780000 (curriculum override)
[2025-08-12 20:48:04,308][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-12 20:48:04,308][__main__][INFO] - Log every 100 steps
[2025-08-12 20:48:04,308][__main__][INFO] - Num Workers: 8
[2025-08-12 20:48:04,308][__main__][INFO] - Prefetch Factor: 4
[2025-08-12 20:48:04,308][__main__][INFO] - Persistent Workers: True
[2025-08-12 20:48:04,308][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d19-curriculum2
[2025-08-12 20:48:04,308][__main__][INFO] - === STARTING EXPERIMENT: d19-curriculum2 ===
[2025-08-12 20:48:04,308][__main__][INFO] - PID: 2059495
[2025-08-12 20:48:04,308][__main__][INFO] - SLURM_JOB_ID: 29866114
[2025-08-12 20:48:04,308][__main__][INFO] - NODE_RANK: 0
[2025-08-12 20:48:04,308][__main__][INFO] - WORLD_SIZE: 8
[2025-08-12 20:48:04,308][__main__][INFO] - MASTER_ADDR: holygpu8a10101
[2025-08-12 20:48:04,308][__main__][INFO] - MASTER_PORT: 12355
[2025-08-12 20:48:04,308][__main__][INFO] - SLURM_NODEID: 0
[2025-08-12 20:48:04,308][__main__][INFO] - SLURM_NNODES: 2
[2025-08-12 20:48:04,308][__main__][INFO] - SLURM_NODELIST: holygpu8a[10101,24405]
[2025-08-12 20:48:04,309][__main__][INFO] - Architecture: resnet50
[2025-08-12 20:48:04,309][__main__][INFO] - Embedding Dim: 128
[2025-08-12 20:48:04,309][__main__][INFO] - Learning Rate: 0.0003
[2025-08-12 20:48:04,309][__main__][INFO] - Weight Decay: 0.0
[2025-08-12 20:48:04,309][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-12 20:48:04,309][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-12 20:48:04,309][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-12 20:48:04,309][__main__][INFO] - Channel Multipliers: [2, 2.5, 3, 3.5]
[2025-08-12 20:48:04,309][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-12 20:48:04,309][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-12 20:48:04,309][__main__][INFO] - Use LSTM: False
[2025-08-12 20:48:04,309][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-12 20:48:04,309][__main__][INFO] - Dataset: code_type=surface_code, d=19, rounds_max=19, p=2.1
[2025-08-12 20:48:04,309][__main__][INFO] - === 3-STAGE CURRICULUM LEARNING ENABLED ===
[2025-08-12 20:48:04,309][__main__][INFO] - Stage 1: p=0.75 for 80000 steps
[2025-08-12 20:48:04,309][__main__][INFO] - Stage 2: p=0.75→2.1 over 200000 steps
[2025-08-12 20:48:04,309][__main__][INFO] - Stage 3: p=2.1 for 500000 steps
[2025-08-12 20:48:04,309][__main__][INFO] - Found latest checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d19-curriculum2/checkpoints/d19-curriculum2-step=58646.ckpt
[2025-08-12 20:48:04,309][__main__][INFO] - Total curriculum steps: 780000
[2025-08-12 20:48:04,310][__main__][INFO] - Accelerator: auto
[2025-08-12 20:48:04,310][__main__][INFO] - Devices per node: 4
[2025-08-12 20:48:04,310][__main__][INFO] - Num Nodes: 2
[2025-08-12 20:48:04,310][__main__][INFO] - Total Devices: 8
[2025-08-12 20:48:04,310][__main__][INFO] - Strategy: ddp
[2025-08-12 20:48:04,310][__main__][INFO] - Sync BatchNorm: True
[2025-08-12 20:48:04,310][__main__][INFO] - MWPM filtering: False
[2025-08-12 20:48:04,310][__main__][INFO] - Batch Size: auto-tuned
[2025-08-12 20:48:04,310][__main__][INFO] - Precision: bf16-mixed
[2025-08-12 20:48:04,310][__main__][INFO] - Max Steps: 780000 (curriculum override)
[2025-08-12 20:48:04,310][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-12 20:48:04,310][__main__][INFO] - Log every 100 steps
[2025-08-12 20:48:04,310][__main__][INFO] - Num Workers: 8
[2025-08-12 20:48:04,310][__main__][INFO] - Prefetch Factor: 4
[2025-08-12 20:48:04,310][__main__][INFO] - Persistent Workers: True
[2025-08-12 20:48:04,310][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d19-curriculum2
[2025-08-12 20:48:04,311][__main__][INFO] - === STARTING EXPERIMENT: d19-curriculum2 ===
[2025-08-12 20:48:04,311][__main__][INFO] - PID: 2059492
[2025-08-12 20:48:04,311][__main__][INFO] - SLURM_JOB_ID: 29866114
[2025-08-12 20:48:04,311][__main__][INFO] - NODE_RANK: 0
[2025-08-12 20:48:04,311][__main__][INFO] - WORLD_SIZE: 8
[2025-08-12 20:48:04,311][__main__][INFO] - MASTER_ADDR: holygpu8a10101
[2025-08-12 20:48:04,311][__main__][INFO] - MASTER_PORT: 12355
[2025-08-12 20:48:04,311][__main__][INFO] - SLURM_NODEID: 0
[2025-08-12 20:48:04,311][__main__][INFO] - SLURM_NNODES: 2
[2025-08-12 20:48:04,311][__main__][INFO] - SLURM_NODELIST: holygpu8a[10101,24405]
[2025-08-12 20:48:04,311][__main__][INFO] - Architecture: resnet50
[2025-08-12 20:48:04,311][__main__][INFO] - Embedding Dim: 128
[2025-08-12 20:48:04,311][__main__][INFO] - Learning Rate: 0.0003
[2025-08-12 20:48:04,311][__main__][INFO] - Weight Decay: 0.0
[2025-08-12 20:48:04,311][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-12 20:48:04,311][__main__][INFO] - Found latest checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d19-curriculum2/checkpoints/d19-curriculum2-step=58646.ckpt
[2025-08-12 20:48:04,311][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-12 20:48:04,311][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-12 20:48:04,311][__main__][INFO] - Channel Multipliers: [2, 2.5, 3, 3.5]
[2025-08-12 20:48:04,312][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-12 20:48:04,312][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-12 20:48:04,312][__main__][INFO] - Use LSTM: False
[2025-08-12 20:48:04,312][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-12 20:48:04,312][__main__][INFO] - Loaded W&B run ID from file: l36yasyj
[2025-08-12 20:48:04,312][__main__][INFO] - Dataset: code_type=surface_code, d=19, rounds_max=19, p=2.1
[2025-08-12 20:48:04,312][__main__][INFO] - === 3-STAGE CURRICULUM LEARNING ENABLED ===
[2025-08-12 20:48:04,312][__main__][INFO] - Stage 1: p=0.75 for 80000 steps
[2025-08-12 20:48:04,312][__main__][INFO] - Stage 2: p=0.75→2.1 over 200000 steps
[2025-08-12 20:48:04,312][__main__][INFO] - Stage 3: p=2.1 for 500000 steps
[2025-08-12 20:48:04,312][__main__][INFO] - Total curriculum steps: 780000
[2025-08-12 20:48:04,312][__main__][INFO] - Accelerator: auto
[2025-08-12 20:48:04,312][__main__][INFO] - Setting up W&B logger with existing run ID: l36yasyj
[2025-08-12 20:48:04,312][__main__][INFO] - Devices per node: 4
[2025-08-12 20:48:04,312][__main__][INFO] - Num Nodes: 2
[2025-08-12 20:48:04,312][__main__][INFO] - Initializing wandb logger with params
[2025-08-12 20:48:04,312][__main__][INFO] - Total Devices: 8
[2025-08-12 20:48:04,312][__main__][INFO] - Strategy: ddp
[2025-08-12 20:48:04,312][__main__][INFO] - Sync BatchNorm: True
[2025-08-12 20:48:04,312][__main__][INFO] - MWPM filtering: False
[2025-08-12 20:48:04,312][__main__][INFO] - Batch Size: auto-tuned
[2025-08-12 20:48:04,313][__main__][INFO] - Precision: bf16-mixed
[2025-08-12 20:48:04,313][__main__][INFO] - Max Steps: 780000 (curriculum override)
[2025-08-12 20:48:04,313][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-12 20:48:04,313][__main__][INFO] - Log every 100 steps
[2025-08-12 20:48:04,313][__main__][INFO] - Num Workers: 8
[2025-08-12 20:48:04,313][__main__][INFO] - Loaded W&B run ID from file: l36yasyj
[2025-08-12 20:48:04,313][__main__][INFO] - Prefetch Factor: 4
[2025-08-12 20:48:04,313][__main__][INFO] - Persistent Workers: True
[2025-08-12 20:48:04,313][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d19-curriculum2
[2025-08-12 20:48:04,313][__main__][INFO] - Setting up W&B logger with existing run ID: l36yasyj
[2025-08-12 20:48:04,313][__main__][INFO] - Initializing wandb logger with params
[2025-08-12 20:48:04,314][__main__][INFO] - Found latest checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d19-curriculum2/checkpoints/d19-curriculum2-step=58646.ckpt
[2025-08-12 20:48:04,314][__main__][INFO] - Loaded W&B run ID from file: l36yasyj
[2025-08-12 20:48:04,315][__main__][INFO] - Setting up W&B logger with existing run ID: l36yasyj
[2025-08-12 20:48:04,315][__main__][INFO] - Initializing wandb logger with params
[2025-08-12 20:48:04,315][__main__][INFO] - Found latest checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d19-curriculum2/checkpoints/d19-curriculum2-step=58646.ckpt
[2025-08-12 20:48:04,315][__main__][INFO] - Loaded W&B run ID from file: l36yasyj
[2025-08-12 20:48:04,316][__main__][INFO] - Setting up W&B logger with existing run ID: l36yasyj
[2025-08-12 20:48:04,316][__main__][INFO] - Initializing wandb logger with params
[2025-08-12 20:48:04,323][stage_manager][INFO] - Initialized 3-stage curriculum learning:
[2025-08-12 20:48:04,323][stage_manager][INFO] -   Stage 1: p=0.8 for 80000 steps
[2025-08-12 20:48:04,323][stage_manager][INFO] - Initialized 3-stage curriculum learning:
[2025-08-12 20:48:04,323][stage_manager][INFO] -   Stage 2: p=0.8→2.1 over 200000 steps
[2025-08-12 20:48:04,323][stage_manager][INFO] -   Stage 1: p=0.8 for 80000 steps
[2025-08-12 20:48:04,323][stage_manager][INFO] -   Stage 3: p=2.1 for 500000 steps
[2025-08-12 20:48:04,323][stage_manager][INFO] -   Stage 2: p=0.8→2.1 over 200000 steps
[2025-08-12 20:48:04,323][stage_manager][INFO] -   Total steps: 780000
[2025-08-12 20:48:04,323][stage_manager][INFO] - Initialized 3-stage curriculum learning:
[2025-08-12 20:48:04,323][stage_manager][INFO] -   Stage 3: p=2.1 for 500000 steps
[2025-08-12 20:48:04,323][stage_manager][INFO] -   Stage 1: p=0.8 for 80000 steps
[2025-08-12 20:48:04,323][stage_manager][INFO] -   Total steps: 780000
[2025-08-12 20:48:04,324][stage_manager][INFO] -   Stage 2: p=0.8→2.1 over 200000 steps
[2025-08-12 20:48:04,324][stage_manager][INFO] -   Stage 3: p=2.1 for 500000 steps
[2025-08-12 20:48:04,324][stage_manager][INFO] -   Total steps: 780000
[2025-08-12 20:48:04,324][stage_manager][INFO] - Initialized 3-stage curriculum learning:
[2025-08-12 20:48:04,324][stage_manager][INFO] -   Stage 1: p=0.8 for 80000 steps
[2025-08-12 20:48:04,324][stage_manager][INFO] -   Stage 2: p=0.8→2.1 over 200000 steps
[2025-08-12 20:48:04,324][stage_manager][INFO] -   Stage 3: p=2.1 for 500000 steps
[2025-08-12 20:48:04,324][stage_manager][INFO] -   Total steps: 780000
[2025-08-12 20:48:04,415][__main__][INFO] - Loaded batch size 80 from file
[2025-08-12 20:48:04,415][__main__][INFO] - Loaded batch size 80 from file
[2025-08-12 20:48:04,415][__main__][INFO] - Loaded batch size 80 from file
[2025-08-12 20:48:04,415][__main__][INFO] - Loaded batch size 80 from file
[2025-08-12 20:48:04,416][__main__][INFO] - Effective total batch size across 4 device(s) on 2 node(s) with 1 accumulation steps: 640
[2025-08-12 20:48:04,416][__main__][INFO] - Effective total batch size across 4 device(s) on 2 node(s) with 1 accumulation steps: 640
[2025-08-12 20:48:04,416][__main__][INFO] - Effective total batch size across 4 device(s) on 2 node(s) with 1 accumulation steps: 640
[2025-08-12 20:48:04,416][__main__][INFO] - Effective total batch size across 4 device(s) on 2 node(s) with 1 accumulation steps: 640
[2025-08-12 20:48:04,422][__main__][INFO] - Saved metadata: {'timestamp': 1755046084.4161084, 'slurm_job_id': '29866114', 'batch_size': 80, 'num_devices': 4, 'effective_batch_size': 640}
[2025-08-12 20:48:04,422][__main__][INFO] - Saved metadata: {'timestamp': 1755046084.4161203, 'slurm_job_id': '29866114', 'batch_size': 80, 'num_devices': 4, 'effective_batch_size': 640}
[2025-08-12 20:48:04,423][__main__][INFO] - Saved metadata: {'timestamp': 1755046084.4161367, 'slurm_job_id': '29866114', 'batch_size': 80, 'num_devices': 4, 'effective_batch_size': 640}
[2025-08-12 20:48:04,424][__main__][INFO] - Saved metadata: {'timestamp': 1755046084.4161434, 'slurm_job_id': '29866114', 'batch_size': 80, 'num_devices': 4, 'effective_batch_size': 640}
[2025-08-12 20:48:04,585][data_module][INFO] - Set DataModule global_step_offset to 58646 (will apply when dataset is created)
[2025-08-12 20:48:04,585][data_module][INFO] - Set DataModule global_step_offset to 58646 (will apply when dataset is created)
[2025-08-12 20:48:04,585][data_module][INFO] - Set DataModule global_step_offset to 58646 (will apply when dataset is created)
[2025-08-12 20:48:04,585][__main__][INFO] - Updated DataModule global_step_offset to 58646 for resume
[2025-08-12 20:48:04,585][__main__][INFO] - Updated DataModule global_step_offset to 58646 for resume
[2025-08-12 20:48:04,585][__main__][INFO] - Updated DataModule global_step_offset to 58646 for resume
[2025-08-12 20:48:05,218][__main__][INFO] - === STARTING TRAINING ===
[2025-08-12 20:48:05,218][__main__][INFO] - === STARTING TRAINING ===
[2025-08-12 20:48:05,218][__main__][INFO] - Resuming from checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d19-curriculum2/checkpoints/d19-curriculum2-step=58646.ckpt
[2025-08-12 20:48:05,218][__main__][INFO] - Resuming from checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d19-curriculum2/checkpoints/d19-curriculum2-step=58646.ckpt
[2025-08-12 20:48:05,220][__main__][INFO] - === STARTING TRAINING ===
[2025-08-12 20:48:05,220][__main__][INFO] - Resuming from checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d19-curriculum2/checkpoints/d19-curriculum2-step=58646.ckpt
[2025-08-12 20:48:06,833][__main__][INFO] - === STARTING EXPERIMENT: d19-curriculum2 ===
[2025-08-12 20:48:06,833][__main__][INFO] - PID: 2248485
[2025-08-12 20:48:06,833][__main__][INFO] - SLURM_JOB_ID: 29866114
[2025-08-12 20:48:06,833][__main__][INFO] - NODE_RANK: 0
[2025-08-12 20:48:06,833][__main__][INFO] - WORLD_SIZE: 8
[2025-08-12 20:48:06,833][__main__][INFO] - MASTER_ADDR: holygpu8a10101
[2025-08-12 20:48:06,833][__main__][INFO] - MASTER_PORT: 12355
[2025-08-12 20:48:06,833][__main__][INFO] - SLURM_NODEID: 1
[2025-08-12 20:48:06,833][__main__][INFO] - SLURM_NNODES: 2
[2025-08-12 20:48:06,833][__main__][INFO] - SLURM_NODELIST: holygpu8a[10101,24405]
[2025-08-12 20:48:06,833][__main__][INFO] - Architecture: resnet50
[2025-08-12 20:48:06,834][__main__][INFO] - Embedding Dim: 128
[2025-08-12 20:48:06,834][__main__][INFO] - Learning Rate: 0.0003
[2025-08-12 20:48:06,834][__main__][INFO] - Weight Decay: 0.0
[2025-08-12 20:48:06,834][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-12 20:48:06,834][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-12 20:48:06,834][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-12 20:48:06,834][__main__][INFO] - Channel Multipliers: [2, 2.5, 3, 3.5]
[2025-08-12 20:48:06,834][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-12 20:48:06,834][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-12 20:48:06,834][__main__][INFO] - Use LSTM: False
[2025-08-12 20:48:06,834][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-12 20:48:06,835][__main__][INFO] - Dataset: code_type=surface_code, d=19, rounds_max=19, p=2.1
[2025-08-12 20:48:06,835][__main__][INFO] - === 3-STAGE CURRICULUM LEARNING ENABLED ===
[2025-08-12 20:48:06,835][__main__][INFO] - Stage 1: p=0.75 for 80000 steps
[2025-08-12 20:48:06,835][__main__][INFO] - Stage 2: p=0.75→2.1 over 200000 steps
[2025-08-12 20:48:06,835][__main__][INFO] - Stage 3: p=2.1 for 500000 steps
[2025-08-12 20:48:06,835][__main__][INFO] - Total curriculum steps: 780000
[2025-08-12 20:48:06,835][__main__][INFO] - Accelerator: auto
[2025-08-12 20:48:06,835][__main__][INFO] - Devices per node: 4
[2025-08-12 20:48:06,835][__main__][INFO] - Num Nodes: 2
[2025-08-12 20:48:06,835][__main__][INFO] - Total Devices: 8
[2025-08-12 20:48:06,835][__main__][INFO] - Strategy: ddp
[2025-08-12 20:48:06,836][__main__][INFO] - Sync BatchNorm: True
[2025-08-12 20:48:06,836][__main__][INFO] - MWPM filtering: False
[2025-08-12 20:48:06,836][__main__][INFO] - Batch Size: auto-tuned
[2025-08-12 20:48:06,836][__main__][INFO] - Precision: bf16-mixed
[2025-08-12 20:48:06,836][__main__][INFO] - Max Steps: 780000 (curriculum override)
[2025-08-12 20:48:06,836][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-12 20:48:06,836][__main__][INFO] - Log every 100 steps
[2025-08-12 20:48:06,836][__main__][INFO] - Num Workers: 8
[2025-08-12 20:48:06,836][__main__][INFO] - Prefetch Factor: 4
[2025-08-12 20:48:06,836][__main__][INFO] - Persistent Workers: True
[2025-08-12 20:48:06,836][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d19-curriculum2
[2025-08-12 20:48:06,853][__main__][INFO] - === STARTING EXPERIMENT: d19-curriculum2 ===
[2025-08-12 20:48:06,853][__main__][INFO] - PID: 2248486
[2025-08-12 20:48:06,853][__main__][INFO] - SLURM_JOB_ID: 29866114
[2025-08-12 20:48:06,853][__main__][INFO] - NODE_RANK: 0
[2025-08-12 20:48:06,854][__main__][INFO] - WORLD_SIZE: 8
[2025-08-12 20:48:06,854][__main__][INFO] - MASTER_ADDR: holygpu8a10101
[2025-08-12 20:48:06,854][__main__][INFO] - MASTER_PORT: 12355
[2025-08-12 20:48:06,854][__main__][INFO] - SLURM_NODEID: 1
[2025-08-12 20:48:06,854][__main__][INFO] - SLURM_NNODES: 2
[2025-08-12 20:48:06,854][__main__][INFO] - SLURM_NODELIST: holygpu8a[10101,24405]
[2025-08-12 20:48:06,854][__main__][INFO] - Architecture: resnet50
[2025-08-12 20:48:06,854][__main__][INFO] - Embedding Dim: 128
[2025-08-12 20:48:06,854][__main__][INFO] - Learning Rate: 0.0003
[2025-08-12 20:48:06,854][__main__][INFO] - Weight Decay: 0.0
[2025-08-12 20:48:06,854][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-12 20:48:06,854][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-12 20:48:06,854][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-12 20:48:06,854][__main__][INFO] - Channel Multipliers: [2, 2.5, 3, 3.5]
[2025-08-12 20:48:06,855][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-12 20:48:06,855][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-12 20:48:06,855][__main__][INFO] - Use LSTM: False
[2025-08-12 20:48:06,855][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-12 20:48:06,855][__main__][INFO] - Dataset: code_type=surface_code, d=19, rounds_max=19, p=2.1
[2025-08-12 20:48:06,855][__main__][INFO] - === 3-STAGE CURRICULUM LEARNING ENABLED ===
[2025-08-12 20:48:06,855][__main__][INFO] - Stage 1: p=0.75 for 80000 steps
[2025-08-12 20:48:06,855][__main__][INFO] - Stage 2: p=0.75→2.1 over 200000 steps
[2025-08-12 20:48:06,855][__main__][INFO] - Stage 3: p=2.1 for 500000 steps
[2025-08-12 20:48:06,855][__main__][INFO] - Total curriculum steps: 780000
[2025-08-12 20:48:06,856][__main__][INFO] - Accelerator: auto
[2025-08-12 20:48:06,856][__main__][INFO] - Devices per node: 4
[2025-08-12 20:48:06,856][__main__][INFO] - Num Nodes: 2
[2025-08-12 20:48:06,856][__main__][INFO] - Total Devices: 8
[2025-08-12 20:48:06,856][__main__][INFO] - Strategy: ddp
[2025-08-12 20:48:06,856][__main__][INFO] - Sync BatchNorm: True
[2025-08-12 20:48:06,856][__main__][INFO] - === STARTING EXPERIMENT: d19-curriculum2 ===
[2025-08-12 20:48:06,856][__main__][INFO] - MWPM filtering: False
[2025-08-12 20:48:06,856][__main__][INFO] - PID: 2248488
[2025-08-12 20:48:06,856][__main__][INFO] - Batch Size: auto-tuned
[2025-08-12 20:48:06,856][__main__][INFO] - SLURM_JOB_ID: 29866114
[2025-08-12 20:48:06,856][__main__][INFO] - Precision: bf16-mixed
[2025-08-12 20:48:06,856][__main__][INFO] - NODE_RANK: 0
[2025-08-12 20:48:06,856][__main__][INFO] - WORLD_SIZE: 8
[2025-08-12 20:48:06,856][__main__][INFO] - Max Steps: 780000 (curriculum override)
[2025-08-12 20:48:06,856][__main__][INFO] - MASTER_ADDR: holygpu8a10101
[2025-08-12 20:48:06,856][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-12 20:48:06,856][__main__][INFO] - MASTER_PORT: 12355
[2025-08-12 20:48:06,856][__main__][INFO] - Log every 100 steps
[2025-08-12 20:48:06,856][__main__][INFO] - SLURM_NODEID: 1
[2025-08-12 20:48:06,857][__main__][INFO] - SLURM_NNODES: 2
[2025-08-12 20:48:06,857][__main__][INFO] - Num Workers: 8
[2025-08-12 20:48:06,857][__main__][INFO] - SLURM_NODELIST: holygpu8a[10101,24405]
[2025-08-12 20:48:06,857][__main__][INFO] - Prefetch Factor: 4
[2025-08-12 20:48:06,857][__main__][INFO] - Persistent Workers: True
[2025-08-12 20:48:06,857][__main__][INFO] - Architecture: resnet50
[2025-08-12 20:48:06,857][__main__][INFO] - Embedding Dim: 128
[2025-08-12 20:48:06,857][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d19-curriculum2
[2025-08-12 20:48:06,857][__main__][INFO] - Learning Rate: 0.0003
[2025-08-12 20:48:06,857][__main__][INFO] - Weight Decay: 0.0
[2025-08-12 20:48:06,857][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-12 20:48:06,857][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-12 20:48:06,857][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-12 20:48:06,857][__main__][INFO] - Channel Multipliers: [2, 2.5, 3, 3.5]
[2025-08-12 20:48:06,857][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-12 20:48:06,857][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-12 20:48:06,858][__main__][INFO] - Use LSTM: False
[2025-08-12 20:48:06,858][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-12 20:48:06,858][__main__][INFO] - Dataset: code_type=surface_code, d=19, rounds_max=19, p=2.1
[2025-08-12 20:48:06,858][__main__][INFO] - === 3-STAGE CURRICULUM LEARNING ENABLED ===
[2025-08-12 20:48:06,858][__main__][INFO] - Stage 1: p=0.75 for 80000 steps
[2025-08-12 20:48:06,858][__main__][INFO] - Stage 2: p=0.75→2.1 over 200000 steps
[2025-08-12 20:48:06,858][__main__][INFO] - Stage 3: p=2.1 for 500000 steps
[2025-08-12 20:48:06,858][__main__][INFO] - Total curriculum steps: 780000
[2025-08-12 20:48:06,858][__main__][INFO] - Accelerator: auto
[2025-08-12 20:48:06,858][__main__][INFO] - Devices per node: 4
[2025-08-12 20:48:06,859][__main__][INFO] - Num Nodes: 2
[2025-08-12 20:48:06,859][__main__][INFO] - Total Devices: 8
[2025-08-12 20:48:06,858][__main__][INFO] - === STARTING EXPERIMENT: d19-curriculum2 ===
[2025-08-12 20:48:06,859][__main__][INFO] - Strategy: ddp
[2025-08-12 20:48:06,859][__main__][INFO] - PID: 2248487
[2025-08-12 20:48:06,859][__main__][INFO] - Sync BatchNorm: True
[2025-08-12 20:48:06,859][__main__][INFO] - MWPM filtering: False
[2025-08-12 20:48:06,859][__main__][INFO] - SLURM_JOB_ID: 29866114
[2025-08-12 20:48:06,859][__main__][INFO] - NODE_RANK: 0
[2025-08-12 20:48:06,859][__main__][INFO] - Batch Size: auto-tuned
[2025-08-12 20:48:06,859][__main__][INFO] - WORLD_SIZE: 8
[2025-08-12 20:48:06,859][__main__][INFO] - Precision: bf16-mixed
[2025-08-12 20:48:06,859][__main__][INFO] - MASTER_ADDR: holygpu8a10101
[2025-08-12 20:48:06,859][__main__][INFO] - MASTER_PORT: 12355
[2025-08-12 20:48:06,859][__main__][INFO] - Max Steps: 780000 (curriculum override)
[2025-08-12 20:48:06,859][__main__][INFO] - SLURM_NODEID: 1
[2025-08-12 20:48:06,859][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-12 20:48:06,859][__main__][INFO] - SLURM_NNODES: 2
[2025-08-12 20:48:06,859][__main__][INFO] - SLURM_NODELIST: holygpu8a[10101,24405]
[2025-08-12 20:48:06,859][__main__][INFO] - Log every 100 steps
[2025-08-12 20:48:06,859][__main__][INFO] - Num Workers: 8
[2025-08-12 20:48:06,859][__main__][INFO] - Architecture: resnet50
[2025-08-12 20:48:06,859][__main__][INFO] - Prefetch Factor: 4
[2025-08-12 20:48:06,859][__main__][INFO] - Embedding Dim: 128
[2025-08-12 20:48:06,859][__main__][INFO] - Persistent Workers: True
[2025-08-12 20:48:06,860][__main__][INFO] - Learning Rate: 0.0003
[2025-08-12 20:48:06,860][__main__][INFO] - Weight Decay: 0.0
[2025-08-12 20:48:06,860][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d19-curriculum2
[2025-08-12 20:48:06,860][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-12 20:48:06,860][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-12 20:48:06,860][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-12 20:48:06,860][__main__][INFO] - Channel Multipliers: [2, 2.5, 3, 3.5]
[2025-08-12 20:48:06,860][__main__][INFO] - Found latest checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d19-curriculum2/checkpoints/d19-curriculum2-step=58646.ckpt
[2025-08-12 20:48:06,860][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-12 20:48:06,860][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-12 20:48:06,860][__main__][INFO] - Use LSTM: False
[2025-08-12 20:48:06,860][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-12 20:48:06,860][__main__][INFO] - Dataset: code_type=surface_code, d=19, rounds_max=19, p=2.1
[2025-08-12 20:48:06,860][__main__][INFO] - === 3-STAGE CURRICULUM LEARNING ENABLED ===
[2025-08-12 20:48:06,861][__main__][INFO] - Stage 1: p=0.75 for 80000 steps
[2025-08-12 20:48:06,861][__main__][INFO] - Stage 2: p=0.75→2.1 over 200000 steps
[2025-08-12 20:48:06,861][__main__][INFO] - Found latest checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d19-curriculum2/checkpoints/d19-curriculum2-step=58646.ckpt
[2025-08-12 20:48:06,861][__main__][INFO] - Stage 3: p=2.1 for 500000 steps
[2025-08-12 20:48:06,861][__main__][INFO] - Total curriculum steps: 780000
[2025-08-12 20:48:06,861][__main__][INFO] - Accelerator: auto
[2025-08-12 20:48:06,861][__main__][INFO] - Devices per node: 4
[2025-08-12 20:48:06,861][__main__][INFO] - Num Nodes: 2
[2025-08-12 20:48:06,861][__main__][INFO] - Total Devices: 8
[2025-08-12 20:48:06,861][__main__][INFO] - Strategy: ddp
[2025-08-12 20:48:06,861][__main__][INFO] - Sync BatchNorm: True
[2025-08-12 20:48:06,861][__main__][INFO] - MWPM filtering: False
[2025-08-12 20:48:06,862][__main__][INFO] - Batch Size: auto-tuned
[2025-08-12 20:48:06,862][__main__][INFO] - Precision: bf16-mixed
[2025-08-12 20:48:06,862][__main__][INFO] - Max Steps: 780000 (curriculum override)
[2025-08-12 20:48:06,862][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-12 20:48:06,862][__main__][INFO] - Log every 100 steps
[2025-08-12 20:48:06,862][__main__][INFO] - Num Workers: 8
[2025-08-12 20:48:06,862][__main__][INFO] - Prefetch Factor: 4
[2025-08-12 20:48:06,862][__main__][INFO] - Persistent Workers: True
[2025-08-12 20:48:06,862][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d19-curriculum2
[2025-08-12 20:48:06,863][__main__][INFO] - Found latest checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d19-curriculum2/checkpoints/d19-curriculum2-step=58646.ckpt
[2025-08-12 20:48:06,863][__main__][INFO] - Loaded W&B run ID from file: l36yasyj
[2025-08-12 20:48:06,863][__main__][INFO] - Loaded W&B run ID from file: l36yasyj
[2025-08-12 20:48:06,863][__main__][INFO] - Loaded W&B run ID from file: l36yasyj
[2025-08-12 20:48:06,863][__main__][INFO] - Setting up W&B logger with existing run ID: l36yasyj
[2025-08-12 20:48:06,863][__main__][INFO] - Setting up W&B logger with existing run ID: l36yasyj
[2025-08-12 20:48:06,864][__main__][INFO] - Initializing wandb logger with params
[2025-08-12 20:48:06,864][__main__][INFO] - Initializing wandb logger with params
[2025-08-12 20:48:06,864][__main__][INFO] - Setting up W&B logger with existing run ID: l36yasyj
[2025-08-12 20:48:06,864][__main__][INFO] - Initializing wandb logger with params
[2025-08-12 20:48:06,864][__main__][INFO] - Found latest checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d19-curriculum2/checkpoints/d19-curriculum2-step=58646.ckpt
[2025-08-12 20:48:06,865][__main__][INFO] - Loaded W&B run ID from file: l36yasyj
[2025-08-12 20:48:06,866][__main__][INFO] - Setting up W&B logger with existing run ID: l36yasyj
[2025-08-12 20:48:06,866][__main__][INFO] - Initializing wandb logger with params
[2025-08-12 20:48:06,886][stage_manager][INFO] - Initialized 3-stage curriculum learning:
[2025-08-12 20:48:06,886][stage_manager][INFO] -   Stage 1: p=0.8 for 80000 steps
[2025-08-12 20:48:06,886][stage_manager][INFO] - Initialized 3-stage curriculum learning:
[2025-08-12 20:48:06,886][stage_manager][INFO] - Initialized 3-stage curriculum learning:
[2025-08-12 20:48:06,886][stage_manager][INFO] -   Stage 2: p=0.8→2.1 over 200000 steps
[2025-08-12 20:48:06,886][stage_manager][INFO] - Initialized 3-stage curriculum learning:
[2025-08-12 20:48:06,886][stage_manager][INFO] -   Stage 1: p=0.8 for 80000 steps
[2025-08-12 20:48:06,886][stage_manager][INFO] -   Stage 3: p=2.1 for 500000 steps
[2025-08-12 20:48:06,886][stage_manager][INFO] -   Stage 1: p=0.8 for 80000 steps
[2025-08-12 20:48:06,887][stage_manager][INFO] -   Stage 1: p=0.8 for 80000 steps
[2025-08-12 20:48:06,887][stage_manager][INFO] -   Stage 2: p=0.8→2.1 over 200000 steps
[2025-08-12 20:48:06,887][stage_manager][INFO] -   Total steps: 780000
[2025-08-12 20:48:06,887][stage_manager][INFO] -   Stage 2: p=0.8→2.1 over 200000 steps
[2025-08-12 20:48:06,887][stage_manager][INFO] -   Stage 3: p=2.1 for 500000 steps
[2025-08-12 20:48:06,887][stage_manager][INFO] -   Stage 2: p=0.8→2.1 over 200000 steps
[2025-08-12 20:48:06,887][stage_manager][INFO] -   Stage 3: p=2.1 for 500000 steps
[2025-08-12 20:48:06,887][stage_manager][INFO] -   Total steps: 780000
[2025-08-12 20:48:06,887][stage_manager][INFO] -   Stage 3: p=2.1 for 500000 steps
[2025-08-12 20:48:06,887][stage_manager][INFO] -   Total steps: 780000
[2025-08-12 20:48:06,887][stage_manager][INFO] -   Total steps: 780000
[2025-08-12 20:48:06,971][__main__][INFO] - Loaded batch size 80 from file
[2025-08-12 20:48:06,971][__main__][INFO] - Loaded batch size 80 from file
[2025-08-12 20:48:06,971][__main__][INFO] - Loaded batch size 80 from file
[2025-08-12 20:48:06,971][__main__][INFO] - Loaded batch size 80 from file
[2025-08-12 20:48:06,972][__main__][INFO] - Effective total batch size across 4 device(s) on 2 node(s) with 1 accumulation steps: 640
[2025-08-12 20:48:06,972][__main__][INFO] - Effective total batch size across 4 device(s) on 2 node(s) with 1 accumulation steps: 640
[2025-08-12 20:48:06,972][__main__][INFO] - Effective total batch size across 4 device(s) on 2 node(s) with 1 accumulation steps: 640
[2025-08-12 20:48:06,972][__main__][INFO] - Effective total batch size across 4 device(s) on 2 node(s) with 1 accumulation steps: 640
[2025-08-12 20:48:06,977][__main__][INFO] - Saved metadata: {'timestamp': 1755046086.9721954, 'slurm_job_id': '29866114', 'batch_size': 80, 'num_devices': 4, 'effective_batch_size': 640}
[2025-08-12 20:48:06,979][__main__][INFO] - Saved metadata: {'timestamp': 1755046086.9722295, 'slurm_job_id': '29866114', 'batch_size': 80, 'num_devices': 4, 'effective_batch_size': 640}
[2025-08-12 20:48:06,979][__main__][INFO] - Saved metadata: {'timestamp': 1755046086.9722116, 'slurm_job_id': '29866114', 'batch_size': 80, 'num_devices': 4, 'effective_batch_size': 640}
[2025-08-12 20:48:06,979][__main__][INFO] - Saved metadata: {'timestamp': 1755046086.9722228, 'slurm_job_id': '29866114', 'batch_size': 80, 'num_devices': 4, 'effective_batch_size': 640}
[2025-08-12 20:48:07,196][data_module][INFO] - Set DataModule global_step_offset to 58646 (will apply when dataset is created)
[2025-08-12 20:48:07,196][__main__][INFO] - Updated DataModule global_step_offset to 58646 for resume
[2025-08-12 20:48:07,197][data_module][INFO] - Set DataModule global_step_offset to 58646 (will apply when dataset is created)
[2025-08-12 20:48:07,197][data_module][INFO] - Set DataModule global_step_offset to 58646 (will apply when dataset is created)
[2025-08-12 20:48:07,197][__main__][INFO] - Updated DataModule global_step_offset to 58646 for resume
[2025-08-12 20:48:07,197][__main__][INFO] - Updated DataModule global_step_offset to 58646 for resume
[2025-08-12 20:48:07,197][data_module][INFO] - Set DataModule global_step_offset to 58646 (will apply when dataset is created)
[2025-08-12 20:48:07,198][__main__][INFO] - Updated DataModule global_step_offset to 58646 for resume
[2025-08-12 20:48:08,032][__main__][INFO] - === STARTING TRAINING ===
[2025-08-12 20:48:08,033][__main__][INFO] - Resuming from checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d19-curriculum2/checkpoints/d19-curriculum2-step=58646.ckpt
[2025-08-12 20:48:08,033][__main__][INFO] - === STARTING TRAINING ===
[2025-08-12 20:48:08,033][__main__][INFO] - Resuming from checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d19-curriculum2/checkpoints/d19-curriculum2-step=58646.ckpt
[2025-08-12 20:48:08,033][__main__][INFO] - === STARTING TRAINING ===
[2025-08-12 20:48:08,033][__main__][INFO] - Resuming from checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d19-curriculum2/checkpoints/d19-curriculum2-step=58646.ckpt
[2025-08-12 20:48:08,033][__main__][INFO] - === STARTING TRAINING ===
[2025-08-12 20:48:08,034][__main__][INFO] - Resuming from checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d19-curriculum2/checkpoints/d19-curriculum2-step=58646.ckpt
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             [2025-08-12 20:48:25,786][__main__][INFO] - Model loaded from checkpoint at global step 58646
[2025-08-12 20:48:25,809][__main__][INFO] - Model loaded from checkpoint at global step 58646
[2025-08-12 20:48:25,810][__main__][INFO] - Model loaded from checkpoint at global step 58646
[2025-08-12 20:48:25,810][__main__][INFO] - Model loaded from checkpoint at global step 58646
[2025-08-12 20:48:26,031][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=19, rounds_max=19, p=2.1, batch_size=80
[2025-08-12 20:48:26,031][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=19, rounds_max=19, p=2.1, batch_size=80
[2025-08-12 20:48:26,031][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-12 20:48:26,031][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-12 20:48:26,031][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=19, rounds_max=19, p=2.1, batch_size=80
[2025-08-12 20:48:26,031][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-12 20:48:26,031][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=19, rounds_max=19, p=2.1, batch_size=80
[2025-08-12 20:48:26,031][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-12 23:40:54,235][__main__][INFO] - === STARTING EXPERIMENT: d13-schedulefree ===
[2025-08-12 23:40:54,235][__main__][INFO] - PID: 2526312
[2025-08-12 23:40:54,236][__main__][INFO] - SLURM_JOB_ID: 29925212
[2025-08-12 23:40:54,236][__main__][INFO] - NODE_RANK: unknown
[2025-08-12 23:40:54,236][__main__][INFO] - WORLD_SIZE: unknown
[2025-08-12 23:40:54,236][__main__][INFO] - MASTER_ADDR: unknown
[2025-08-12 23:40:54,236][__main__][INFO] - MASTER_PORT: unknown
[2025-08-12 23:40:54,236][__main__][INFO] - SLURM_NODEID: 0
[2025-08-12 23:40:54,236][__main__][INFO] - SLURM_NNODES: 1
[2025-08-12 23:40:54,236][__main__][INFO] - SLURM_NODELIST: holygpu8a17602
[2025-08-12 23:40:54,236][__main__][INFO] - Architecture: resnet50
[2025-08-12 23:40:54,236][__main__][INFO] - Embedding Dim: 64
[2025-08-12 23:40:54,236][__main__][INFO] - Learning Rate: 0.0003
[2025-08-12 23:40:54,236][__main__][INFO] - Weight Decay: 0.0
[2025-08-12 23:40:54,236][__main__][INFO] - Optimizer: schedulefree
[2025-08-12 23:40:54,236][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-12 23:40:54,236][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-12 23:40:54,236][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-12 23:40:54,236][__main__][INFO] - Channel Multipliers: [2, 4, 8, 16]
[2025-08-12 23:40:54,236][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-12 23:40:54,236][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-12 23:40:54,236][__main__][INFO] - Use LSTM: False
[2025-08-12 23:40:54,236][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-12 23:40:54,237][__main__][INFO] - Dataset: code_type=surface_code, d=13, rounds_max=13, p=2.1
[2025-08-12 23:40:54,237][__main__][INFO] - Standard training (no curriculum)
[2025-08-12 23:40:54,237][__main__][INFO] - Accelerator: auto
[2025-08-12 23:40:54,237][__main__][INFO] - Devices per node: 1
[2025-08-12 23:40:54,237][__main__][INFO] - Num Nodes: 1
[2025-08-12 23:40:54,237][__main__][INFO] - Total Devices: 1
[2025-08-12 23:40:54,237][__main__][INFO] - Strategy: auto
[2025-08-12 23:40:54,237][__main__][INFO] - Sync BatchNorm: True
[2025-08-12 23:40:54,237][__main__][INFO] - MWPM filtering: False
[2025-08-12 23:40:54,237][__main__][INFO] - Batch Size: auto-tuned
[2025-08-12 23:40:54,237][__main__][INFO] - Precision: bf16-mixed
[2025-08-12 23:40:54,237][__main__][INFO] - Max Steps: 50000
[2025-08-12 23:40:54,237][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-12 23:40:54,237][__main__][INFO] - Log every 100 steps
[2025-08-12 23:40:54,237][__main__][INFO] - Num Workers: 8
[2025-08-12 23:40:54,237][__main__][INFO] - Prefetch Factor: 4
[2025-08-12 23:40:54,237][__main__][INFO] - Persistent Workers: True
[2025-08-12 23:40:54,237][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d13-schedulefree
[2025-08-12 23:40:54,246][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-12 23:40:54,246][__main__][INFO] - Initializing wandb logger with params
[2025-08-12 23:40:57,012][__main__][INFO] - Saved new W&B run ID to file: j326hyiv
[2025-08-12 23:40:57,108][__main__][INFO] - === AUTO-TUNING BATCH SIZE (RANK 0) ===
[2025-08-12 23:40:58,046][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=13, rounds_max=13, p=2.1, batch_size=2
[2025-08-12 23:41:00,598][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=13, rounds_max=13, p=2.1, batch_size=4
[2025-08-12 23:41:02,339][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=13, rounds_max=13, p=2.1, batch_size=8
[2025-08-12 23:41:04,161][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=13, rounds_max=13, p=2.1, batch_size=16
[2025-08-12 23:41:06,173][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=13, rounds_max=13, p=2.1, batch_size=32
[2025-08-12 23:41:08,372][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=13, rounds_max=13, p=2.1, batch_size=64
[2025-08-12 23:41:10,884][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=13, rounds_max=13, p=2.1, batch_size=128
[2025-08-12 23:41:13,858][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=13, rounds_max=13, p=2.1, batch_size=256
[2025-08-12 23:41:17,246][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=13, rounds_max=13, p=2.1, batch_size=192
[2025-08-12 23:41:20,915][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=13, rounds_max=13, p=2.1, batch_size=224
[2025-08-12 23:41:23,970][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=13, rounds_max=13, p=2.1, batch_size=208
[2025-08-12 23:41:27,863][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=13, rounds_max=13, p=2.1, batch_size=216
[2025-08-12 23:41:31,750][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=13, rounds_max=13, p=2.1, batch_size=220
[2025-08-12 23:41:35,735][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=13, rounds_max=13, p=2.1, batch_size=222
[2025-08-12 23:41:38,742][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=13, rounds_max=13, p=2.1, batch_size=221
[2025-08-12 23:41:43,068][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=13, rounds_max=13, p=2.1, batch_size=221
[2025-08-12 23:41:44,372][__main__][INFO] - Model loaded from checkpoint at global step 0
[2025-08-12 23:41:44,504][__main__][INFO] - Found optimal batch size 221
[2025-08-12 23:41:44,507][__main__][INFO] - Saved batch size 187 to file
[2025-08-12 23:41:44,507][__main__][INFO] - Optimal per-GPU batch size found: 187
[2025-08-12 23:41:44,507][__main__][INFO] - Effective total batch size across 1 device(s) on 1 node(s) with 1 accumulation steps: 187
[2025-08-12 23:41:44,510][__main__][INFO] - Saved metadata: {'timestamp': 1755056504.5074503, 'slurm_job_id': '29925212', 'batch_size': 187, 'num_devices': 1, 'effective_batch_size': 187}
[2025-08-12 23:41:44,918][__main__][INFO] - === STARTING TRAINING ===
[2025-08-12 23:41:44,941][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=13, rounds_max=13, p=2.1, batch_size=187
[2025-08-12 23:42:22,130][__main__][INFO] - === STARTING EXPERIMENT: d13-adamw ===
[2025-08-12 23:42:22,130][__main__][INFO] - PID: 787277
[2025-08-12 23:42:22,130][__main__][INFO] - SLURM_JOB_ID: 29925203
[2025-08-12 23:42:22,130][__main__][INFO] - NODE_RANK: unknown
[2025-08-12 23:42:22,130][__main__][INFO] - WORLD_SIZE: unknown
[2025-08-12 23:42:22,131][__main__][INFO] - MASTER_ADDR: unknown
[2025-08-12 23:42:22,131][__main__][INFO] - MASTER_PORT: unknown
[2025-08-12 23:42:22,131][__main__][INFO] - SLURM_NODEID: 0
[2025-08-12 23:42:22,131][__main__][INFO] - SLURM_NNODES: 1
[2025-08-12 23:42:22,131][__main__][INFO] - SLURM_NODELIST: holygpu8a11603
[2025-08-12 23:42:22,131][__main__][INFO] - Architecture: resnet50
[2025-08-12 23:42:22,131][__main__][INFO] - Embedding Dim: 64
[2025-08-12 23:42:22,131][__main__][INFO] - Learning Rate: 0.0003
[2025-08-12 23:42:22,131][__main__][INFO] - Weight Decay: 0.0
[2025-08-12 23:42:22,131][__main__][INFO] - Optimizer: adamw
[2025-08-12 23:42:22,131][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-12 23:42:22,131][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-12 23:42:22,131][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-12 23:42:22,131][__main__][INFO] - Channel Multipliers: [2, 4, 8, 16]
[2025-08-12 23:42:22,131][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-12 23:42:22,131][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-12 23:42:22,131][__main__][INFO] - Use LSTM: False
[2025-08-12 23:42:22,131][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-12 23:42:22,131][__main__][INFO] - Dataset: code_type=surface_code, d=13, rounds_max=13, p=2.1
[2025-08-12 23:42:22,131][__main__][INFO] - Standard training (no curriculum)
[2025-08-12 23:42:22,132][__main__][INFO] - Accelerator: auto
[2025-08-12 23:42:22,132][__main__][INFO] - Devices per node: 1
[2025-08-12 23:42:22,132][__main__][INFO] - Num Nodes: 1
[2025-08-12 23:42:22,132][__main__][INFO] - Total Devices: 1
[2025-08-12 23:42:22,132][__main__][INFO] - Strategy: auto
[2025-08-12 23:42:22,132][__main__][INFO] - Sync BatchNorm: True
[2025-08-12 23:42:22,132][__main__][INFO] - MWPM filtering: False
[2025-08-12 23:42:22,132][__main__][INFO] - Batch Size: auto-tuned
[2025-08-12 23:42:22,132][__main__][INFO] - Precision: bf16-mixed
[2025-08-12 23:42:22,132][__main__][INFO] - Max Steps: 50000
[2025-08-12 23:42:22,132][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-12 23:42:22,132][__main__][INFO] - Log every 100 steps
[2025-08-12 23:42:22,132][__main__][INFO] - Num Workers: 8
[2025-08-12 23:42:22,132][__main__][INFO] - Prefetch Factor: 4
[2025-08-12 23:42:22,132][__main__][INFO] - Persistent Workers: True
[2025-08-12 23:42:22,132][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d13-adamw
[2025-08-12 23:42:22,142][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-12 23:42:22,142][__main__][INFO] - Initializing wandb logger with params
[2025-08-12 23:42:30,837][__main__][INFO] - Saved new W&B run ID to file: epz53cs3
[2025-08-12 23:42:30,945][__main__][INFO] - === AUTO-TUNING BATCH SIZE (RANK 0) ===
[2025-08-12 23:42:31,905][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=13, rounds_max=13, p=2.1, batch_size=2
[2025-08-12 23:42:35,292][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=13, rounds_max=13, p=2.1, batch_size=4
[2025-08-12 23:42:37,071][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=13, rounds_max=13, p=2.1, batch_size=8
[2025-08-12 23:42:38,893][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=13, rounds_max=13, p=2.1, batch_size=16
[2025-08-12 23:42:40,913][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=13, rounds_max=13, p=2.1, batch_size=32
[2025-08-12 23:42:43,162][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=13, rounds_max=13, p=2.1, batch_size=64
[2025-08-12 23:42:45,702][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=13, rounds_max=13, p=2.1, batch_size=128
[2025-08-12 23:42:48,653][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=13, rounds_max=13, p=2.1, batch_size=256
[2025-08-12 23:42:51,936][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=13, rounds_max=13, p=2.1, batch_size=192
[2025-08-12 23:42:55,591][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=13, rounds_max=13, p=2.1, batch_size=224
[2025-08-12 23:42:58,615][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=13, rounds_max=13, p=2.1, batch_size=208
[2025-08-12 23:43:02,452][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=13, rounds_max=13, p=2.1, batch_size=216
[2025-08-12 23:43:06,307][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=13, rounds_max=13, p=2.1, batch_size=220
[2025-08-12 23:43:10,228][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=13, rounds_max=13, p=2.1, batch_size=222
[2025-08-12 23:43:13,163][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=13, rounds_max=13, p=2.1, batch_size=221
[2025-08-12 23:43:17,335][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=13, rounds_max=13, p=2.1, batch_size=221
[2025-08-12 23:43:18,449][__main__][INFO] - Model loaded from checkpoint at global step 0
[2025-08-12 23:43:18,586][__main__][INFO] - Found optimal batch size 221
[2025-08-12 23:43:18,590][__main__][INFO] - Saved batch size 187 to file
[2025-08-12 23:43:18,590][__main__][INFO] - Optimal per-GPU batch size found: 187
[2025-08-12 23:43:18,590][__main__][INFO] - Effective total batch size across 1 device(s) on 1 node(s) with 1 accumulation steps: 187
[2025-08-12 23:43:18,595][__main__][INFO] - Saved metadata: {'timestamp': 1755056598.5910676, 'slurm_job_id': '29925203', 'batch_size': 187, 'num_devices': 1, 'effective_batch_size': 187}
[2025-08-12 23:43:18,695][__main__][INFO] - === STARTING TRAINING ===
[2025-08-12 23:43:18,718][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=13, rounds_max=13, p=2.1, batch_size=187
[2025-08-13 02:49:34,252][__main__][INFO] - === STARTING EXPERIMENT: d13-schedulefree ===
[2025-08-13 02:49:34,253][__main__][INFO] - PID: 3859659
[2025-08-13 02:49:34,253][__main__][INFO] - SLURM_JOB_ID: 29925212
[2025-08-13 02:49:34,253][__main__][INFO] - NODE_RANK: unknown
[2025-08-13 02:49:34,253][__main__][INFO] - WORLD_SIZE: unknown
[2025-08-13 02:49:34,253][__main__][INFO] - MASTER_ADDR: unknown
[2025-08-13 02:49:34,253][__main__][INFO] - MASTER_PORT: unknown
[2025-08-13 02:49:34,253][__main__][INFO] - SLURM_NODEID: 0
[2025-08-13 02:49:34,253][__main__][INFO] - SLURM_NNODES: 1
[2025-08-13 02:49:34,253][__main__][INFO] - SLURM_NODELIST: holygpu8a16403
[2025-08-13 02:49:34,253][__main__][INFO] - Architecture: resnet50
[2025-08-13 02:49:34,253][__main__][INFO] - Embedding Dim: 64
[2025-08-13 02:49:34,253][__main__][INFO] - Learning Rate: 0.0003
[2025-08-13 02:49:34,253][__main__][INFO] - Weight Decay: 0.0
[2025-08-13 02:49:34,254][__main__][INFO] - Optimizer: schedulefree
[2025-08-13 02:49:34,254][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-13 02:49:34,254][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-13 02:49:34,254][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-13 02:49:34,254][__main__][INFO] - Channel Multipliers: [2, 4, 8, 16]
[2025-08-13 02:49:34,254][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-13 02:49:34,254][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-13 02:49:34,254][__main__][INFO] - Use LSTM: False
[2025-08-13 02:49:34,254][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-13 02:49:34,254][__main__][INFO] - Dataset: code_type=surface_code, d=13, rounds_max=13, p=2.1
[2025-08-13 02:49:34,254][__main__][INFO] - Standard training (no curriculum)
[2025-08-13 02:49:34,254][__main__][INFO] - Accelerator: auto
[2025-08-13 02:49:34,255][__main__][INFO] - Devices per node: 1
[2025-08-13 02:49:34,255][__main__][INFO] - Num Nodes: 1
[2025-08-13 02:49:34,255][__main__][INFO] - Total Devices: 1
[2025-08-13 02:49:34,255][__main__][INFO] - Strategy: auto
[2025-08-13 02:49:34,255][__main__][INFO] - Sync BatchNorm: True
[2025-08-13 02:49:34,255][__main__][INFO] - MWPM filtering: False
[2025-08-13 02:49:34,255][__main__][INFO] - Batch Size: auto-tuned
[2025-08-13 02:49:34,255][__main__][INFO] - Precision: bf16-mixed
[2025-08-13 02:49:34,255][__main__][INFO] - Max Steps: 50000
[2025-08-13 02:49:34,255][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-13 02:49:34,255][__main__][INFO] - Log every 100 steps
[2025-08-13 02:49:34,255][__main__][INFO] - Num Workers: 8
[2025-08-13 02:49:34,255][__main__][INFO] - Prefetch Factor: 4
[2025-08-13 02:49:34,256][__main__][INFO] - Persistent Workers: True
[2025-08-13 02:49:34,256][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d13-schedulefree
[2025-08-13 02:49:34,267][__main__][INFO] - Found latest checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d13-schedulefree/checkpoints/d13-schedulefree-step=40702.ckpt
[2025-08-13 02:49:34,268][__main__][INFO] - === STARTING EXPERIMENT: d13-adamw ===
[2025-08-13 02:49:34,269][__main__][INFO] - PID: 3859660
[2025-08-13 02:49:34,269][__main__][INFO] - Loaded W&B run ID from file: j326hyiv
[2025-08-13 02:49:34,269][__main__][INFO] - SLURM_JOB_ID: 29925203
[2025-08-13 02:49:34,270][__main__][INFO] - NODE_RANK: unknown
[2025-08-13 02:49:34,270][__main__][INFO] - WORLD_SIZE: unknown
[2025-08-13 02:49:34,270][__main__][INFO] - MASTER_ADDR: unknown
[2025-08-13 02:49:34,270][__main__][INFO] - MASTER_PORT: unknown
[2025-08-13 02:49:34,270][__main__][INFO] - SLURM_NODEID: 0
[2025-08-13 02:49:34,270][__main__][INFO] - SLURM_NNODES: 1
[2025-08-13 02:49:34,270][__main__][INFO] - SLURM_NODELIST: holygpu8a16403
[2025-08-13 02:49:34,270][__main__][INFO] - Architecture: resnet50
[2025-08-13 02:49:34,270][__main__][INFO] - Setting up W&B logger with existing run ID: j326hyiv
[2025-08-13 02:49:34,270][__main__][INFO] - Embedding Dim: 64
[2025-08-13 02:49:34,270][__main__][INFO] - Initializing wandb logger with params
[2025-08-13 02:49:34,270][__main__][INFO] - Learning Rate: 0.0003
[2025-08-13 02:49:34,270][__main__][INFO] - Weight Decay: 0.0
[2025-08-13 02:49:34,270][__main__][INFO] - Optimizer: adamw
[2025-08-13 02:49:34,270][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-13 02:49:34,270][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-13 02:49:34,271][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-13 02:49:34,271][__main__][INFO] - Channel Multipliers: [2, 4, 8, 16]
[2025-08-13 02:49:34,271][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-13 02:49:34,271][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-13 02:49:34,271][__main__][INFO] - Use LSTM: False
[2025-08-13 02:49:34,271][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-13 02:49:34,271][__main__][INFO] - Dataset: code_type=surface_code, d=13, rounds_max=13, p=2.1
[2025-08-13 02:49:34,271][__main__][INFO] - Standard training (no curriculum)
[2025-08-13 02:49:34,271][__main__][INFO] - Accelerator: auto
[2025-08-13 02:49:34,271][__main__][INFO] - Devices per node: 1
[2025-08-13 02:49:34,271][__main__][INFO] - Num Nodes: 1
[2025-08-13 02:49:34,272][__main__][INFO] - Total Devices: 1
[2025-08-13 02:49:34,272][__main__][INFO] - Strategy: auto
[2025-08-13 02:49:34,272][__main__][INFO] - Sync BatchNorm: True
[2025-08-13 02:49:34,272][__main__][INFO] - MWPM filtering: False
[2025-08-13 02:49:34,272][__main__][INFO] - Batch Size: auto-tuned
[2025-08-13 02:49:34,272][__main__][INFO] - Precision: bf16-mixed
[2025-08-13 02:49:34,272][__main__][INFO] - Max Steps: 50000
[2025-08-13 02:49:34,272][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-13 02:49:34,272][__main__][INFO] - Log every 100 steps
[2025-08-13 02:49:34,272][__main__][INFO] - Num Workers: 8
[2025-08-13 02:49:34,272][__main__][INFO] - Prefetch Factor: 4
[2025-08-13 02:49:34,272][__main__][INFO] - Persistent Workers: True
[2025-08-13 02:49:34,272][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d13-adamw
[2025-08-13 02:49:34,284][__main__][INFO] - Found latest checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d13-adamw/checkpoints/d13-adamw-step=40821.ckpt
[2025-08-13 02:49:34,286][__main__][INFO] - Loaded W&B run ID from file: epz53cs3
[2025-08-13 02:49:34,287][__main__][INFO] - Setting up W&B logger with existing run ID: epz53cs3
[2025-08-13 02:49:34,287][__main__][INFO] - Initializing wandb logger with params
[2025-08-13 02:49:34,455][__main__][INFO] - Loaded batch size 187 from file
[2025-08-13 02:49:34,455][__main__][INFO] - Effective total batch size across 1 device(s) on 1 node(s) with 1 accumulation steps: 187
[2025-08-13 02:49:34,456][__main__][INFO] - Loaded batch size 187 from file
[2025-08-13 02:49:34,456][__main__][INFO] - Effective total batch size across 1 device(s) on 1 node(s) with 1 accumulation steps: 187
[2025-08-13 02:49:34,461][__main__][INFO] - Saved metadata: {'timestamp': 1755067774.4560575, 'slurm_job_id': '29925212', 'batch_size': 187, 'num_devices': 1, 'effective_batch_size': 187}
[2025-08-13 02:49:34,464][__main__][INFO] - Saved metadata: {'timestamp': 1755067774.456531, 'slurm_job_id': '29925203', 'batch_size': 187, 'num_devices': 1, 'effective_batch_size': 187}
[2025-08-13 02:49:44,250][data_module][INFO] - Set DataModule global_step_offset to 40821 (will apply when dataset is created)
[2025-08-13 02:49:44,253][__main__][INFO] - Updated DataModule global_step_offset to 40821 for resume
[2025-08-13 02:49:44,277][data_module][INFO] - Set DataModule global_step_offset to 40702 (will apply when dataset is created)
[2025-08-13 02:49:44,277][__main__][INFO] - Updated DataModule global_step_offset to 40702 for resume
[2025-08-13 02:49:44,404][__main__][INFO] - === STARTING TRAINING ===
[2025-08-13 02:49:44,405][__main__][INFO] - Resuming from checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d13-schedulefree/checkpoints/d13-schedulefree-step=40702.ckpt
[2025-08-13 02:49:44,404][__main__][INFO] - === STARTING TRAINING ===
[2025-08-13 02:49:44,405][__main__][INFO] - Resuming from checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d13-adamw/checkpoints/d13-adamw-step=40821.ckpt
[2025-08-13 02:49:44,559][__main__][INFO] - Model loaded from checkpoint at global step 40702
[2025-08-13 02:49:44,565][__main__][INFO] - Model loaded from checkpoint at global step 40821
[2025-08-13 02:49:45,052][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=13, rounds_max=13, p=2.1, batch_size=187
[2025-08-13 02:49:45,053][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=13, rounds_max=13, p=2.1, batch_size=187
[2025-08-13 03:31:15,157][__main__][INFO] - === TRAINING COMPLETED SUCCESSFULLY ===
[2025-08-13 03:31:40,061][__main__][INFO] - === TRAINING COMPLETED SUCCESSFULLY ===
[2025-08-13 19:20:31,559][__main__][INFO] - === STARTING EXPERIMENT: d11-curriculum ===
[2025-08-13 19:20:31,559][__main__][INFO] - PID: 2928960
[2025-08-13 19:20:31,559][__main__][INFO] - SLURM_JOB_ID: 30034718
[2025-08-13 19:20:31,559][__main__][INFO] - NODE_RANK: unknown
[2025-08-13 19:20:31,560][__main__][INFO] - WORLD_SIZE: unknown
[2025-08-13 19:20:31,560][__main__][INFO] - MASTER_ADDR: unknown
[2025-08-13 19:20:31,560][__main__][INFO] - MASTER_PORT: unknown
[2025-08-13 19:20:31,560][__main__][INFO] - SLURM_NODEID: 0
[2025-08-13 19:20:31,560][__main__][INFO] - SLURM_NNODES: 1
[2025-08-13 19:20:31,560][__main__][INFO] - SLURM_NODELIST: holygpu8a26505
[2025-08-13 19:20:31,560][__main__][INFO] - Architecture: resnet50
[2025-08-13 19:20:31,560][__main__][INFO] - Embedding Dim: 128
[2025-08-13 19:20:31,560][__main__][INFO] - Learning Rate: 0.0004
[2025-08-13 19:20:31,560][__main__][INFO] - Weight Decay: 0.0
[2025-08-13 19:20:31,560][__main__][INFO] - Optimizer: schedulefree
[2025-08-13 19:20:31,560][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-13 19:20:31,561][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-13 19:20:31,561][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-13 19:20:31,561][__main__][INFO] - Channel Multipliers: [2, 2.5, 3, 3.5]
[2025-08-13 19:20:31,561][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-13 19:20:31,561][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-13 19:20:31,561][__main__][INFO] - Use LSTM: False
[2025-08-13 19:20:31,561][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-13 19:20:31,561][__main__][INFO] - Dataset: code_type=surface_code, d=11, rounds_list=[11], p=2.1
[2025-08-13 19:20:31,561][__main__][INFO] - === 3-STAGE CURRICULUM LEARNING ENABLED ===
[2025-08-13 19:20:31,562][__main__][INFO] - Stage 1: p=0.5 for 40000 steps
[2025-08-13 19:20:31,562][__main__][INFO] - Stage 2: p=0.5→2.1 over 50000 steps
[2025-08-13 19:20:31,562][__main__][INFO] - Stage 3: p=2.1 for 20000 steps
[2025-08-13 19:20:31,562][__main__][INFO] - Total curriculum steps: 110000
[2025-08-13 19:20:31,562][__main__][INFO] - Accelerator: auto
[2025-08-13 19:20:31,562][__main__][INFO] - Devices per node: 4
[2025-08-13 19:20:31,562][__main__][INFO] - Num Nodes: 1
[2025-08-13 19:20:31,562][__main__][INFO] - Total Devices: 4
[2025-08-13 19:20:31,562][__main__][INFO] - Strategy: auto
[2025-08-13 19:20:31,562][__main__][INFO] - Sync BatchNorm: True
[2025-08-13 19:20:31,563][__main__][INFO] - MWPM filtering: False
[2025-08-13 19:20:31,563][__main__][INFO] - Batch Size: auto-tuned
[2025-08-13 19:20:31,563][__main__][INFO] - Precision: bf16-mixed
[2025-08-13 19:20:31,563][__main__][INFO] - Max Steps: 110000 (curriculum override)
[2025-08-13 19:20:31,563][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-13 19:20:31,563][__main__][INFO] - Log every 100 steps
[2025-08-13 19:20:31,563][__main__][INFO] - Num Workers: 6
[2025-08-13 19:20:31,563][__main__][INFO] - Prefetch Factor: 4
[2025-08-13 19:20:31,563][__main__][INFO] - Persistent Workers: True
[2025-08-13 19:20:31,563][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d11-curriculum
[2025-08-13 19:20:31,574][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-13 19:20:31,574][__main__][INFO] - Initializing wandb logger with params
[2025-08-13 19:20:33,947][__main__][INFO] - Saved new W&B run ID to file: 437425ju
[2025-08-13 19:20:33,948][stage_manager][INFO] - Initialized 3-stage curriculum learning:
[2025-08-13 19:20:33,948][stage_manager][INFO] -   Stage 1: p=0.5 for 40000 steps
[2025-08-13 19:20:33,948][stage_manager][INFO] -   Stage 2: p=0.5→2.1 over 50000 steps
[2025-08-13 19:20:33,948][stage_manager][INFO] -   Stage 3: p=2.1 for 20000 steps
[2025-08-13 19:20:33,949][stage_manager][INFO] -   Total steps: 110000
[2025-08-13 19:20:34,034][__main__][INFO] - === AUTO-TUNING BATCH SIZE (RANK 0) ===
[2025-08-13 19:20:35,050][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=2
[2025-08-13 19:20:35,050][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:20:37,516][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=4
[2025-08-13 19:20:37,516][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:20:38,906][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=8
[2025-08-13 19:20:38,907][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:20:40,313][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=16
[2025-08-13 19:20:40,313][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:20:41,765][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=32
[2025-08-13 19:20:41,765][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:20:43,345][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=64
[2025-08-13 19:20:43,346][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:20:45,020][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=128
[2025-08-13 19:20:45,021][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:20:47,033][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=256
[2025-08-13 19:20:47,033][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:20:49,743][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=512
[2025-08-13 19:20:49,744][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:20:53,938][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=1024
[2025-08-13 19:20:53,938][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:20:55,624][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=768
[2025-08-13 19:20:55,624][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:21:01,314][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=896
[2025-08-13 19:21:01,315][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:21:03,455][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=832
[2025-08-13 19:21:03,455][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:21:09,277][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=864
[2025-08-13 19:21:09,277][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:21:11,797][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=848
[2025-08-13 19:21:11,797][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:21:14,481][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=840
[2025-08-13 19:21:14,482][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:21:20,342][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=844
[2025-08-13 19:21:20,343][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:21:22,447][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=842
[2025-08-13 19:21:22,448][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:21:28,284][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=843
[2025-08-13 19:21:28,284][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:21:34,526][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=843
[2025-08-13 19:21:34,529][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:21:35,362][__main__][INFO] - Model loaded from checkpoint at global step 0
[2025-08-13 19:21:35,542][__main__][INFO] - Found optimal batch size 843
[2025-08-13 19:21:35,550][__main__][INFO] - Saved batch size 716 to file
[2025-08-13 19:21:35,550][__main__][INFO] - Optimal per-GPU batch size found: 716
[2025-08-13 19:21:35,551][__main__][INFO] - Effective total batch size across 4 device(s) on 1 node(s) with 1 accumulation steps: 2864
[2025-08-13 19:21:35,554][__main__][INFO] - Saved metadata: {'timestamp': 1755127295.551162, 'slurm_job_id': '30034718', 'batch_size': 716, 'num_devices': 4, 'effective_batch_size': 2864}
[2025-08-13 19:21:36,006][__main__][INFO] - === STARTING TRAINING ===
[2025-08-13 19:22:41,532][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=716
[2025-08-13 19:22:41,532][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:34:35,210][__main__][INFO] - === STARTING EXPERIMENT: d15-curriculum ===
[2025-08-13 19:34:35,212][__main__][INFO] - PID: 2934277
[2025-08-13 19:34:35,212][__main__][INFO] - SLURM_JOB_ID: 30034796
[2025-08-13 19:34:35,212][__main__][INFO] - NODE_RANK: unknown
[2025-08-13 19:34:35,212][__main__][INFO] - WORLD_SIZE: unknown
[2025-08-13 19:34:35,212][__main__][INFO] - MASTER_ADDR: unknown
[2025-08-13 19:34:35,212][__main__][INFO] - MASTER_PORT: unknown
[2025-08-13 19:34:35,212][__main__][INFO] - SLURM_NODEID: 0
[2025-08-13 19:34:35,212][__main__][INFO] - SLURM_NNODES: 1
[2025-08-13 19:34:35,212][__main__][INFO] - SLURM_NODELIST: holygpu8a26505
[2025-08-13 19:34:35,212][__main__][INFO] - Architecture: resnet50
[2025-08-13 19:34:35,212][__main__][INFO] - Embedding Dim: 128
[2025-08-13 19:34:35,212][__main__][INFO] - Learning Rate: 0.0004
[2025-08-13 19:34:35,213][__main__][INFO] - Weight Decay: 0.0
[2025-08-13 19:34:35,213][__main__][INFO] - Optimizer: schedulefree
[2025-08-13 19:34:35,213][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-13 19:34:35,213][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-13 19:34:35,213][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-13 19:34:35,213][__main__][INFO] - Channel Multipliers: [2, 2.5, 3, 3.5]
[2025-08-13 19:34:35,213][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-13 19:34:35,213][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-13 19:34:35,213][__main__][INFO] - Use LSTM: False
[2025-08-13 19:34:35,213][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-13 19:34:35,214][__main__][INFO] - Dataset: code_type=surface_code, d=15, rounds_list=[15], p=2.1
[2025-08-13 19:34:35,214][__main__][INFO] - === 3-STAGE CURRICULUM LEARNING ENABLED ===
[2025-08-13 19:34:35,214][__main__][INFO] - Stage 1: p=0.5 for 50000 steps
[2025-08-13 19:34:35,214][__main__][INFO] - Stage 2: p=0.5→2.1 over 50000 steps
[2025-08-13 19:34:35,214][__main__][INFO] - Stage 3: p=2.1 for 200000 steps
[2025-08-13 19:34:35,214][__main__][INFO] - Total curriculum steps: 300000
[2025-08-13 19:34:35,214][__main__][INFO] - Accelerator: auto
[2025-08-13 19:34:35,214][__main__][INFO] - Devices per node: 4
[2025-08-13 19:34:35,214][__main__][INFO] - Num Nodes: 1
[2025-08-13 19:34:35,214][__main__][INFO] - Total Devices: 4
[2025-08-13 19:34:35,215][__main__][INFO] - Strategy: auto
[2025-08-13 19:34:35,215][__main__][INFO] - Sync BatchNorm: True
[2025-08-13 19:34:35,215][__main__][INFO] - MWPM filtering: False
[2025-08-13 19:34:35,215][__main__][INFO] - Batch Size: auto-tuned
[2025-08-13 19:34:35,215][__main__][INFO] - Precision: bf16-mixed
[2025-08-13 19:34:35,215][__main__][INFO] - Max Steps: 300000 (curriculum override)
[2025-08-13 19:34:35,215][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-13 19:34:35,215][__main__][INFO] - Log every 100 steps
[2025-08-13 19:34:35,215][__main__][INFO] - Num Workers: 7
[2025-08-13 19:34:35,215][__main__][INFO] - Prefetch Factor: 4
[2025-08-13 19:34:35,216][__main__][INFO] - Persistent Workers: True
[2025-08-13 19:34:35,216][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d15-curriculum
[2025-08-13 19:34:35,229][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-13 19:34:35,229][__main__][INFO] - Initializing wandb logger with params
[2025-08-13 19:34:37,474][__main__][INFO] - Saved new W&B run ID to file: 9errihhl
[2025-08-13 19:34:37,475][stage_manager][INFO] - Initialized 3-stage curriculum learning:
[2025-08-13 19:34:37,475][stage_manager][INFO] -   Stage 1: p=0.5 for 50000 steps
[2025-08-13 19:34:37,476][stage_manager][INFO] -   Stage 2: p=0.5→2.1 over 50000 steps
[2025-08-13 19:34:37,476][stage_manager][INFO] -   Stage 3: p=2.1 for 200000 steps
[2025-08-13 19:34:37,476][stage_manager][INFO] -   Total steps: 300000
[2025-08-13 19:34:37,553][__main__][INFO] - === AUTO-TUNING BATCH SIZE (RANK 0) ===
[2025-08-13 19:34:38,457][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=15, rounds_list=[15], p=2.1, batch_size=2
[2025-08-13 19:34:38,458][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:34:40,743][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=15, rounds_list=[15], p=2.1, batch_size=4
[2025-08-13 19:34:40,744][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:34:42,375][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=15, rounds_list=[15], p=2.1, batch_size=8
[2025-08-13 19:34:42,375][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:34:44,017][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=15, rounds_list=[15], p=2.1, batch_size=16
[2025-08-13 19:34:44,018][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:34:45,760][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=15, rounds_list=[15], p=2.1, batch_size=32
[2025-08-13 19:34:45,760][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:34:47,799][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=15, rounds_list=[15], p=2.1, batch_size=64
[2025-08-13 19:34:47,799][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:34:50,221][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=15, rounds_list=[15], p=2.1, batch_size=128
[2025-08-13 19:34:50,221][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:34:53,469][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=15, rounds_list=[15], p=2.1, batch_size=256
[2025-08-13 19:34:53,469][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:34:58,510][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=15, rounds_list=[15], p=2.1, batch_size=512
[2025-08-13 19:34:58,510][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:35:00,419][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=15, rounds_list=[15], p=2.1, batch_size=384
[2025-08-13 19:35:00,420][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:35:02,251][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=15, rounds_list=[15], p=2.1, batch_size=320
[2025-08-13 19:35:02,251][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:35:07,952][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=15, rounds_list=[15], p=2.1, batch_size=352
[2025-08-13 19:35:07,952][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:35:14,077][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=15, rounds_list=[15], p=2.1, batch_size=368
[2025-08-13 19:35:14,078][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:35:16,438][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=15, rounds_list=[15], p=2.1, batch_size=360
[2025-08-13 19:35:16,439][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:35:19,321][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=15, rounds_list=[15], p=2.1, batch_size=356
[2025-08-13 19:35:19,321][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:35:22,130][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=15, rounds_list=[15], p=2.1, batch_size=354
[2025-08-13 19:35:22,130][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:35:28,222][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=15, rounds_list=[15], p=2.1, batch_size=355
[2025-08-13 19:35:28,222][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:35:34,838][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=15, rounds_list=[15], p=2.1, batch_size=355
[2025-08-13 19:35:34,838][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:35:35,943][__main__][INFO] - Model loaded from checkpoint at global step 0
[2025-08-13 19:35:36,116][__main__][INFO] - Found optimal batch size 355
[2025-08-13 19:35:36,124][__main__][INFO] - Saved batch size 301 to file
[2025-08-13 19:35:36,124][__main__][INFO] - Optimal per-GPU batch size found: 301
[2025-08-13 19:35:36,124][__main__][INFO] - Effective total batch size across 4 device(s) on 1 node(s) with 1 accumulation steps: 1204
[2025-08-13 19:35:36,129][__main__][INFO] - Saved metadata: {'timestamp': 1755128136.1250432, 'slurm_job_id': '30034796', 'batch_size': 301, 'num_devices': 4, 'effective_batch_size': 1204}
[2025-08-13 19:35:36,578][__main__][INFO] - === STARTING TRAINING ===
[2025-08-13 19:36:40,759][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=15, rounds_list=[15], p=2.1, batch_size=301
[2025-08-13 19:36:40,761][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:38:07,784][__main__][INFO] - === STARTING EXPERIMENT: d11-curriculum ===
[2025-08-13 19:38:07,785][__main__][INFO] - PID: 2778527
[2025-08-13 19:38:07,785][__main__][INFO] - SLURM_JOB_ID: 30051570
[2025-08-13 19:38:07,785][__main__][INFO] - NODE_RANK: unknown
[2025-08-13 19:38:07,785][__main__][INFO] - WORLD_SIZE: unknown
[2025-08-13 19:38:07,785][__main__][INFO] - MASTER_ADDR: unknown
[2025-08-13 19:38:07,785][__main__][INFO] - MASTER_PORT: unknown
[2025-08-13 19:38:07,785][__main__][INFO] - SLURM_NODEID: 0
[2025-08-13 19:38:07,785][__main__][INFO] - SLURM_NNODES: 1
[2025-08-13 19:38:07,785][__main__][INFO] - SLURM_NODELIST: holygpu7c26105
[2025-08-13 19:38:07,785][__main__][INFO] - Architecture: resnet50
[2025-08-13 19:38:07,785][__main__][INFO] - Embedding Dim: 128
[2025-08-13 19:38:07,785][__main__][INFO] - Learning Rate: 0.0004
[2025-08-13 19:38:07,785][__main__][INFO] - Weight Decay: 0.0
[2025-08-13 19:38:07,785][__main__][INFO] - Optimizer: schedulefree
[2025-08-13 19:38:07,786][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-13 19:38:07,786][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-13 19:38:07,786][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-13 19:38:07,786][__main__][INFO] - Channel Multipliers: [2, 2.5, 3, 3.5]
[2025-08-13 19:38:07,786][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-13 19:38:07,786][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-13 19:38:07,786][__main__][INFO] - Use LSTM: False
[2025-08-13 19:38:07,786][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-13 19:38:07,786][__main__][INFO] - Dataset: code_type=surface_code, d=11, rounds_list=[11], p=2.1
[2025-08-13 19:38:07,786][__main__][INFO] - === 3-STAGE CURRICULUM LEARNING ENABLED ===
[2025-08-13 19:38:07,786][__main__][INFO] - Stage 1: p=0.5 for 40000 steps
[2025-08-13 19:38:07,786][__main__][INFO] - Stage 2: p=0.5→2.1 over 50000 steps
[2025-08-13 19:38:07,787][__main__][INFO] - Stage 3: p=2.1 for 20000 steps
[2025-08-13 19:38:07,787][__main__][INFO] - Total curriculum steps: 110000
[2025-08-13 19:38:07,787][__main__][INFO] - Accelerator: auto
[2025-08-13 19:38:07,787][__main__][INFO] - Devices per node: 4
[2025-08-13 19:38:07,787][__main__][INFO] - Num Nodes: 1
[2025-08-13 19:38:07,787][__main__][INFO] - Total Devices: 4
[2025-08-13 19:38:07,787][__main__][INFO] - Strategy: auto
[2025-08-13 19:38:07,787][__main__][INFO] - Sync BatchNorm: True
[2025-08-13 19:38:07,787][__main__][INFO] - MWPM filtering: False
[2025-08-13 19:38:07,787][__main__][INFO] - Batch Size: auto-tuned
[2025-08-13 19:38:07,787][__main__][INFO] - Precision: bf16-mixed
[2025-08-13 19:38:07,787][__main__][INFO] - Max Steps: 110000 (curriculum override)
[2025-08-13 19:38:07,787][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-13 19:38:07,788][__main__][INFO] - Log every 100 steps
[2025-08-13 19:38:07,788][__main__][INFO] - Num Workers: 6
[2025-08-13 19:38:07,788][__main__][INFO] - Prefetch Factor: 4
[2025-08-13 19:38:07,788][__main__][INFO] - Persistent Workers: True
[2025-08-13 19:38:07,788][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d11-curriculum
[2025-08-13 19:38:07,800][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-13 19:38:07,801][__main__][INFO] - Initializing wandb logger with params
[2025-08-13 19:38:16,229][__main__][INFO] - Saved new W&B run ID to file: uiuxvoj8
[2025-08-13 19:38:16,232][stage_manager][INFO] - Initialized 3-stage curriculum learning:
[2025-08-13 19:38:16,232][stage_manager][INFO] -   Stage 1: p=0.5 for 40000 steps
[2025-08-13 19:38:16,232][stage_manager][INFO] -   Stage 2: p=0.5→2.1 over 50000 steps
[2025-08-13 19:38:16,232][stage_manager][INFO] -   Stage 3: p=2.1 for 20000 steps
[2025-08-13 19:38:16,232][stage_manager][INFO] -   Total steps: 110000
[2025-08-13 19:38:16,303][__main__][INFO] - === AUTO-TUNING BATCH SIZE (RANK 0) ===
[2025-08-13 19:38:16,859][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=2
[2025-08-13 19:38:16,860][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:38:23,396][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=4
[2025-08-13 19:38:23,398][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:38:24,198][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=8
[2025-08-13 19:38:24,198][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:38:25,653][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=16
[2025-08-13 19:38:25,653][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:38:26,769][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=32
[2025-08-13 19:38:26,769][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:38:28,116][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=64
[2025-08-13 19:38:28,117][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:38:30,344][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=128
[2025-08-13 19:38:30,344][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:38:33,893][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=256
[2025-08-13 19:38:33,893][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:38:35,344][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=192
[2025-08-13 19:38:35,344][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:38:40,634][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=224
[2025-08-13 19:38:40,634][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:38:41,945][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=208
[2025-08-13 19:38:41,945][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:38:43,703][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=200
[2025-08-13 19:38:43,704][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:38:49,245][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=204
[2025-08-13 19:38:49,245][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:38:51,433][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=202
[2025-08-13 19:38:51,434][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:38:57,045][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=203
[2025-08-13 19:38:57,046][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:38:59,212][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=202
[2025-08-13 19:38:59,213][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:38:59,740][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=202
[2025-08-13 19:38:59,740][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:39:00,317][__main__][INFO] - Model loaded from checkpoint at global step 0
[2025-08-13 19:39:00,383][__main__][INFO] - Found optimal batch size 202
[2025-08-13 19:39:00,388][__main__][INFO] - Saved batch size 171 to file
[2025-08-13 19:39:00,388][__main__][INFO] - Optimal per-GPU batch size found: 171
[2025-08-13 19:39:00,388][__main__][INFO] - Effective total batch size across 4 device(s) on 1 node(s) with 1 accumulation steps: 684
[2025-08-13 19:39:00,393][__main__][INFO] - Saved metadata: {'timestamp': 1755128340.3886333, 'slurm_job_id': '30051570', 'batch_size': 171, 'num_devices': 4, 'effective_batch_size': 684}
[2025-08-13 19:40:18,748][__main__][INFO] - === STARTING EXPERIMENT: d11-curriculum ===
[2025-08-13 19:40:18,749][__main__][INFO] - PID: 2779898
[2025-08-13 19:40:18,749][__main__][INFO] - SLURM_JOB_ID: 30051570
[2025-08-13 19:40:18,749][__main__][INFO] - NODE_RANK: unknown
[2025-08-13 19:40:18,749][__main__][INFO] - WORLD_SIZE: unknown
[2025-08-13 19:40:18,749][__main__][INFO] - MASTER_ADDR: unknown
[2025-08-13 19:40:18,749][__main__][INFO] - MASTER_PORT: unknown
[2025-08-13 19:40:18,749][__main__][INFO] - SLURM_NODEID: 0
[2025-08-13 19:40:18,749][__main__][INFO] - SLURM_NNODES: 1
[2025-08-13 19:40:18,749][__main__][INFO] - SLURM_NODELIST: holygpu7c26105
[2025-08-13 19:40:18,749][__main__][INFO] - Architecture: resnet50
[2025-08-13 19:40:18,749][__main__][INFO] - Embedding Dim: 128
[2025-08-13 19:40:18,749][__main__][INFO] - Learning Rate: 0.0004
[2025-08-13 19:40:18,749][__main__][INFO] - Weight Decay: 0.0
[2025-08-13 19:40:18,749][__main__][INFO] - Optimizer: schedulefree
[2025-08-13 19:40:18,750][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-13 19:40:18,750][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-13 19:40:18,750][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-13 19:40:18,750][__main__][INFO] - Channel Multipliers: [2, 2.5, 3, 3.5]
[2025-08-13 19:40:18,750][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-13 19:40:18,750][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-13 19:40:18,750][__main__][INFO] - Use LSTM: False
[2025-08-13 19:40:18,750][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-13 19:40:18,750][__main__][INFO] - Dataset: code_type=surface_code, d=11, rounds_list=[11], p=2.1
[2025-08-13 19:40:18,750][__main__][INFO] - === 3-STAGE CURRICULUM LEARNING ENABLED ===
[2025-08-13 19:40:18,750][__main__][INFO] - Stage 1: p=0.5 for 40000 steps
[2025-08-13 19:40:18,750][__main__][INFO] - Stage 2: p=0.5→2.1 over 50000 steps
[2025-08-13 19:40:18,751][__main__][INFO] - Stage 3: p=2.1 for 20000 steps
[2025-08-13 19:40:18,751][__main__][INFO] - Total curriculum steps: 110000
[2025-08-13 19:40:18,751][__main__][INFO] - Accelerator: auto
[2025-08-13 19:40:18,751][__main__][INFO] - Devices per node: 1
[2025-08-13 19:40:18,751][__main__][INFO] - Num Nodes: 1
[2025-08-13 19:40:18,751][__main__][INFO] - Total Devices: 1
[2025-08-13 19:40:18,751][__main__][INFO] - Strategy: auto
[2025-08-13 19:40:18,751][__main__][INFO] - Sync BatchNorm: True
[2025-08-13 19:40:18,751][__main__][INFO] - MWPM filtering: False
[2025-08-13 19:40:18,751][__main__][INFO] - Batch Size: auto-tuned
[2025-08-13 19:40:18,751][__main__][INFO] - Precision: bf16-mixed
[2025-08-13 19:40:18,751][__main__][INFO] - Max Steps: 110000 (curriculum override)
[2025-08-13 19:40:18,751][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-13 19:40:18,752][__main__][INFO] - Log every 100 steps
[2025-08-13 19:40:18,752][__main__][INFO] - Num Workers: 6
[2025-08-13 19:40:18,752][__main__][INFO] - Prefetch Factor: 4
[2025-08-13 19:40:18,752][__main__][INFO] - Persistent Workers: True
[2025-08-13 19:40:18,752][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d11-curriculum
[2025-08-13 19:40:18,756][__main__][INFO] - Loaded W&B run ID from file: uiuxvoj8
[2025-08-13 19:40:18,757][__main__][INFO] - Setting up W&B logger with existing run ID: uiuxvoj8
[2025-08-13 19:40:18,757][__main__][INFO] - Initializing wandb logger with params
[2025-08-13 19:40:18,760][stage_manager][INFO] - Initialized 3-stage curriculum learning:
[2025-08-13 19:40:18,760][stage_manager][INFO] -   Stage 1: p=0.5 for 40000 steps
[2025-08-13 19:40:18,760][stage_manager][INFO] -   Stage 2: p=0.5→2.1 over 50000 steps
[2025-08-13 19:40:18,760][stage_manager][INFO] -   Stage 3: p=2.1 for 20000 steps
[2025-08-13 19:40:18,760][stage_manager][INFO] -   Total steps: 110000
[2025-08-13 19:40:18,818][__main__][INFO] - Loaded batch size 171 from file
[2025-08-13 19:40:18,818][__main__][INFO] - Effective total batch size across 1 device(s) on 1 node(s) with 1 accumulation steps: 171
[2025-08-13 19:40:18,823][__main__][INFO] - Saved metadata: {'timestamp': 1755128418.8190405, 'slurm_job_id': '30051570', 'batch_size': 171, 'num_devices': 1, 'effective_batch_size': 171}
[2025-08-13 19:40:20,786][__main__][INFO] - === STARTING TRAINING ===
[2025-08-13 19:40:20,958][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=171
[2025-08-13 19:40:20,958][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:42:09,680][__main__][INFO] - === STARTING EXPERIMENT: d11-curriculum ===
[2025-08-13 19:42:09,680][__main__][INFO] - PID: 2780556
[2025-08-13 19:42:09,680][__main__][INFO] - SLURM_JOB_ID: 30051570
[2025-08-13 19:42:09,681][__main__][INFO] - NODE_RANK: unknown
[2025-08-13 19:42:09,681][__main__][INFO] - WORLD_SIZE: unknown
[2025-08-13 19:42:09,681][__main__][INFO] - MASTER_ADDR: unknown
[2025-08-13 19:42:09,681][__main__][INFO] - MASTER_PORT: unknown
[2025-08-13 19:42:09,681][__main__][INFO] - SLURM_NODEID: 0
[2025-08-13 19:42:09,681][__main__][INFO] - SLURM_NNODES: 1
[2025-08-13 19:42:09,681][__main__][INFO] - SLURM_NODELIST: holygpu7c26105
[2025-08-13 19:42:09,681][__main__][INFO] - Architecture: resnet50
[2025-08-13 19:42:09,681][__main__][INFO] - Embedding Dim: 128
[2025-08-13 19:42:09,681][__main__][INFO] - Learning Rate: 0.0004
[2025-08-13 19:42:09,681][__main__][INFO] - Weight Decay: 0.0
[2025-08-13 19:42:09,681][__main__][INFO] - Optimizer: schedulefree
[2025-08-13 19:42:09,681][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-13 19:42:09,681][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-13 19:42:09,681][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-13 19:42:09,681][__main__][INFO] - Channel Multipliers: [2, 2.5, 3, 3.5]
[2025-08-13 19:42:09,682][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-13 19:42:09,682][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-13 19:42:09,682][__main__][INFO] - Use LSTM: False
[2025-08-13 19:42:09,682][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-13 19:42:09,682][__main__][INFO] - Dataset: code_type=surface_code, d=11, rounds_list=[11], p=2.1
[2025-08-13 19:42:09,682][__main__][INFO] - === 3-STAGE CURRICULUM LEARNING ENABLED ===
[2025-08-13 19:42:09,682][__main__][INFO] - Stage 1: p=0.5 for 40000 steps
[2025-08-13 19:42:09,682][__main__][INFO] - Stage 2: p=0.5→2.1 over 50000 steps
[2025-08-13 19:42:09,682][__main__][INFO] - Stage 3: p=2.1 for 20000 steps
[2025-08-13 19:42:09,682][__main__][INFO] - Total curriculum steps: 110000
[2025-08-13 19:42:09,682][__main__][INFO] - Accelerator: auto
[2025-08-13 19:42:09,683][__main__][INFO] - Devices per node: 1
[2025-08-13 19:42:09,683][__main__][INFO] - Num Nodes: 1
[2025-08-13 19:42:09,683][__main__][INFO] - Total Devices: 1
[2025-08-13 19:42:09,683][__main__][INFO] - Strategy: auto
[2025-08-13 19:42:09,683][__main__][INFO] - Sync BatchNorm: True
[2025-08-13 19:42:09,683][__main__][INFO] - MWPM filtering: False
[2025-08-13 19:42:09,683][__main__][INFO] - Batch Size: auto-tuned
[2025-08-13 19:42:09,683][__main__][INFO] - Precision: bf16-mixed
[2025-08-13 19:42:09,683][__main__][INFO] - Max Steps: 110000 (curriculum override)
[2025-08-13 19:42:09,683][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-13 19:42:09,683][__main__][INFO] - Log every 100 steps
[2025-08-13 19:42:09,683][__main__][INFO] - Num Workers: 6
[2025-08-13 19:42:09,683][__main__][INFO] - Prefetch Factor: 4
[2025-08-13 19:42:09,683][__main__][INFO] - Persistent Workers: True
[2025-08-13 19:42:09,684][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d11-curriculum
[2025-08-13 19:42:09,686][__main__][INFO] - W&B logging disabled in config
[2025-08-13 19:42:09,687][stage_manager][INFO] - Initialized 3-stage curriculum learning:
[2025-08-13 19:42:09,687][stage_manager][INFO] -   Stage 1: p=0.5 for 40000 steps
[2025-08-13 19:42:09,687][stage_manager][INFO] -   Stage 2: p=0.5→2.1 over 50000 steps
[2025-08-13 19:42:09,687][stage_manager][INFO] -   Stage 3: p=2.1 for 20000 steps
[2025-08-13 19:42:09,687][stage_manager][INFO] -   Total steps: 110000
[2025-08-13 19:42:09,744][__main__][INFO] - Loaded batch size 171 from file
[2025-08-13 19:42:09,744][__main__][INFO] - Effective total batch size across 1 device(s) on 1 node(s) with 1 accumulation steps: 171
[2025-08-13 19:42:09,747][__main__][INFO] - Saved metadata: {'timestamp': 1755128529.744556, 'slurm_job_id': '30051570', 'batch_size': 171, 'num_devices': 1, 'effective_batch_size': 171}
[2025-08-13 19:42:09,825][__main__][INFO] - === STARTING TRAINING ===
[2025-08-13 19:42:09,993][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=171
[2025-08-13 19:42:09,993][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 19:44:42,017][__main__][INFO] - === STARTING EXPERIMENT: d11-curriculum ===
[2025-08-13 19:44:42,017][__main__][INFO] - PID: 2781808
[2025-08-13 19:44:42,017][__main__][INFO] - SLURM_JOB_ID: 30051570
[2025-08-13 19:44:42,017][__main__][INFO] - NODE_RANK: unknown
[2025-08-13 19:44:42,017][__main__][INFO] - WORLD_SIZE: unknown
[2025-08-13 19:44:42,017][__main__][INFO] - MASTER_ADDR: unknown
[2025-08-13 19:44:42,017][__main__][INFO] - MASTER_PORT: unknown
[2025-08-13 19:44:42,017][__main__][INFO] - SLURM_NODEID: 0
[2025-08-13 19:44:42,017][__main__][INFO] - SLURM_NNODES: 1
[2025-08-13 19:44:42,017][__main__][INFO] - SLURM_NODELIST: holygpu7c26105
[2025-08-13 19:44:42,017][__main__][INFO] - Architecture: resnet50
[2025-08-13 19:44:42,017][__main__][INFO] - Embedding Dim: 128
[2025-08-13 19:44:42,017][__main__][INFO] - Learning Rate: 0.0004
[2025-08-13 19:44:42,017][__main__][INFO] - Weight Decay: 0.0
[2025-08-13 19:44:42,018][__main__][INFO] - Optimizer: schedulefree
[2025-08-13 19:44:42,018][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-13 19:44:42,018][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-13 19:44:42,018][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-13 19:44:42,018][__main__][INFO] - Channel Multipliers: [2, 2.5, 3, 3.5]
[2025-08-13 19:44:42,018][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-13 19:44:42,018][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-13 19:44:42,018][__main__][INFO] - Use LSTM: False
[2025-08-13 19:44:42,018][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-13 19:44:42,018][__main__][INFO] - Dataset: code_type=surface_code, d=11, rounds_list=[11], p=2.1
[2025-08-13 19:44:42,018][__main__][INFO] - === 3-STAGE CURRICULUM LEARNING ENABLED ===
[2025-08-13 19:44:42,018][__main__][INFO] - Stage 1: p=0.5 for 40000 steps
[2025-08-13 19:44:42,019][__main__][INFO] - Stage 2: p=0.5→2.1 over 50000 steps
[2025-08-13 19:44:42,019][__main__][INFO] - Stage 3: p=2.1 for 20000 steps
[2025-08-13 19:44:42,019][__main__][INFO] - Total curriculum steps: 110000
[2025-08-13 19:44:42,019][__main__][INFO] - Accelerator: auto
[2025-08-13 19:44:42,019][__main__][INFO] - Devices per node: 1
[2025-08-13 19:44:42,019][__main__][INFO] - Num Nodes: 1
[2025-08-13 19:44:42,019][__main__][INFO] - Total Devices: 1
[2025-08-13 19:44:42,019][__main__][INFO] - Strategy: auto
[2025-08-13 19:44:42,019][__main__][INFO] - Sync BatchNorm: True
[2025-08-13 19:44:42,019][__main__][INFO] - MWPM filtering: False
[2025-08-13 19:44:42,019][__main__][INFO] - Batch Size: auto-tuned
[2025-08-13 19:44:42,019][__main__][INFO] - Precision: bf16-mixed
[2025-08-13 19:44:42,019][__main__][INFO] - Max Steps: 110000 (curriculum override)
[2025-08-13 19:44:42,020][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-13 19:44:42,020][__main__][INFO] - Log every 100 steps
[2025-08-13 19:44:42,020][__main__][INFO] - Num Workers: 6
[2025-08-13 19:44:42,020][__main__][INFO] - Prefetch Factor: 4
[2025-08-13 19:44:42,020][__main__][INFO] - Persistent Workers: True
[2025-08-13 19:44:42,020][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d11-curriculum
[2025-08-13 19:44:42,023][__main__][INFO] - W&B logging disabled in config
[2025-08-13 19:44:42,024][stage_manager][INFO] - Initialized 3-stage curriculum learning:
[2025-08-13 19:44:42,024][stage_manager][INFO] -   Stage 1: p=0.5 for 40000 steps
[2025-08-13 19:44:42,024][stage_manager][INFO] -   Stage 2: p=0.5→2.1 over 50000 steps
[2025-08-13 19:44:42,024][stage_manager][INFO] -   Stage 3: p=2.1 for 20000 steps
[2025-08-13 19:44:42,024][stage_manager][INFO] -   Total steps: 110000
[2025-08-13 19:44:42,079][__main__][INFO] - Loaded batch size 171 from file
[2025-08-13 19:44:42,079][__main__][INFO] - Effective total batch size across 1 device(s) on 1 node(s) with 1 accumulation steps: 171
[2025-08-13 19:44:42,084][__main__][INFO] - Saved metadata: {'timestamp': 1755128682.0798845, 'slurm_job_id': '30051570', 'batch_size': 171, 'num_devices': 1, 'effective_batch_size': 171}
[2025-08-13 19:44:42,161][__main__][INFO] - === STARTING TRAINING ===
[2025-08-13 19:44:42,327][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=171
[2025-08-13 19:44:42,327][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 22:03:51,532][__main__][INFO] - === STARTING EXPERIMENT: bb ===
[2025-08-13 22:03:51,532][__main__][INFO] - PID: 543545
[2025-08-13 22:03:51,532][__main__][INFO] - SLURM_JOB_ID: 30057267
[2025-08-13 22:03:51,532][__main__][INFO] - NODE_RANK: unknown
[2025-08-13 22:03:51,532][__main__][INFO] - WORLD_SIZE: unknown
[2025-08-13 22:03:51,532][__main__][INFO] - MASTER_ADDR: unknown
[2025-08-13 22:03:51,532][__main__][INFO] - MASTER_PORT: unknown
[2025-08-13 22:03:51,532][__main__][INFO] - SLURM_NODEID: 0
[2025-08-13 22:03:51,532][__main__][INFO] - SLURM_NNODES: 1
[2025-08-13 22:03:51,532][__main__][INFO] - SLURM_NODELIST: holygpu7c26106
[2025-08-13 22:03:51,533][__main__][INFO] - Architecture: rgcn50
[2025-08-13 22:03:51,533][__main__][INFO] - Embedding Dim: 64
[2025-08-13 22:03:51,533][__main__][INFO] - Learning Rate: 0.0003
[2025-08-13 22:03:51,533][__main__][INFO] - Weight Decay: 0.0
[2025-08-13 22:03:51,533][__main__][INFO] - Optimizer: schedulefree
[2025-08-13 22:03:51,533][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-13 22:03:51,533][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-13 22:03:51,533][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-13 22:03:51,533][__main__][INFO] - Channel Multipliers: [2, 4, 8, 16]
[2025-08-13 22:05:05,477][__main__][INFO] - === STARTING EXPERIMENT: bb ===
[2025-08-13 22:05:05,477][__main__][INFO] - PID: 544479
[2025-08-13 22:05:05,477][__main__][INFO] - SLURM_JOB_ID: 30057267
[2025-08-13 22:05:05,477][__main__][INFO] - NODE_RANK: unknown
[2025-08-13 22:05:05,477][__main__][INFO] - WORLD_SIZE: unknown
[2025-08-13 22:05:05,477][__main__][INFO] - MASTER_ADDR: unknown
[2025-08-13 22:05:05,477][__main__][INFO] - MASTER_PORT: unknown
[2025-08-13 22:05:05,477][__main__][INFO] - SLURM_NODEID: 0
[2025-08-13 22:05:05,477][__main__][INFO] - SLURM_NNODES: 1
[2025-08-13 22:05:05,477][__main__][INFO] - SLURM_NODELIST: holygpu7c26106
[2025-08-13 22:05:05,477][__main__][INFO] - Architecture: rgcn50
[2025-08-13 22:05:05,477][__main__][INFO] - Embedding Dim: 64
[2025-08-13 22:05:05,478][__main__][INFO] - Learning Rate: 0.0003
[2025-08-13 22:05:05,478][__main__][INFO] - Weight Decay: 0.0
[2025-08-13 22:05:05,478][__main__][INFO] - Optimizer: schedulefree
[2025-08-13 22:05:05,478][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-13 22:05:05,478][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-13 22:05:05,478][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-13 22:05:05,478][__main__][INFO] - Channel Multipliers: [2, 4, 8, 16]
[2025-08-13 22:06:17,702][__main__][INFO] - === STARTING EXPERIMENT: bb ===
[2025-08-13 22:06:17,702][__main__][INFO] - PID: 544906
[2025-08-13 22:06:17,702][__main__][INFO] - SLURM_JOB_ID: 30057267
[2025-08-13 22:06:17,702][__main__][INFO] - NODE_RANK: unknown
[2025-08-13 22:06:17,702][__main__][INFO] - WORLD_SIZE: unknown
[2025-08-13 22:06:17,702][__main__][INFO] - MASTER_ADDR: unknown
[2025-08-13 22:06:17,702][__main__][INFO] - MASTER_PORT: unknown
[2025-08-13 22:06:17,702][__main__][INFO] - SLURM_NODEID: 0
[2025-08-13 22:06:17,702][__main__][INFO] - SLURM_NNODES: 1
[2025-08-13 22:06:17,702][__main__][INFO] - SLURM_NODELIST: holygpu7c26106
[2025-08-13 22:06:17,702][__main__][INFO] - Architecture: rgcn50
[2025-08-13 22:06:17,702][__main__][INFO] - Embedding Dim: 64
[2025-08-13 22:06:17,702][__main__][INFO] - Learning Rate: 0.0003
[2025-08-13 22:06:17,703][__main__][INFO] - Weight Decay: 0.0
[2025-08-13 22:06:17,703][__main__][INFO] - Optimizer: schedulefree
[2025-08-13 22:06:17,703][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-13 22:06:17,703][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-13 22:06:17,703][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-13 22:06:17,703][__main__][INFO] - Channel Multipliers: [2, 4, 8, 16]
[2025-08-13 22:06:18,387][__main__][INFO] - Num Relations: 66
[2025-08-13 22:06:18,387][__main__][INFO] - Num Logical Qubits: 12
[2025-08-13 22:06:18,387][__main__][INFO] - Dataset: code_type=bivariate_bicycle, l=6, m=6, rounds_list=[6], p=0.5
[2025-08-13 22:06:18,387][__main__][INFO] - Standard training (no curriculum)
[2025-08-13 22:06:18,387][__main__][INFO] - Accelerator: auto
[2025-08-13 22:06:18,387][__main__][INFO] - Devices per node: auto
[2025-08-13 22:06:18,388][__main__][INFO] - Num Nodes: 1
[2025-08-13 22:06:18,388][__main__][INFO] - Total Devices: 1
[2025-08-13 22:06:18,388][__main__][INFO] - Strategy: auto
[2025-08-13 22:06:18,388][__main__][INFO] - Sync BatchNorm: True
[2025-08-13 22:06:18,388][__main__][INFO] - MWPM filtering: False
[2025-08-13 22:06:18,388][__main__][INFO] - Batch Size: auto-tuned
[2025-08-13 22:06:18,388][__main__][INFO] - Precision: bf16-mixed
[2025-08-13 22:06:18,388][__main__][INFO] - Max Steps: 50000
[2025-08-13 22:06:18,388][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-13 22:06:18,388][__main__][INFO] - Log every 100 steps
[2025-08-13 22:06:18,388][__main__][INFO] - Num Workers: 8
[2025-08-13 22:06:18,388][__main__][INFO] - Prefetch Factor: 4
[2025-08-13 22:06:18,388][__main__][INFO] - Persistent Workers: True
[2025-08-13 22:06:18,389][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/bb
[2025-08-13 22:06:18,399][__main__][INFO] - W&B logging disabled in config
[2025-08-13 22:06:19,023][__main__][INFO] - === AUTO-TUNING BATCH SIZE (RANK 0) ===
[2025-08-13 22:06:21,523][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[6], p=0.5, batch_size=2
[2025-08-13 22:07:47,719][__main__][INFO] - === STARTING EXPERIMENT: bb ===
[2025-08-13 22:07:47,720][__main__][INFO] - PID: 545135
[2025-08-13 22:07:47,720][__main__][INFO] - SLURM_JOB_ID: 30057267
[2025-08-13 22:07:47,720][__main__][INFO] - NODE_RANK: unknown
[2025-08-13 22:07:47,720][__main__][INFO] - WORLD_SIZE: unknown
[2025-08-13 22:07:47,720][__main__][INFO] - MASTER_ADDR: unknown
[2025-08-13 22:07:47,720][__main__][INFO] - MASTER_PORT: unknown
[2025-08-13 22:07:47,720][__main__][INFO] - SLURM_NODEID: 0
[2025-08-13 22:07:47,720][__main__][INFO] - SLURM_NNODES: 1
[2025-08-13 22:07:47,720][__main__][INFO] - SLURM_NODELIST: holygpu7c26106
[2025-08-13 22:07:47,720][__main__][INFO] - Architecture: rgcn50
[2025-08-13 22:07:47,720][__main__][INFO] - Embedding Dim: 64
[2025-08-13 22:07:47,720][__main__][INFO] - Learning Rate: 0.0003
[2025-08-13 22:07:47,720][__main__][INFO] - Weight Decay: 0.0
[2025-08-13 22:07:47,720][__main__][INFO] - Optimizer: schedulefree
[2025-08-13 22:07:47,721][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-13 22:07:47,721][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-13 22:07:47,721][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-13 22:07:47,721][__main__][INFO] - Channel Multipliers: [2, 4, 8, 16]
[2025-08-13 22:07:48,348][__main__][INFO] - Num Relations: 66
[2025-08-13 22:07:48,348][__main__][INFO] - Num Logical Qubits: 12
[2025-08-13 22:07:48,348][__main__][INFO] - Dataset: code_type=bivariate_bicycle, l=6, m=6, rounds_list=[6], p=0.5
[2025-08-13 22:07:48,348][__main__][INFO] - Standard training (no curriculum)
[2025-08-13 22:07:48,348][__main__][INFO] - Accelerator: auto
[2025-08-13 22:07:48,349][__main__][INFO] - Devices per node: auto
[2025-08-13 22:07:48,349][__main__][INFO] - Num Nodes: 1
[2025-08-13 22:07:48,349][__main__][INFO] - Total Devices: 1
[2025-08-13 22:07:48,349][__main__][INFO] - Strategy: auto
[2025-08-13 22:07:48,349][__main__][INFO] - Sync BatchNorm: True
[2025-08-13 22:07:48,349][__main__][INFO] - MWPM filtering: False
[2025-08-13 22:07:48,349][__main__][INFO] - Batch Size: auto-tuned
[2025-08-13 22:07:48,349][__main__][INFO] - Precision: bf16-mixed
[2025-08-13 22:07:48,349][__main__][INFO] - Max Steps: 50000
[2025-08-13 22:07:48,349][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-13 22:07:48,349][__main__][INFO] - Log every 100 steps
[2025-08-13 22:07:48,349][__main__][INFO] - Num Workers: 8
[2025-08-13 22:07:48,349][__main__][INFO] - Prefetch Factor: 4
[2025-08-13 22:07:48,350][__main__][INFO] - Persistent Workers: True
[2025-08-13 22:07:48,350][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/bb
[2025-08-13 22:07:48,353][__main__][INFO] - W&B logging disabled in config
[2025-08-13 22:07:48,972][__main__][INFO] - === AUTO-TUNING BATCH SIZE (RANK 0) ===
[2025-08-13 22:07:50,643][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[6], p=0.5, batch_size=2
[2025-08-13 22:09:16,531][__main__][INFO] - === STARTING EXPERIMENT: bb ===
[2025-08-13 22:09:16,531][__main__][INFO] - PID: 545417
[2025-08-13 22:09:16,531][__main__][INFO] - SLURM_JOB_ID: 30057267
[2025-08-13 22:09:16,531][__main__][INFO] - NODE_RANK: unknown
[2025-08-13 22:09:16,531][__main__][INFO] - WORLD_SIZE: unknown
[2025-08-13 22:09:16,531][__main__][INFO] - MASTER_ADDR: unknown
[2025-08-13 22:09:16,531][__main__][INFO] - MASTER_PORT: unknown
[2025-08-13 22:09:16,531][__main__][INFO] - SLURM_NODEID: 0
[2025-08-13 22:09:16,531][__main__][INFO] - SLURM_NNODES: 1
[2025-08-13 22:09:16,532][__main__][INFO] - SLURM_NODELIST: holygpu7c26106
[2025-08-13 22:09:16,532][__main__][INFO] - Architecture: rgcn50
[2025-08-13 22:09:16,532][__main__][INFO] - Embedding Dim: 64
[2025-08-13 22:09:16,532][__main__][INFO] - Learning Rate: 0.0003
[2025-08-13 22:09:16,532][__main__][INFO] - Weight Decay: 0.0
[2025-08-13 22:09:16,532][__main__][INFO] - Optimizer: schedulefree
[2025-08-13 22:09:16,532][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-13 22:09:16,532][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-13 22:09:16,532][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-13 22:09:16,532][__main__][INFO] - Channel Multipliers: [2, 4, 8, 16]
[2025-08-13 22:09:17,154][__main__][INFO] - Num Relations: 66
[2025-08-13 22:09:17,154][__main__][INFO] - Num Logical Qubits: 12
[2025-08-13 22:09:17,155][__main__][INFO] - Dataset: code_type=bivariate_bicycle, l=6, m=6, rounds_list=[6], p=0.5
[2025-08-13 22:09:17,155][__main__][INFO] - Standard training (no curriculum)
[2025-08-13 22:09:17,155][__main__][INFO] - Accelerator: auto
[2025-08-13 22:09:17,155][__main__][INFO] - Devices per node: auto
[2025-08-13 22:09:17,155][__main__][INFO] - Num Nodes: 1
[2025-08-13 22:09:17,155][__main__][INFO] - Total Devices: 1
[2025-08-13 22:09:17,155][__main__][INFO] - Strategy: auto
[2025-08-13 22:09:17,155][__main__][INFO] - Sync BatchNorm: True
[2025-08-13 22:09:17,155][__main__][INFO] - MWPM filtering: False
[2025-08-13 22:09:17,155][__main__][INFO] - Batch Size: auto-tuned
[2025-08-13 22:09:17,156][__main__][INFO] - Precision: bf16-mixed
[2025-08-13 22:09:17,156][__main__][INFO] - Max Steps: 50000
[2025-08-13 22:09:17,156][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-13 22:09:17,156][__main__][INFO] - Log every 100 steps
[2025-08-13 22:09:17,156][__main__][INFO] - Num Workers: 8
[2025-08-13 22:09:17,156][__main__][INFO] - Prefetch Factor: 4
[2025-08-13 22:09:17,156][__main__][INFO] - Persistent Workers: True
[2025-08-13 22:09:17,156][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/bb
[2025-08-13 22:09:17,160][__main__][INFO] - W&B logging disabled in config
[2025-08-13 22:09:17,772][__main__][INFO] - === AUTO-TUNING BATCH SIZE (RANK 0) ===
[2025-08-13 22:09:19,435][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[6], p=0.5, batch_size=2
[2025-08-13 22:10:41,397][__main__][INFO] - === STARTING EXPERIMENT: bb ===
[2025-08-13 22:10:41,397][__main__][INFO] - PID: 545589
[2025-08-13 22:10:41,397][__main__][INFO] - SLURM_JOB_ID: 30057267
[2025-08-13 22:10:41,397][__main__][INFO] - NODE_RANK: unknown
[2025-08-13 22:10:41,398][__main__][INFO] - WORLD_SIZE: unknown
[2025-08-13 22:10:41,398][__main__][INFO] - MASTER_ADDR: unknown
[2025-08-13 22:10:41,398][__main__][INFO] - MASTER_PORT: unknown
[2025-08-13 22:10:41,398][__main__][INFO] - SLURM_NODEID: 0
[2025-08-13 22:10:41,398][__main__][INFO] - SLURM_NNODES: 1
[2025-08-13 22:10:41,398][__main__][INFO] - SLURM_NODELIST: holygpu7c26106
[2025-08-13 22:10:41,398][__main__][INFO] - Architecture: rgcn50
[2025-08-13 22:10:41,398][__main__][INFO] - Embedding Dim: 64
[2025-08-13 22:10:41,398][__main__][INFO] - Learning Rate: 0.0003
[2025-08-13 22:10:41,398][__main__][INFO] - Weight Decay: 0.0
[2025-08-13 22:10:41,398][__main__][INFO] - Optimizer: schedulefree
[2025-08-13 22:10:41,398][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-13 22:10:41,398][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-13 22:10:41,398][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-13 22:10:41,398][__main__][INFO] - Channel Multipliers: [2, 4, 8, 16]
[2025-08-13 22:10:42,019][__main__][INFO] - Num Relations: 66
[2025-08-13 22:10:42,019][__main__][INFO] - Num Logical Qubits: 12
[2025-08-13 22:10:42,019][__main__][INFO] - Dataset: code_type=bivariate_bicycle, l=6, m=6, rounds_list=[6], p=0.5
[2025-08-13 22:10:42,019][__main__][INFO] - Standard training (no curriculum)
[2025-08-13 22:10:42,019][__main__][INFO] - Accelerator: auto
[2025-08-13 22:10:42,020][__main__][INFO] - Devices per node: auto
[2025-08-13 22:10:42,020][__main__][INFO] - Num Nodes: 1
[2025-08-13 22:10:42,020][__main__][INFO] - Total Devices: 1
[2025-08-13 22:10:42,020][__main__][INFO] - Strategy: auto
[2025-08-13 22:10:42,020][__main__][INFO] - Sync BatchNorm: True
[2025-08-13 22:10:42,020][__main__][INFO] - MWPM filtering: False
[2025-08-13 22:10:42,020][__main__][INFO] - Batch Size: auto-tuned
[2025-08-13 22:10:42,020][__main__][INFO] - Precision: bf16-mixed
[2025-08-13 22:10:42,020][__main__][INFO] - Max Steps: 50000
[2025-08-13 22:10:42,020][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-13 22:10:42,020][__main__][INFO] - Log every 100 steps
[2025-08-13 22:10:42,020][__main__][INFO] - Num Workers: 8
[2025-08-13 22:10:42,020][__main__][INFO] - Prefetch Factor: 4
[2025-08-13 22:10:42,021][__main__][INFO] - Persistent Workers: True
[2025-08-13 22:10:42,021][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/bb
[2025-08-13 22:10:42,029][__main__][INFO] - W&B logging disabled in config
[2025-08-13 22:10:42,641][__main__][INFO] - === AUTO-TUNING BATCH SIZE (RANK 0) ===
[2025-08-13 22:10:44,321][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[6], p=0.5, batch_size=2
[2025-08-13 22:13:12,755][__main__][INFO] - === STARTING EXPERIMENT: bb ===
[2025-08-13 22:13:12,755][__main__][INFO] - PID: 546092
[2025-08-13 22:13:12,755][__main__][INFO] - SLURM_JOB_ID: 30057267
[2025-08-13 22:13:12,755][__main__][INFO] - NODE_RANK: unknown
[2025-08-13 22:13:12,755][__main__][INFO] - WORLD_SIZE: unknown
[2025-08-13 22:13:12,755][__main__][INFO] - MASTER_ADDR: unknown
[2025-08-13 22:13:12,755][__main__][INFO] - MASTER_PORT: unknown
[2025-08-13 22:13:12,755][__main__][INFO] - SLURM_NODEID: 0
[2025-08-13 22:13:12,755][__main__][INFO] - SLURM_NNODES: 1
[2025-08-13 22:13:12,755][__main__][INFO] - SLURM_NODELIST: holygpu7c26106
[2025-08-13 22:13:12,756][__main__][INFO] - Architecture: rgcn50
[2025-08-13 22:13:12,756][__main__][INFO] - Embedding Dim: 64
[2025-08-13 22:13:12,756][__main__][INFO] - Learning Rate: 0.0003
[2025-08-13 22:13:12,756][__main__][INFO] - Weight Decay: 0.0
[2025-08-13 22:13:12,756][__main__][INFO] - Optimizer: schedulefree
[2025-08-13 22:13:12,756][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-13 22:13:12,756][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-13 22:13:12,756][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-13 22:13:12,756][__main__][INFO] - Channel Multipliers: [2, 4, 8, 16]
[2025-08-13 22:13:13,388][__main__][INFO] - Num Relations: 66
[2025-08-13 22:13:13,388][__main__][INFO] - Num Logical Qubits: 12
[2025-08-13 22:13:13,388][__main__][INFO] - Dataset: code_type=bivariate_bicycle, l=6, m=6, rounds_list=[6], p=0.5
[2025-08-13 22:13:13,388][__main__][INFO] - Standard training (no curriculum)
[2025-08-13 22:13:13,388][__main__][INFO] - Accelerator: auto
[2025-08-13 22:13:13,389][__main__][INFO] - Devices per node: auto
[2025-08-13 22:13:13,389][__main__][INFO] - Num Nodes: 1
[2025-08-13 22:13:13,389][__main__][INFO] - Total Devices: 1
[2025-08-13 22:13:13,389][__main__][INFO] - Strategy: auto
[2025-08-13 22:13:13,389][__main__][INFO] - Sync BatchNorm: True
[2025-08-13 22:13:13,389][__main__][INFO] - MWPM filtering: False
[2025-08-13 22:13:13,389][__main__][INFO] - Batch Size: auto-tuned
[2025-08-13 22:13:13,389][__main__][INFO] - Precision: bf16-mixed
[2025-08-13 22:13:13,389][__main__][INFO] - Max Steps: 50000
[2025-08-13 22:13:13,389][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-13 22:13:13,389][__main__][INFO] - Log every 100 steps
[2025-08-13 22:13:13,389][__main__][INFO] - Num Workers: 8
[2025-08-13 22:13:13,389][__main__][INFO] - Prefetch Factor: 4
[2025-08-13 22:13:13,389][__main__][INFO] - Persistent Workers: True
[2025-08-13 22:13:13,390][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/bb
[2025-08-13 22:13:13,394][__main__][INFO] - W&B logging disabled in config
[2025-08-13 22:13:14,004][__main__][INFO] - === AUTO-TUNING BATCH SIZE (RANK 0) ===
[2025-08-13 22:13:15,677][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[6], p=0.5, batch_size=2
[2025-08-13 22:14:50,286][__main__][INFO] - === STARTING EXPERIMENT: bb ===
[2025-08-13 22:14:50,286][__main__][INFO] - PID: 547047
[2025-08-13 22:14:50,286][__main__][INFO] - SLURM_JOB_ID: 30057267
[2025-08-13 22:14:50,286][__main__][INFO] - NODE_RANK: unknown
[2025-08-13 22:14:50,287][__main__][INFO] - WORLD_SIZE: unknown
[2025-08-13 22:14:50,287][__main__][INFO] - MASTER_ADDR: unknown
[2025-08-13 22:14:50,287][__main__][INFO] - MASTER_PORT: unknown
[2025-08-13 22:14:50,287][__main__][INFO] - SLURM_NODEID: 0
[2025-08-13 22:14:50,287][__main__][INFO] - SLURM_NNODES: 1
[2025-08-13 22:14:50,287][__main__][INFO] - SLURM_NODELIST: holygpu7c26106
[2025-08-13 22:14:50,287][__main__][INFO] - Architecture: rgcn50
[2025-08-13 22:14:50,287][__main__][INFO] - Embedding Dim: 64
[2025-08-13 22:14:50,287][__main__][INFO] - Learning Rate: 0.0003
[2025-08-13 22:14:50,287][__main__][INFO] - Weight Decay: 0.0
[2025-08-13 22:14:50,287][__main__][INFO] - Optimizer: schedulefree
[2025-08-13 22:14:50,287][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-13 22:14:50,287][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-13 22:14:50,287][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-13 22:14:50,288][__main__][INFO] - Channel Multipliers: [2, 4, 8, 16]
[2025-08-13 22:14:50,906][__main__][INFO] - Num Relations: 66
[2025-08-13 22:14:50,906][__main__][INFO] - Num Logical Qubits: 12
[2025-08-13 22:14:50,906][__main__][INFO] - Dataset: code_type=bivariate_bicycle, l=6, m=6, rounds_list=[6], p=0.5
[2025-08-13 22:14:50,906][__main__][INFO] - Standard training (no curriculum)
[2025-08-13 22:14:50,906][__main__][INFO] - Accelerator: auto
[2025-08-13 22:14:50,907][__main__][INFO] - Devices per node: auto
[2025-08-13 22:14:50,907][__main__][INFO] - Num Nodes: 1
[2025-08-13 22:14:50,907][__main__][INFO] - Total Devices: 1
[2025-08-13 22:14:50,907][__main__][INFO] - Strategy: auto
[2025-08-13 22:14:50,907][__main__][INFO] - Sync BatchNorm: True
[2025-08-13 22:14:50,907][__main__][INFO] - MWPM filtering: False
[2025-08-13 22:14:50,907][__main__][INFO] - Batch Size: auto-tuned
[2025-08-13 22:14:50,907][__main__][INFO] - Precision: bf16-mixed
[2025-08-13 22:14:50,907][__main__][INFO] - Max Steps: 50000
[2025-08-13 22:14:50,907][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-13 22:14:50,907][__main__][INFO] - Log every 100 steps
[2025-08-13 22:14:50,907][__main__][INFO] - Num Workers: 8
[2025-08-13 22:14:50,907][__main__][INFO] - Prefetch Factor: 4
[2025-08-13 22:14:50,908][__main__][INFO] - Persistent Workers: True
[2025-08-13 22:14:50,908][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/bb
[2025-08-13 22:14:50,911][__main__][INFO] - W&B logging disabled in config
[2025-08-13 22:14:51,526][__main__][INFO] - === AUTO-TUNING BATCH SIZE (RANK 0) ===
[2025-08-13 22:14:53,198][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[6], p=0.5, batch_size=2
[2025-08-13 22:14:56,348][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[6], p=0.5, batch_size=4
[2025-08-13 22:14:58,024][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[6], p=0.5, batch_size=8
[2025-08-13 22:14:59,841][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[6], p=0.5, batch_size=16
[2025-08-13 22:15:01,907][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[6], p=0.5, batch_size=32
[2025-08-13 22:15:04,514][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[6], p=0.5, batch_size=64
[2025-08-13 22:15:08,222][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[6], p=0.5, batch_size=128
[2025-08-13 22:15:09,717][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[6], p=0.5, batch_size=96
[2025-08-13 22:15:14,941][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[6], p=0.5, batch_size=112
[2025-08-13 22:15:20,668][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[6], p=0.5, batch_size=120
[2025-08-13 22:15:26,725][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[6], p=0.5, batch_size=124
[2025-08-13 22:15:28,506][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[6], p=0.5, batch_size=122
[2025-08-13 22:15:34,720][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[6], p=0.5, batch_size=123
[2025-08-13 22:15:41,120][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[6], p=0.5, batch_size=123
[2025-08-13 22:15:42,968][__main__][INFO] - Model loaded from checkpoint at global step 0
[2025-08-13 22:15:43,084][__main__][INFO] - Found optimal batch size 123
[2025-08-13 22:15:43,088][__main__][INFO] - Saved batch size 104 to file
[2025-08-13 22:15:43,088][__main__][INFO] - Optimal per-GPU batch size found: 104
[2025-08-13 22:15:43,088][__main__][INFO] - Effective total batch size across 1 device(s) on 1 node(s) with 1 accumulation steps: 104
[2025-08-13 22:15:43,092][__main__][INFO] - Saved metadata: {'timestamp': 1755137743.0889492, 'slurm_job_id': '30057267', 'batch_size': 104, 'num_devices': 1, 'effective_batch_size': 104}
[2025-08-13 22:15:43,511][__main__][INFO] - === STARTING TRAINING ===
[2025-08-13 22:15:43,910][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[6], p=0.5, batch_size=104
[2025-08-13 22:29:36,566][__main__][INFO] - === STARTING EXPERIMENT: bb ===
[2025-08-13 22:29:36,566][__main__][INFO] - PID: 2838233
[2025-08-13 22:29:36,566][__main__][INFO] - SLURM_JOB_ID: 30058757
[2025-08-13 22:29:36,566][__main__][INFO] - NODE_RANK: unknown
[2025-08-13 22:29:36,566][__main__][INFO] - WORLD_SIZE: unknown
[2025-08-13 22:29:36,566][__main__][INFO] - MASTER_ADDR: unknown
[2025-08-13 22:29:36,566][__main__][INFO] - MASTER_PORT: unknown
[2025-08-13 22:29:36,566][__main__][INFO] - SLURM_NODEID: 0
[2025-08-13 22:29:36,566][__main__][INFO] - SLURM_NNODES: 1
[2025-08-13 22:29:36,566][__main__][INFO] - SLURM_NODELIST: holygpu7c26105
[2025-08-13 22:29:36,566][__main__][INFO] - Architecture: rgcn50
[2025-08-13 22:29:36,566][__main__][INFO] - Embedding Dim: 64
[2025-08-13 22:29:36,566][__main__][INFO] - Learning Rate: 0.0003
[2025-08-13 22:29:36,566][__main__][INFO] - Weight Decay: 0.0
[2025-08-13 22:29:36,567][__main__][INFO] - Optimizer: schedulefree
[2025-08-13 22:29:36,567][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-13 22:29:36,567][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-13 22:29:36,567][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-13 22:29:36,567][__main__][INFO] - Channel Multipliers: [2, 4, 8, 16]
[2025-08-13 22:29:37,225][__main__][INFO] - Num Relations: 66
[2025-08-13 22:29:37,225][__main__][INFO] - Num Logical Qubits: 12
[2025-08-13 22:29:37,226][__main__][INFO] - Dataset: code_type=bivariate_bicycle, l=6, m=6, rounds_list=[2], p=0.5
[2025-08-13 22:29:37,226][__main__][INFO] - Standard training (no curriculum)
[2025-08-13 22:29:37,226][__main__][INFO] - Accelerator: auto
[2025-08-13 22:29:37,226][__main__][INFO] - Devices per node: auto
[2025-08-13 22:29:37,226][__main__][INFO] - Num Nodes: 1
[2025-08-13 22:29:37,226][__main__][INFO] - Total Devices: 1
[2025-08-13 22:29:37,226][__main__][INFO] - Strategy: auto
[2025-08-13 22:29:37,226][__main__][INFO] - Sync BatchNorm: True
[2025-08-13 22:29:37,226][__main__][INFO] - MWPM filtering: False
[2025-08-13 22:29:37,226][__main__][INFO] - Batch Size: auto-tuned
[2025-08-13 22:29:37,226][__main__][INFO] - Precision: bf16-mixed
[2025-08-13 22:29:37,226][__main__][INFO] - Max Steps: 50000
[2025-08-13 22:29:37,227][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-13 22:29:37,227][__main__][INFO] - Log every 100 steps
[2025-08-13 22:29:37,227][__main__][INFO] - Num Workers: 8
[2025-08-13 22:29:37,227][__main__][INFO] - Prefetch Factor: 4
[2025-08-13 22:29:37,227][__main__][INFO] - Persistent Workers: True
[2025-08-13 22:29:37,227][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/bb
[2025-08-13 22:29:37,241][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-13 22:29:37,241][__main__][INFO] - Initializing wandb logger with params
[2025-08-13 22:29:39,367][__main__][INFO] - Saved new W&B run ID to file: wlcggjv8
[2025-08-13 22:29:39,997][__main__][INFO] - === AUTO-TUNING BATCH SIZE (RANK 0) ===
[2025-08-13 22:29:41,670][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[2], p=0.5, batch_size=2
[2025-08-13 22:29:43,756][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[2], p=0.5, batch_size=4
[2025-08-13 22:29:45,358][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[2], p=0.5, batch_size=8
[2025-08-13 22:29:46,999][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[2], p=0.5, batch_size=16
[2025-08-13 22:29:48,676][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[2], p=0.5, batch_size=32
[2025-08-13 22:29:50,550][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[2], p=0.5, batch_size=64
[2025-08-13 22:29:52,847][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[2], p=0.5, batch_size=128
[2025-08-13 22:29:55,990][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[2], p=0.5, batch_size=256
[2025-08-13 22:30:00,810][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[2], p=0.5, batch_size=512
[2025-08-13 22:30:02,353][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[2], p=0.5, batch_size=384
[2025-08-13 22:30:03,904][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[2], p=0.5, batch_size=320
[2025-08-13 22:30:10,071][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[2], p=0.5, batch_size=352
[2025-08-13 22:30:11,666][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[2], p=0.5, batch_size=336
[2025-08-13 22:30:13,309][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[2], p=0.5, batch_size=328
[2025-08-13 22:30:14,918][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[2], p=0.5, batch_size=324
[2025-08-13 22:30:16,960][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[2], p=0.5, batch_size=322
[2025-08-13 22:30:19,035][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[2], p=0.5, batch_size=321
[2025-08-13 22:30:21,147][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[2], p=0.5, batch_size=320
[2025-08-13 22:30:22,020][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[2], p=0.5, batch_size=320
[2025-08-13 22:30:23,775][__main__][INFO] - Model loaded from checkpoint at global step 0
[2025-08-13 22:30:23,874][__main__][INFO] - Found optimal batch size 320
[2025-08-13 22:30:23,879][__main__][INFO] - Saved batch size 272 to file
[2025-08-13 22:30:23,879][__main__][INFO] - Optimal per-GPU batch size found: 272
[2025-08-13 22:30:23,880][__main__][INFO] - Effective total batch size across 1 device(s) on 1 node(s) with 1 accumulation steps: 272
[2025-08-13 22:30:23,884][__main__][INFO] - Saved metadata: {'timestamp': 1755138623.8803046, 'slurm_job_id': '30058757', 'batch_size': 272, 'num_devices': 1, 'effective_batch_size': 272}
[2025-08-13 22:30:24,306][__main__][INFO] - === STARTING TRAINING ===
[2025-08-13 22:30:24,701][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[2], p=0.5, batch_size=272
[2025-08-13 22:31:11,829][__main__][INFO] - === STARTING EXPERIMENT: d11-curriculum ===
[2025-08-13 22:31:11,831][__main__][INFO] - PID: 2373204
[2025-08-13 22:31:11,831][__main__][INFO] - SLURM_JOB_ID: 30051868
[2025-08-13 22:31:11,831][__main__][INFO] - NODE_RANK: unknown
[2025-08-13 22:31:11,831][__main__][INFO] - WORLD_SIZE: unknown
[2025-08-13 22:31:11,831][__main__][INFO] - MASTER_ADDR: unknown
[2025-08-13 22:31:11,831][__main__][INFO] - MASTER_PORT: unknown
[2025-08-13 22:31:11,831][__main__][INFO] - SLURM_NODEID: 0
[2025-08-13 22:31:11,831][__main__][INFO] - SLURM_NNODES: 1
[2025-08-13 22:31:11,831][__main__][INFO] - SLURM_NODELIST: holygpu8a26506
[2025-08-13 22:31:11,831][__main__][INFO] - Architecture: resnet50
[2025-08-13 22:31:11,831][__main__][INFO] - Embedding Dim: 128
[2025-08-13 22:31:11,832][__main__][INFO] - Learning Rate: 0.0004
[2025-08-13 22:31:11,832][__main__][INFO] - Weight Decay: 0.0
[2025-08-13 22:31:11,832][__main__][INFO] - Optimizer: schedulefree
[2025-08-13 22:31:11,832][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-13 22:31:11,832][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-13 22:31:11,832][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-13 22:31:11,832][__main__][INFO] - Channel Multipliers: [2, 2.5, 3, 3.5]
[2025-08-13 22:31:11,832][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-13 22:31:11,832][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-13 22:31:11,832][__main__][INFO] - Use LSTM: False
[2025-08-13 22:31:11,833][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-13 22:31:11,833][__main__][INFO] - Dataset: code_type=surface_code, d=11, rounds_list=[11], p=2.1
[2025-08-13 22:31:11,833][__main__][INFO] - === 3-STAGE CURRICULUM LEARNING ENABLED ===
[2025-08-13 22:31:11,833][__main__][INFO] - Stage 1: p=0.5 for 40000 steps
[2025-08-13 22:31:11,833][__main__][INFO] - Stage 2: p=0.5→2.1 over 50000 steps
[2025-08-13 22:31:11,833][__main__][INFO] - Stage 3: p=2.1 for 20000 steps
[2025-08-13 22:31:11,833][__main__][INFO] - Total curriculum steps: 110000
[2025-08-13 22:31:11,833][__main__][INFO] - Accelerator: auto
[2025-08-13 22:31:11,834][__main__][INFO] - Devices per node: 2
[2025-08-13 22:31:11,834][__main__][INFO] - Num Nodes: 1
[2025-08-13 22:31:11,834][__main__][INFO] - Total Devices: 2
[2025-08-13 22:31:11,834][__main__][INFO] - Strategy: auto
[2025-08-13 22:31:11,834][__main__][INFO] - Sync BatchNorm: True
[2025-08-13 22:31:11,834][__main__][INFO] - MWPM filtering: False
[2025-08-13 22:31:11,834][__main__][INFO] - Batch Size: auto-tuned
[2025-08-13 22:31:11,834][__main__][INFO] - Precision: bf16-mixed
[2025-08-13 22:31:11,834][__main__][INFO] - Max Steps: 110000 (curriculum override)
[2025-08-13 22:31:11,834][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-13 22:31:11,834][__main__][INFO] - Log every 100 steps
[2025-08-13 22:31:11,835][__main__][INFO] - Num Workers: 6
[2025-08-13 22:31:11,835][__main__][INFO] - Prefetch Factor: 4
[2025-08-13 22:31:11,835][__main__][INFO] - Persistent Workers: True
[2025-08-13 22:31:11,835][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d11-curriculum
[2025-08-13 22:31:11,849][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-13 22:31:11,850][__main__][INFO] - Initializing wandb logger with params
[2025-08-13 22:31:14,412][__main__][INFO] - Saved new W&B run ID to file: qg1y59ht
[2025-08-13 22:31:14,413][stage_manager][INFO] - Initialized 3-stage curriculum learning:
[2025-08-13 22:31:14,413][stage_manager][INFO] -   Stage 1: p=0.5 for 40000 steps
[2025-08-13 22:31:14,413][stage_manager][INFO] -   Stage 2: p=0.5→2.1 over 50000 steps
[2025-08-13 22:31:14,414][stage_manager][INFO] -   Stage 3: p=2.1 for 20000 steps
[2025-08-13 22:31:14,414][stage_manager][INFO] -   Total steps: 110000
[2025-08-13 22:31:14,509][__main__][INFO] - === AUTO-TUNING BATCH SIZE (RANK 0) ===
[2025-08-13 22:31:15,353][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=2
[2025-08-13 22:31:15,353][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 22:31:18,274][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=4
[2025-08-13 22:31:18,274][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 22:31:19,686][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=8
[2025-08-13 22:31:19,686][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 22:31:21,234][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=16
[2025-08-13 22:31:21,234][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 22:31:22,862][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=32
[2025-08-13 22:31:22,862][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 22:31:24,376][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=64
[2025-08-13 22:31:24,376][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 22:31:26,143][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=128
[2025-08-13 22:31:26,144][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 22:31:28,273][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=256
[2025-08-13 22:31:28,274][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 22:31:31,233][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=512
[2025-08-13 22:31:31,234][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 22:31:35,626][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=1024
[2025-08-13 22:31:35,627][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 22:31:38,073][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=768
[2025-08-13 22:31:38,073][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 22:31:43,723][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=896
[2025-08-13 22:31:43,723][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 22:31:46,508][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=832
[2025-08-13 22:31:46,508][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 22:31:52,556][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=864
[2025-08-13 22:31:52,557][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 22:31:55,092][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=848
[2025-08-13 22:31:55,092][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 22:31:57,916][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=840
[2025-08-13 22:31:57,916][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 22:32:04,066][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=844
[2025-08-13 22:32:04,067][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 22:32:06,373][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=842
[2025-08-13 22:32:06,373][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 22:32:12,551][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=843
[2025-08-13 22:32:12,552][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 22:32:19,445][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=843
[2025-08-13 22:32:19,448][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 22:32:20,489][__main__][INFO] - Model loaded from checkpoint at global step 0
[2025-08-13 22:32:20,734][__main__][INFO] - Found optimal batch size 843
[2025-08-13 22:32:20,744][__main__][INFO] - Saved batch size 716 to file
[2025-08-13 22:32:20,744][__main__][INFO] - Optimal per-GPU batch size found: 716
[2025-08-13 22:32:20,744][__main__][INFO] - Effective total batch size across 2 device(s) on 1 node(s) with 1 accumulation steps: 1432
[2025-08-13 22:32:20,749][__main__][INFO] - Saved metadata: {'timestamp': 1755138740.7448056, 'slurm_job_id': '30051868', 'batch_size': 716, 'num_devices': 2, 'effective_batch_size': 1432}
[2025-08-13 22:32:21,198][__main__][INFO] - === STARTING TRAINING ===
[2025-08-13 22:33:24,145][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=716
[2025-08-13 22:33:24,148][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-13 22:38:34,679][__main__][INFO] - === STARTING EXPERIMENT: d15-curriculum ===
[2025-08-13 22:38:34,680][__main__][INFO] - PID: 2982101
[2025-08-13 22:38:34,680][__main__][INFO] - SLURM_JOB_ID: 30051885
[2025-08-13 22:38:34,680][__main__][INFO] - NODE_RANK: unknown
[2025-08-13 22:38:34,680][__main__][INFO] - WORLD_SIZE: unknown
[2025-08-13 22:38:34,680][__main__][INFO] - MASTER_ADDR: unknown
[2025-08-13 22:38:34,680][__main__][INFO] - MASTER_PORT: unknown
[2025-08-13 22:38:34,681][__main__][INFO] - SLURM_NODEID: 0
[2025-08-13 22:38:34,681][__main__][INFO] - SLURM_NNODES: 1
[2025-08-13 22:38:34,681][__main__][INFO] - SLURM_NODELIST: holygpu8a26505
[2025-08-13 22:38:34,681][__main__][INFO] - Architecture: resnet50
[2025-08-13 22:38:34,681][__main__][INFO] - Embedding Dim: 128
[2025-08-13 22:38:34,681][__main__][INFO] - Learning Rate: 0.0004
[2025-08-13 22:38:34,681][__main__][INFO] - Weight Decay: 0.0
[2025-08-13 22:38:34,681][__main__][INFO] - Optimizer: schedulefree
[2025-08-13 22:38:34,681][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-13 22:38:34,681][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-13 22:38:34,681][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-13 22:38:34,682][__main__][INFO] - Channel Multipliers: [2, 2.5, 3, 3.5]
[2025-08-13 22:38:34,682][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-13 22:38:34,682][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-13 22:38:34,682][__main__][INFO] - Use LSTM: False
[2025-08-13 22:38:34,682][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-13 22:38:34,682][__main__][INFO] - Dataset: code_type=surface_code, d=15, rounds_list=[15], p=2.1
[2025-08-13 22:38:34,682][__main__][INFO] - === 3-STAGE CURRICULUM LEARNING ENABLED ===
[2025-08-13 22:38:34,682][__main__][INFO] - Stage 1: p=0.5 for 50000 steps
[2025-08-13 22:38:34,682][__main__][INFO] - Stage 2: p=0.5→2.1 over 50000 steps
[2025-08-13 22:38:34,683][__main__][INFO] - Stage 3: p=2.1 for 200000 steps
[2025-08-13 22:38:34,683][__main__][INFO] - Total curriculum steps: 300000
[2025-08-13 22:38:34,683][__main__][INFO] - Accelerator: auto
[2025-08-13 22:38:34,683][__main__][INFO] - Devices per node: 4
[2025-08-13 22:38:34,683][__main__][INFO] - Num Nodes: 1
[2025-08-13 22:38:34,683][__main__][INFO] - Total Devices: 4
[2025-08-13 22:38:34,683][__main__][INFO] - Strategy: auto
[2025-08-13 22:38:34,683][__main__][INFO] - Sync BatchNorm: True
[2025-08-13 22:38:34,683][__main__][INFO] - MWPM filtering: False
[2025-08-13 22:38:34,683][__main__][INFO] - Batch Size: auto-tuned
[2025-08-13 22:38:34,684][__main__][INFO] - Precision: bf16-mixed
[2025-08-13 22:38:34,684][__main__][INFO] - Max Steps: 300000 (curriculum override)
[2025-08-13 22:38:34,684][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-13 22:38:34,684][__main__][INFO] - Log every 100 steps
[2025-08-13 22:38:34,684][__main__][INFO] - Num Workers: 7
[2025-08-13 22:38:34,684][__main__][INFO] - Prefetch Factor: 4
[2025-08-13 22:38:34,684][__main__][INFO] - Persistent Workers: True
[2025-08-13 22:38:34,684][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d15-curriculum
[2025-08-13 22:38:34,694][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-13 22:38:34,695][__main__][INFO] - Initializing wandb logger with params
[2025-08-13 23:36:10,887][__main__][INFO] - === STARTING EXPERIMENT: bb ===
[2025-08-13 23:36:10,887][__main__][INFO] - PID: 2860507
[2025-08-13 23:36:10,887][__main__][INFO] - SLURM_JOB_ID: 30058757
[2025-08-13 23:36:10,887][__main__][INFO] - NODE_RANK: unknown
[2025-08-13 23:36:10,887][__main__][INFO] - WORLD_SIZE: unknown
[2025-08-13 23:36:10,887][__main__][INFO] - MASTER_ADDR: unknown
[2025-08-13 23:36:10,887][__main__][INFO] - MASTER_PORT: unknown
[2025-08-13 23:36:10,887][__main__][INFO] - SLURM_NODEID: 0
[2025-08-13 23:36:10,887][__main__][INFO] - SLURM_NNODES: 1
[2025-08-13 23:36:10,887][__main__][INFO] - SLURM_NODELIST: holygpu7c26105
[2025-08-13 23:36:10,888][__main__][INFO] - Architecture: rgcn50
[2025-08-13 23:36:10,888][__main__][INFO] - Embedding Dim: 64
[2025-08-13 23:36:10,888][__main__][INFO] - Learning Rate: 0.0003
[2025-08-13 23:36:10,888][__main__][INFO] - Weight Decay: 0.0
[2025-08-13 23:36:10,888][__main__][INFO] - Optimizer: schedulefree
[2025-08-13 23:36:10,888][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-13 23:36:10,888][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-13 23:36:10,888][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-13 23:36:10,888][__main__][INFO] - Channel Multipliers: [2, 4, 8, 16]
[2025-08-13 23:36:11,517][__main__][INFO] - Num Relations: 66
[2025-08-13 23:36:11,517][__main__][INFO] - Num Logical Qubits: 12
[2025-08-13 23:36:11,517][__main__][INFO] - Dataset: code_type=bivariate_bicycle, l=6, m=6, rounds_list=[2], p=0.5
[2025-08-13 23:36:11,517][__main__][INFO] - Standard training (no curriculum)
[2025-08-13 23:36:11,517][__main__][INFO] - Accelerator: auto
[2025-08-13 23:36:11,517][__main__][INFO] - Devices per node: auto
[2025-08-13 23:36:11,517][__main__][INFO] - Num Nodes: 1
[2025-08-13 23:36:11,517][__main__][INFO] - Total Devices: 1
[2025-08-13 23:36:11,518][__main__][INFO] - Strategy: auto
[2025-08-13 23:36:11,518][__main__][INFO] - Sync BatchNorm: True
[2025-08-13 23:36:11,518][__main__][INFO] - MWPM filtering: False
[2025-08-13 23:36:11,518][__main__][INFO] - Batch Size: auto-tuned
[2025-08-13 23:36:11,518][__main__][INFO] - Precision: bf16-mixed
[2025-08-13 23:36:11,518][__main__][INFO] - Max Steps: 50000
[2025-08-13 23:36:11,518][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-13 23:36:11,518][__main__][INFO] - Log every 100 steps
[2025-08-13 23:36:11,518][__main__][INFO] - Num Workers: 8
[2025-08-13 23:36:11,518][__main__][INFO] - Prefetch Factor: 4
[2025-08-13 23:36:11,518][__main__][INFO] - Persistent Workers: True
[2025-08-13 23:36:11,518][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/bb
[2025-08-13 23:36:11,533][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-13 23:36:11,533][__main__][INFO] - Initializing wandb logger with params
[2025-08-13 23:36:13,635][__main__][INFO] - Saved new W&B run ID to file: mtyrf8p4
[2025-08-13 23:36:14,270][__main__][INFO] - === AUTO-TUNING BATCH SIZE (RANK 0) ===
[2025-08-13 23:36:16,257][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[2], p=0.5, batch_size=2
[2025-08-13 23:37:33,896][__main__][INFO] - === STARTING EXPERIMENT: bb ===
[2025-08-13 23:37:33,896][__main__][INFO] - PID: 2861057
[2025-08-13 23:37:33,896][__main__][INFO] - SLURM_JOB_ID: 30058757
[2025-08-13 23:37:33,896][__main__][INFO] - NODE_RANK: unknown
[2025-08-13 23:37:33,896][__main__][INFO] - WORLD_SIZE: unknown
[2025-08-13 23:37:33,896][__main__][INFO] - MASTER_ADDR: unknown
[2025-08-13 23:37:33,896][__main__][INFO] - MASTER_PORT: unknown
[2025-08-13 23:37:33,897][__main__][INFO] - SLURM_NODEID: 0
[2025-08-13 23:37:33,897][__main__][INFO] - SLURM_NNODES: 1
[2025-08-13 23:37:33,897][__main__][INFO] - SLURM_NODELIST: holygpu7c26105
[2025-08-13 23:37:33,897][__main__][INFO] - Architecture: rgcn50
[2025-08-13 23:37:33,897][__main__][INFO] - Embedding Dim: 64
[2025-08-13 23:37:33,897][__main__][INFO] - Learning Rate: 0.0003
[2025-08-13 23:37:33,897][__main__][INFO] - Weight Decay: 0.0
[2025-08-13 23:37:33,897][__main__][INFO] - Optimizer: schedulefree
[2025-08-13 23:37:33,897][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-13 23:37:33,897][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-13 23:37:33,897][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-13 23:37:33,897][__main__][INFO] - Channel Multipliers: [2, 4, 8, 16]
[2025-08-13 23:37:34,513][__main__][INFO] - Num Relations: 66
[2025-08-13 23:37:34,513][__main__][INFO] - Num Logical Qubits: 12
[2025-08-13 23:37:34,513][__main__][INFO] - Dataset: code_type=bivariate_bicycle, l=6, m=6, rounds_list=[2], p=0.5
[2025-08-13 23:37:34,513][__main__][INFO] - Standard training (no curriculum)
[2025-08-13 23:37:34,513][__main__][INFO] - Accelerator: auto
[2025-08-13 23:37:34,513][__main__][INFO] - Devices per node: auto
[2025-08-13 23:37:34,513][__main__][INFO] - Num Nodes: 1
[2025-08-13 23:37:34,514][__main__][INFO] - Total Devices: 1
[2025-08-13 23:37:34,514][__main__][INFO] - Strategy: auto
[2025-08-13 23:37:34,514][__main__][INFO] - Sync BatchNorm: True
[2025-08-13 23:37:34,514][__main__][INFO] - MWPM filtering: False
[2025-08-13 23:37:34,514][__main__][INFO] - Batch Size: auto-tuned
[2025-08-13 23:37:34,514][__main__][INFO] - Precision: bf16-mixed
[2025-08-13 23:37:34,514][__main__][INFO] - Max Steps: 50000
[2025-08-13 23:37:34,514][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-13 23:37:34,514][__main__][INFO] - Log every 100 steps
[2025-08-13 23:37:34,514][__main__][INFO] - Num Workers: 8
[2025-08-13 23:37:34,514][__main__][INFO] - Prefetch Factor: 4
[2025-08-13 23:37:34,514][__main__][INFO] - Persistent Workers: True
[2025-08-13 23:37:34,514][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/bb
[2025-08-13 23:37:34,528][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-13 23:37:34,529][__main__][INFO] - Initializing wandb logger with params
[2025-08-13 23:37:36,490][__main__][INFO] - Saved new W&B run ID to file: i1vbse2o
[2025-08-13 23:37:37,106][__main__][INFO] - === AUTO-TUNING BATCH SIZE (RANK 0) ===
[2025-08-13 23:37:38,780][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[2], p=0.5, batch_size=2
[2025-08-13 23:38:58,868][__main__][INFO] - === STARTING EXPERIMENT: bb ===
[2025-08-13 23:38:58,869][__main__][INFO] - PID: 2861450
[2025-08-13 23:38:58,869][__main__][INFO] - SLURM_JOB_ID: 30058757
[2025-08-13 23:38:58,869][__main__][INFO] - NODE_RANK: unknown
[2025-08-13 23:38:58,869][__main__][INFO] - WORLD_SIZE: unknown
[2025-08-13 23:38:58,869][__main__][INFO] - MASTER_ADDR: unknown
[2025-08-13 23:38:58,869][__main__][INFO] - MASTER_PORT: unknown
[2025-08-13 23:38:58,869][__main__][INFO] - SLURM_NODEID: 0
[2025-08-13 23:38:58,869][__main__][INFO] - SLURM_NNODES: 1
[2025-08-13 23:38:58,869][__main__][INFO] - SLURM_NODELIST: holygpu7c26105
[2025-08-13 23:38:58,869][__main__][INFO] - Architecture: rgcn50
[2025-08-13 23:38:58,869][__main__][INFO] - Embedding Dim: 64
[2025-08-13 23:38:58,869][__main__][INFO] - Learning Rate: 0.0003
[2025-08-13 23:38:58,869][__main__][INFO] - Weight Decay: 0.0
[2025-08-13 23:38:58,869][__main__][INFO] - Optimizer: schedulefree
[2025-08-13 23:38:58,869][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-13 23:38:58,870][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-13 23:38:58,870][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-13 23:38:58,870][__main__][INFO] - Channel Multipliers: [2, 4, 8, 16]
[2025-08-13 23:38:59,497][__main__][INFO] - Num Relations: 66
[2025-08-13 23:38:59,497][__main__][INFO] - Num Logical Qubits: 12
[2025-08-13 23:38:59,497][__main__][INFO] - Dataset: code_type=bivariate_bicycle, l=6, m=6, rounds_list=[2], p=0.5
[2025-08-13 23:38:59,497][__main__][INFO] - Standard training (no curriculum)
[2025-08-13 23:38:59,498][__main__][INFO] - Accelerator: auto
[2025-08-13 23:38:59,498][__main__][INFO] - Devices per node: auto
[2025-08-13 23:38:59,498][__main__][INFO] - Num Nodes: 1
[2025-08-13 23:38:59,498][__main__][INFO] - Total Devices: 1
[2025-08-13 23:38:59,498][__main__][INFO] - Strategy: auto
[2025-08-13 23:38:59,498][__main__][INFO] - Sync BatchNorm: True
[2025-08-13 23:38:59,498][__main__][INFO] - MWPM filtering: False
[2025-08-13 23:38:59,498][__main__][INFO] - Batch Size: auto-tuned
[2025-08-13 23:38:59,498][__main__][INFO] - Precision: bf16-mixed
[2025-08-13 23:38:59,498][__main__][INFO] - Max Steps: 50000
[2025-08-13 23:38:59,498][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-13 23:38:59,498][__main__][INFO] - Log every 100 steps
[2025-08-13 23:38:59,498][__main__][INFO] - Num Workers: 8
[2025-08-13 23:38:59,498][__main__][INFO] - Prefetch Factor: 4
[2025-08-13 23:38:59,499][__main__][INFO] - Persistent Workers: True
[2025-08-13 23:38:59,499][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/bb
[2025-08-13 23:38:59,515][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-13 23:38:59,516][__main__][INFO] - Initializing wandb logger with params
[2025-08-13 23:39:01,649][__main__][INFO] - Saved new W&B run ID to file: ujqw5xjf
[2025-08-13 23:39:02,267][__main__][INFO] - === AUTO-TUNING BATCH SIZE (RANK 0) ===
[2025-08-13 23:39:03,951][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[2], p=0.5, batch_size=2
[2025-08-13 23:39:05,902][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[2], p=0.5, batch_size=4
[2025-08-13 23:39:07,471][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[2], p=0.5, batch_size=8
[2025-08-13 23:39:09,077][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[2], p=0.5, batch_size=16
[2025-08-13 23:39:10,777][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[2], p=0.5, batch_size=32
[2025-08-13 23:39:12,668][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[2], p=0.5, batch_size=64
[2025-08-13 23:39:14,982][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[2], p=0.5, batch_size=128
[2025-08-13 23:39:18,112][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[2], p=0.5, batch_size=256
[2025-08-13 23:39:22,969][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[2], p=0.5, batch_size=512
[2025-08-13 23:39:24,534][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[2], p=0.5, batch_size=384
[2025-08-13 23:39:26,044][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[2], p=0.5, batch_size=320
[2025-08-13 23:39:32,163][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[2], p=0.5, batch_size=352
[2025-08-13 23:39:33,810][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[2], p=0.5, batch_size=336
[2025-08-13 23:39:35,463][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[2], p=0.5, batch_size=328
[2025-08-13 23:39:37,075][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[2], p=0.5, batch_size=324
[2025-08-13 23:39:39,165][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[2], p=0.5, batch_size=322
[2025-08-13 23:39:41,269][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[2], p=0.5, batch_size=321
[2025-08-13 23:39:43,362][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[2], p=0.5, batch_size=320
[2025-08-13 23:39:44,262][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[2], p=0.5, batch_size=320
[2025-08-13 23:39:46,025][__main__][INFO] - Model loaded from checkpoint at global step 0
[2025-08-13 23:39:46,131][__main__][INFO] - Found optimal batch size 320
[2025-08-13 23:39:46,136][__main__][INFO] - Saved batch size 272 to file
[2025-08-13 23:39:46,137][__main__][INFO] - Optimal per-GPU batch size found: 272
[2025-08-13 23:39:46,137][__main__][INFO] - Effective total batch size across 1 device(s) on 1 node(s) with 1 accumulation steps: 272
[2025-08-13 23:39:46,142][__main__][INFO] - Saved metadata: {'timestamp': 1755142786.1374044, 'slurm_job_id': '30058757', 'batch_size': 272, 'num_devices': 1, 'effective_batch_size': 272}
[2025-08-13 23:39:46,563][__main__][INFO] - === STARTING TRAINING ===
[2025-08-13 23:39:46,954][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[2], p=0.5, batch_size=272
[2025-08-13 23:58:40,626][__main__][INFO] - === STARTING EXPERIMENT: d11-curriculum ===
[2025-08-13 23:58:40,626][__main__][INFO] - PID: 484976
[2025-08-13 23:58:40,626][__main__][INFO] - SLURM_JOB_ID: 30051868
[2025-08-13 23:58:40,626][__main__][INFO] - NODE_RANK: unknown
[2025-08-13 23:58:40,626][__main__][INFO] - WORLD_SIZE: unknown
[2025-08-13 23:58:40,626][__main__][INFO] - MASTER_ADDR: unknown
[2025-08-13 23:58:40,626][__main__][INFO] - MASTER_PORT: unknown
[2025-08-13 23:58:40,627][__main__][INFO] - SLURM_NODEID: 0
[2025-08-13 23:58:40,627][__main__][INFO] - SLURM_NNODES: 1
[2025-08-13 23:58:40,627][__main__][INFO] - SLURM_NODELIST: holygpu8a17202
[2025-08-13 23:58:40,627][__main__][INFO] - Architecture: resnet50
[2025-08-13 23:58:40,627][__main__][INFO] - Embedding Dim: 128
[2025-08-13 23:58:40,627][__main__][INFO] - Learning Rate: 0.0004
[2025-08-13 23:58:40,627][__main__][INFO] - Weight Decay: 0.0
[2025-08-13 23:58:40,627][__main__][INFO] - Optimizer: schedulefree
[2025-08-13 23:58:40,627][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-13 23:58:40,627][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-13 23:58:40,627][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-13 23:58:40,627][__main__][INFO] - Channel Multipliers: [2, 2.5, 3, 3.5]
[2025-08-13 23:58:40,627][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-13 23:58:40,627][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-13 23:58:40,627][__main__][INFO] - Use LSTM: False
[2025-08-13 23:58:40,627][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-13 23:58:40,627][__main__][INFO] - Dataset: code_type=surface_code, d=11, rounds_list=[11], p=2.1
[2025-08-13 23:58:40,627][__main__][INFO] - === 3-STAGE CURRICULUM LEARNING ENABLED ===
[2025-08-13 23:58:40,627][__main__][INFO] - Stage 1: p=0.5 for 40000 steps
[2025-08-13 23:58:40,628][__main__][INFO] - Stage 2: p=0.5→2.1 over 50000 steps
[2025-08-13 23:58:40,628][__main__][INFO] - Stage 3: p=2.1 for 20000 steps
[2025-08-13 23:58:40,628][__main__][INFO] - Total curriculum steps: 110000
[2025-08-13 23:58:40,628][__main__][INFO] - Accelerator: auto
[2025-08-13 23:58:40,628][__main__][INFO] - Devices per node: 2
[2025-08-13 23:58:40,628][__main__][INFO] - Num Nodes: 1
[2025-08-13 23:58:40,628][__main__][INFO] - Total Devices: 2
[2025-08-13 23:58:40,628][__main__][INFO] - Strategy: auto
[2025-08-13 23:58:40,628][__main__][INFO] - Sync BatchNorm: True
[2025-08-13 23:58:40,628][__main__][INFO] - MWPM filtering: False
[2025-08-13 23:58:40,628][__main__][INFO] - Batch Size: auto-tuned
[2025-08-13 23:58:40,628][__main__][INFO] - Precision: bf16-mixed
[2025-08-13 23:58:40,628][__main__][INFO] - Max Steps: 110000 (curriculum override)
[2025-08-13 23:58:40,628][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-13 23:58:40,628][__main__][INFO] - Log every 100 steps
[2025-08-13 23:58:40,628][__main__][INFO] - Num Workers: 6
[2025-08-13 23:58:40,628][__main__][INFO] - Prefetch Factor: 4
[2025-08-13 23:58:40,628][__main__][INFO] - Persistent Workers: True
[2025-08-13 23:58:40,628][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d11-curriculum
[2025-08-13 23:58:40,642][__main__][INFO] - Loaded W&B run ID from file: qg1y59ht
[2025-08-13 23:58:40,643][__main__][INFO] - Setting up W&B logger with existing run ID: qg1y59ht
[2025-08-13 23:58:40,643][__main__][INFO] - Initializing wandb logger with params
[2025-08-13 23:58:40,651][stage_manager][INFO] - Initialized 3-stage curriculum learning:
[2025-08-13 23:58:40,651][stage_manager][INFO] -   Stage 1: p=0.5 for 40000 steps
[2025-08-13 23:58:40,651][stage_manager][INFO] -   Stage 2: p=0.5→2.1 over 50000 steps
[2025-08-13 23:58:40,651][stage_manager][INFO] -   Stage 3: p=2.1 for 20000 steps
[2025-08-13 23:58:40,651][stage_manager][INFO] -   Total steps: 110000
[2025-08-13 23:58:40,775][__main__][INFO] - Loaded batch size 716 from file
[2025-08-13 23:58:40,775][__main__][INFO] - Effective total batch size across 2 device(s) on 1 node(s) with 1 accumulation steps: 1432
[2025-08-13 23:58:40,781][__main__][INFO] - Saved metadata: {'timestamp': 1755143920.77585, 'slurm_job_id': '30051868', 'batch_size': 716, 'num_devices': 2, 'effective_batch_size': 1432}
[2025-08-13 23:58:48,574][__main__][INFO] - === STARTING TRAINING ===
[2025-08-13 23:59:45,519][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=716
[2025-08-13 23:59:45,521][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-14 00:46:37,641][__main__][INFO] - === STARTING EXPERIMENT: bb6-full ===
[2025-08-14 00:46:37,641][__main__][INFO] - PID: 592225
[2025-08-14 00:46:37,641][__main__][INFO] - SLURM_JOB_ID: 30091639
[2025-08-14 00:46:37,641][__main__][INFO] - NODE_RANK: unknown
[2025-08-14 00:46:37,641][__main__][INFO] - WORLD_SIZE: unknown
[2025-08-14 00:46:37,641][__main__][INFO] - MASTER_ADDR: unknown
[2025-08-14 00:46:37,641][__main__][INFO] - MASTER_PORT: unknown
[2025-08-14 00:46:37,641][__main__][INFO] - SLURM_NODEID: 0
[2025-08-14 00:46:37,641][__main__][INFO] - SLURM_NNODES: 1
[2025-08-14 00:46:37,641][__main__][INFO] - SLURM_NODELIST: holygpu7c26106
[2025-08-14 00:46:37,641][__main__][INFO] - Architecture: rgcn50
[2025-08-14 00:46:37,641][__main__][INFO] - Embedding Dim: 64
[2025-08-14 00:46:37,641][__main__][INFO] - Learning Rate: 0.001
[2025-08-14 00:46:37,641][__main__][INFO] - Weight Decay: 0.0
[2025-08-14 00:46:37,642][__main__][INFO] - Optimizer: schedulefree
[2025-08-14 00:46:37,642][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-14 00:46:37,642][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-14 00:46:37,642][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-14 00:46:37,642][__main__][INFO] - Channel Multipliers: [2, 4, 8, 16]
[2025-08-14 00:46:38,263][__main__][INFO] - Num Relations: 66
[2025-08-14 00:46:38,263][__main__][INFO] - Num Logical Qubits: 12
[2025-08-14 00:46:38,263][__main__][INFO] - Dataset: code_type=bivariate_bicycle, l=6, m=6, rounds_list=[7], p=0.75
[2025-08-14 00:46:38,264][__main__][INFO] - Standard training (no curriculum)
[2025-08-14 00:46:38,264][__main__][INFO] - Accelerator: auto
[2025-08-14 00:46:38,264][__main__][INFO] - Devices per node: auto
[2025-08-14 00:46:38,264][__main__][INFO] - Num Nodes: 1
[2025-08-14 00:46:38,264][__main__][INFO] - Total Devices: 1
[2025-08-14 00:46:38,264][__main__][INFO] - Strategy: auto
[2025-08-14 00:46:38,264][__main__][INFO] - Sync BatchNorm: True
[2025-08-14 00:46:38,264][__main__][INFO] - MWPM filtering: False
[2025-08-14 00:46:38,264][__main__][INFO] - Batch Size: auto-tuned
[2025-08-14 00:46:38,264][__main__][INFO] - Precision: bf16-mixed
[2025-08-14 00:46:38,264][__main__][INFO] - Max Steps: 50000
[2025-08-14 00:46:38,264][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-14 00:46:38,265][__main__][INFO] - Log every 100 steps
[2025-08-14 00:46:38,265][__main__][INFO] - Num Workers: 8
[2025-08-14 00:46:38,265][__main__][INFO] - Prefetch Factor: 4
[2025-08-14 00:46:38,265][__main__][INFO] - Persistent Workers: True
[2025-08-14 00:46:38,265][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/bb6-full
[2025-08-14 00:46:38,278][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-14 00:46:38,278][__main__][INFO] - Initializing wandb logger with params
[2025-08-14 00:46:46,379][__main__][INFO] - Saved new W&B run ID to file: vd946lqk
[2025-08-14 00:46:47,008][__main__][INFO] - === AUTO-TUNING BATCH SIZE (RANK 0) ===
[2025-08-14 00:46:48,753][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.75, batch_size=2
[2025-08-14 00:46:50,921][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.75, batch_size=4
[2025-08-14 00:46:52,672][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.75, batch_size=8
[2025-08-14 00:46:54,551][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.75, batch_size=16
[2025-08-14 00:46:56,723][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.75, batch_size=32
[2025-08-14 00:46:59,516][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.75, batch_size=64
[2025-08-14 00:47:03,597][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.75, batch_size=128
[2025-08-14 00:47:05,090][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.75, batch_size=96
[2025-08-14 00:47:10,803][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.75, batch_size=112
[2025-08-14 00:47:12,418][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.75, batch_size=104
[2025-08-14 00:47:18,501][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.75, batch_size=108
[2025-08-14 00:47:20,136][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.75, batch_size=106
[2025-08-14 00:47:26,282][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.75, batch_size=107
[2025-08-14 00:47:32,643][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.75, batch_size=107
[2025-08-14 00:49:14,253][__main__][INFO] - === STARTING EXPERIMENT: bb6-full ===
[2025-08-14 00:49:14,253][__main__][INFO] - PID: 593776
[2025-08-14 00:49:14,253][__main__][INFO] - SLURM_JOB_ID: 30091639
[2025-08-14 00:49:14,254][__main__][INFO] - NODE_RANK: unknown
[2025-08-14 00:49:14,254][__main__][INFO] - WORLD_SIZE: unknown
[2025-08-14 00:49:14,254][__main__][INFO] - MASTER_ADDR: unknown
[2025-08-14 00:49:14,254][__main__][INFO] - MASTER_PORT: unknown
[2025-08-14 00:49:14,254][__main__][INFO] - SLURM_NODEID: 0
[2025-08-14 00:49:14,254][__main__][INFO] - SLURM_NNODES: 1
[2025-08-14 00:49:14,254][__main__][INFO] - SLURM_NODELIST: holygpu7c26106
[2025-08-14 00:49:14,254][__main__][INFO] - Architecture: rgcn50
[2025-08-14 00:49:14,254][__main__][INFO] - Embedding Dim: 64
[2025-08-14 00:49:14,254][__main__][INFO] - Learning Rate: 0.001
[2025-08-14 00:49:14,254][__main__][INFO] - Weight Decay: 0.0
[2025-08-14 00:49:14,254][__main__][INFO] - Optimizer: schedulefree
[2025-08-14 00:49:14,254][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-14 00:49:14,254][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-14 00:49:14,254][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-14 00:49:14,255][__main__][INFO] - Channel Multipliers: [2, 4, 8, 16]
[2025-08-14 00:49:14,875][__main__][INFO] - Num Relations: 66
[2025-08-14 00:49:14,875][__main__][INFO] - Num Logical Qubits: 12
[2025-08-14 00:49:14,875][__main__][INFO] - Dataset: code_type=bivariate_bicycle, l=6, m=6, rounds_list=[7], p=0.75
[2025-08-14 00:49:14,876][__main__][INFO] - Standard training (no curriculum)
[2025-08-14 00:49:14,876][__main__][INFO] - Accelerator: auto
[2025-08-14 00:49:14,876][__main__][INFO] - Devices per node: auto
[2025-08-14 00:49:14,876][__main__][INFO] - Num Nodes: 1
[2025-08-14 00:49:14,876][__main__][INFO] - Total Devices: 1
[2025-08-14 00:49:14,876][__main__][INFO] - Strategy: auto
[2025-08-14 00:49:14,876][__main__][INFO] - Sync BatchNorm: True
[2025-08-14 00:49:14,876][__main__][INFO] - MWPM filtering: False
[2025-08-14 00:49:14,876][__main__][INFO] - Batch Size: auto-tuned
[2025-08-14 00:49:14,876][__main__][INFO] - Precision: bf16-mixed
[2025-08-14 00:49:14,876][__main__][INFO] - Max Steps: 50000
[2025-08-14 00:49:14,876][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-14 00:49:14,877][__main__][INFO] - Log every 100 steps
[2025-08-14 00:49:14,877][__main__][INFO] - Num Workers: 8
[2025-08-14 00:49:14,877][__main__][INFO] - Prefetch Factor: 4
[2025-08-14 00:49:14,877][__main__][INFO] - Persistent Workers: True
[2025-08-14 00:49:14,877][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/bb6-full
[2025-08-14 00:49:14,888][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-14 00:49:14,888][__main__][INFO] - Initializing wandb logger with params
[2025-08-14 00:49:16,870][__main__][INFO] - Saved new W&B run ID to file: 98l7knbf
[2025-08-14 00:49:17,491][__main__][INFO] - === AUTO-TUNING BATCH SIZE (RANK 0) ===
[2025-08-14 00:49:19,217][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.75, batch_size=2
[2025-08-14 00:49:21,359][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.75, batch_size=4
[2025-08-14 00:49:23,102][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.75, batch_size=8
[2025-08-14 00:49:24,980][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.75, batch_size=16
[2025-08-14 00:49:27,147][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.75, batch_size=32
[2025-08-14 00:49:29,947][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.75, batch_size=64
[2025-08-14 00:49:34,045][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.75, batch_size=128
[2025-08-14 00:49:35,559][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.75, batch_size=96
[2025-08-14 00:49:41,338][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.75, batch_size=112
[2025-08-14 00:49:42,953][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.75, batch_size=104
[2025-08-14 00:49:49,039][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.75, batch_size=108
[2025-08-14 00:49:50,677][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.75, batch_size=106
[2025-08-14 00:49:56,852][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.75, batch_size=107
[2025-08-14 00:50:03,192][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.75, batch_size=107
[2025-08-14 00:50:05,079][__main__][INFO] - Model loaded from checkpoint at global step 0
[2025-08-14 00:50:05,218][__main__][INFO] - Found optimal batch size 107
[2025-08-14 00:50:05,223][__main__][INFO] - Saved batch size 90 to file
[2025-08-14 00:50:05,223][__main__][INFO] - Optimal per-GPU batch size found: 90
[2025-08-14 00:50:05,223][__main__][INFO] - Effective total batch size across 1 device(s) on 1 node(s) with 1 accumulation steps: 90
[2025-08-14 00:50:05,226][__main__][INFO] - Saved metadata: {'timestamp': 1755147005.223565, 'slurm_job_id': '30091639', 'batch_size': 90, 'num_devices': 1, 'effective_batch_size': 90}
[2025-08-14 00:50:05,647][__main__][INFO] - === STARTING TRAINING ===
[2025-08-14 00:50:06,049][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.75, batch_size=90
[2025-08-14 00:59:09,762][__main__][INFO] - === STARTING EXPERIMENT: bb6-full ===
[2025-08-14 00:59:09,762][__main__][INFO] - PID: 597708
[2025-08-14 00:59:09,762][__main__][INFO] - SLURM_JOB_ID: 30091639
[2025-08-14 00:59:09,762][__main__][INFO] - NODE_RANK: unknown
[2025-08-14 00:59:09,762][__main__][INFO] - WORLD_SIZE: unknown
[2025-08-14 00:59:09,762][__main__][INFO] - MASTER_ADDR: unknown
[2025-08-14 00:59:09,762][__main__][INFO] - MASTER_PORT: unknown
[2025-08-14 00:59:09,762][__main__][INFO] - SLURM_NODEID: 0
[2025-08-14 00:59:09,762][__main__][INFO] - SLURM_NNODES: 1
[2025-08-14 00:59:09,762][__main__][INFO] - SLURM_NODELIST: holygpu7c26106
[2025-08-14 00:59:09,762][__main__][INFO] - Architecture: rgcn50
[2025-08-14 00:59:09,763][__main__][INFO] - Embedding Dim: 64
[2025-08-14 00:59:09,763][__main__][INFO] - Learning Rate: 0.0003
[2025-08-14 00:59:09,763][__main__][INFO] - Weight Decay: 0.0
[2025-08-14 00:59:09,763][__main__][INFO] - Optimizer: schedulefree
[2025-08-14 00:59:09,763][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-14 00:59:09,763][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-14 00:59:09,763][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-14 00:59:09,763][__main__][INFO] - Channel Multipliers: [2, 4, 8, 16]
[2025-08-14 00:59:10,385][__main__][INFO] - Num Relations: 66
[2025-08-14 00:59:10,385][__main__][INFO] - Num Logical Qubits: 12
[2025-08-14 00:59:10,386][__main__][INFO] - Dataset: code_type=bivariate_bicycle, l=6, m=6, rounds_list=[7], p=0.5
[2025-08-14 00:59:10,386][__main__][INFO] - Standard training (no curriculum)
[2025-08-14 00:59:10,386][__main__][INFO] - Accelerator: auto
[2025-08-14 00:59:10,386][__main__][INFO] - Devices per node: auto
[2025-08-14 00:59:10,386][__main__][INFO] - Num Nodes: 1
[2025-08-14 00:59:10,386][__main__][INFO] - Total Devices: 1
[2025-08-14 00:59:10,386][__main__][INFO] - Strategy: auto
[2025-08-14 00:59:10,386][__main__][INFO] - Sync BatchNorm: True
[2025-08-14 00:59:10,386][__main__][INFO] - MWPM filtering: False
[2025-08-14 00:59:10,386][__main__][INFO] - Batch Size: auto-tuned
[2025-08-14 00:59:10,386][__main__][INFO] - Precision: bf16-mixed
[2025-08-14 00:59:10,386][__main__][INFO] - Max Steps: 50000
[2025-08-14 00:59:10,387][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-14 00:59:10,387][__main__][INFO] - Log every 100 steps
[2025-08-14 00:59:10,387][__main__][INFO] - Num Workers: 8
[2025-08-14 00:59:10,387][__main__][INFO] - Prefetch Factor: 4
[2025-08-14 00:59:10,387][__main__][INFO] - Persistent Workers: True
[2025-08-14 00:59:10,387][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/bb6-full
[2025-08-14 00:59:10,405][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-14 00:59:10,405][__main__][INFO] - Initializing wandb logger with params
[2025-08-14 00:59:12,363][__main__][INFO] - Saved new W&B run ID to file: w3u0y4rx
[2025-08-14 00:59:12,987][__main__][INFO] - === AUTO-TUNING BATCH SIZE (RANK 0) ===
[2025-08-14 00:59:14,710][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=2
[2025-08-14 00:59:16,819][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=4
[2025-08-14 00:59:18,582][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=8
[2025-08-14 00:59:20,451][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=16
[2025-08-14 00:59:22,609][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=32
[2025-08-14 00:59:25,424][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=64
[2025-08-14 00:59:29,497][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=128
[2025-08-14 00:59:30,972][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=96
[2025-08-14 00:59:36,696][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=112
[2025-08-14 00:59:38,331][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=104
[2025-08-14 00:59:44,419][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=108
[2025-08-14 00:59:46,059][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=106
[2025-08-14 00:59:52,230][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=107
[2025-08-14 00:59:58,584][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=107
[2025-08-14 01:00:00,575][__main__][INFO] - Model loaded from checkpoint at global step 0
[2025-08-14 01:00:00,729][__main__][INFO] - Found optimal batch size 107
[2025-08-14 01:00:00,734][__main__][INFO] - Saved batch size 90 to file
[2025-08-14 01:00:00,734][__main__][INFO] - Optimal per-GPU batch size found: 90
[2025-08-14 01:00:00,734][__main__][INFO] - Effective total batch size across 1 device(s) on 1 node(s) with 1 accumulation steps: 90
[2025-08-14 01:00:00,739][__main__][INFO] - Saved metadata: {'timestamp': 1755147600.7349572, 'slurm_job_id': '30091639', 'batch_size': 90, 'num_devices': 1, 'effective_batch_size': 90}
[2025-08-14 01:00:01,158][__main__][INFO] - === STARTING TRAINING ===
[2025-08-14 01:00:01,561][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=90
[2025-08-14 01:07:48,149][__main__][INFO] - === STARTING EXPERIMENT: bb6-full ===
[2025-08-14 01:07:48,149][__main__][INFO] - PID: 600611
[2025-08-14 01:07:48,149][__main__][INFO] - SLURM_JOB_ID: 30091639
[2025-08-14 01:07:48,149][__main__][INFO] - NODE_RANK: unknown
[2025-08-14 01:07:48,149][__main__][INFO] - WORLD_SIZE: unknown
[2025-08-14 01:07:48,149][__main__][INFO] - MASTER_ADDR: unknown
[2025-08-14 01:07:48,149][__main__][INFO] - MASTER_PORT: unknown
[2025-08-14 01:07:48,149][__main__][INFO] - SLURM_NODEID: 0
[2025-08-14 01:07:48,149][__main__][INFO] - SLURM_NNODES: 1
[2025-08-14 01:07:48,149][__main__][INFO] - SLURM_NODELIST: holygpu7c26106
[2025-08-14 01:07:48,149][__main__][INFO] - Architecture: rgcn50
[2025-08-14 01:07:48,149][__main__][INFO] - Embedding Dim: 64
[2025-08-14 01:07:48,149][__main__][INFO] - Learning Rate: 0.0003
[2025-08-14 01:07:48,149][__main__][INFO] - Weight Decay: 0.0
[2025-08-14 01:07:48,150][__main__][INFO] - Optimizer: schedulefree
[2025-08-14 01:07:48,150][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-14 01:07:48,150][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-14 01:07:48,150][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-14 01:07:48,150][__main__][INFO] - Channel Multipliers: [2, 4, 8, 16]
[2025-08-14 01:07:48,776][__main__][INFO] - Num Relations: 66
[2025-08-14 01:07:48,776][__main__][INFO] - Num Logical Qubits: 12
[2025-08-14 01:07:48,777][__main__][INFO] - Dataset: code_type=bivariate_bicycle, l=6, m=6, rounds_list=[7], p=0.5
[2025-08-14 01:07:48,777][__main__][INFO] - Standard training (no curriculum)
[2025-08-14 01:07:48,777][__main__][INFO] - Accelerator: auto
[2025-08-14 01:07:48,777][__main__][INFO] - Devices per node: auto
[2025-08-14 01:07:48,777][__main__][INFO] - Num Nodes: 1
[2025-08-14 01:07:48,777][__main__][INFO] - Total Devices: 1
[2025-08-14 01:07:48,777][__main__][INFO] - Strategy: auto
[2025-08-14 01:07:48,777][__main__][INFO] - Sync BatchNorm: True
[2025-08-14 01:07:48,778][__main__][INFO] - MWPM filtering: False
[2025-08-14 01:07:48,778][__main__][INFO] - Batch Size: auto-tuned
[2025-08-14 01:07:48,778][__main__][INFO] - Precision: bf16-mixed
[2025-08-14 01:07:48,778][__main__][INFO] - Max Steps: 50000
[2025-08-14 01:07:48,778][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-14 01:07:48,778][__main__][INFO] - Log every 100 steps
[2025-08-14 01:07:48,778][__main__][INFO] - Num Workers: 8
[2025-08-14 01:07:48,778][__main__][INFO] - Prefetch Factor: 4
[2025-08-14 01:07:48,778][__main__][INFO] - Persistent Workers: True
[2025-08-14 01:07:48,778][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/bb6-full
[2025-08-14 01:07:48,792][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-14 01:07:48,793][__main__][INFO] - Initializing wandb logger with params
[2025-08-14 01:07:50,739][__main__][INFO] - Saved new W&B run ID to file: l3kfr2uo
[2025-08-14 01:07:51,359][__main__][INFO] - === AUTO-TUNING BATCH SIZE (RANK 0) ===
[2025-08-14 01:07:53,030][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=2
[2025-08-14 01:09:54,987][__main__][INFO] - === STARTING EXPERIMENT: d11-curriculum ===
[2025-08-14 01:09:54,988][__main__][INFO] - PID: 3952082
[2025-08-14 01:09:54,988][__main__][INFO] - SLURM_JOB_ID: 30051868
[2025-08-14 01:09:54,988][__main__][INFO] - NODE_RANK: unknown
[2025-08-14 01:09:54,988][__main__][INFO] - WORLD_SIZE: unknown
[2025-08-14 01:09:54,988][__main__][INFO] - MASTER_ADDR: unknown
[2025-08-14 01:09:54,988][__main__][INFO] - MASTER_PORT: unknown
[2025-08-14 01:09:54,989][__main__][INFO] - SLURM_NODEID: 0
[2025-08-14 01:09:54,989][__main__][INFO] - SLURM_NNODES: 1
[2025-08-14 01:09:54,989][__main__][INFO] - SLURM_NODELIST: holygpu8a26504
[2025-08-14 01:09:54,989][__main__][INFO] - Architecture: resnet50
[2025-08-14 01:09:54,989][__main__][INFO] - Embedding Dim: 128
[2025-08-14 01:09:54,989][__main__][INFO] - Learning Rate: 0.0004
[2025-08-14 01:09:54,989][__main__][INFO] - Weight Decay: 0.0
[2025-08-14 01:09:54,989][__main__][INFO] - Optimizer: schedulefree
[2025-08-14 01:09:54,989][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-14 01:09:54,989][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-14 01:09:54,989][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-14 01:09:54,990][__main__][INFO] - Channel Multipliers: [2, 2.5, 3, 3.5]
[2025-08-14 01:09:54,990][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-14 01:09:54,990][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-14 01:09:54,990][__main__][INFO] - Use LSTM: False
[2025-08-14 01:09:54,990][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-14 01:09:54,990][__main__][INFO] - Dataset: code_type=surface_code, d=11, rounds_list=[11], p=2.1
[2025-08-14 01:09:54,990][__main__][INFO] - === 3-STAGE CURRICULUM LEARNING ENABLED ===
[2025-08-14 01:09:54,990][__main__][INFO] - Stage 1: p=0.5 for 40000 steps
[2025-08-14 01:09:54,990][__main__][INFO] - Stage 2: p=0.5→2.1 over 50000 steps
[2025-08-14 01:09:54,991][__main__][INFO] - Stage 3: p=2.1 for 20000 steps
[2025-08-14 01:09:54,991][__main__][INFO] - Total curriculum steps: 110000
[2025-08-14 01:09:54,991][__main__][INFO] - Accelerator: auto
[2025-08-14 01:09:54,991][__main__][INFO] - Devices per node: 2
[2025-08-14 01:09:54,991][__main__][INFO] - Num Nodes: 1
[2025-08-14 01:09:54,991][__main__][INFO] - Total Devices: 2
[2025-08-14 01:09:54,991][__main__][INFO] - Strategy: auto
[2025-08-14 01:09:54,991][__main__][INFO] - Sync BatchNorm: True
[2025-08-14 01:09:54,991][__main__][INFO] - MWPM filtering: False
[2025-08-14 01:09:54,991][__main__][INFO] - Batch Size: auto-tuned
[2025-08-14 01:09:54,991][__main__][INFO] - Precision: bf16-mixed
[2025-08-14 01:09:54,992][__main__][INFO] - Max Steps: 110000 (curriculum override)
[2025-08-14 01:09:54,992][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-14 01:09:54,992][__main__][INFO] - Log every 100 steps
[2025-08-14 01:09:54,992][__main__][INFO] - Num Workers: 6
[2025-08-14 01:09:54,992][__main__][INFO] - Prefetch Factor: 4
[2025-08-14 01:09:54,992][__main__][INFO] - Persistent Workers: True
[2025-08-14 01:09:54,992][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d11-curriculum
[2025-08-14 01:09:55,005][__main__][INFO] - Found latest checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d11-curriculum/checkpoints/d11-curriculum-step=2158.ckpt
[2025-08-14 01:09:55,008][__main__][INFO] - Loaded W&B run ID from file: qg1y59ht
[2025-08-14 01:09:55,008][__main__][INFO] - Setting up W&B logger with existing run ID: qg1y59ht
[2025-08-14 01:09:55,009][__main__][INFO] - Initializing wandb logger with params
[2025-08-14 01:09:55,018][stage_manager][INFO] - Initialized 3-stage curriculum learning:
[2025-08-14 01:09:55,018][stage_manager][INFO] -   Stage 1: p=0.5 for 40000 steps
[2025-08-14 01:09:55,018][stage_manager][INFO] -   Stage 2: p=0.5→2.1 over 50000 steps
[2025-08-14 01:09:55,019][stage_manager][INFO] -   Stage 3: p=2.1 for 20000 steps
[2025-08-14 01:09:55,019][stage_manager][INFO] -   Total steps: 110000
[2025-08-14 01:09:55,184][__main__][INFO] - Loaded batch size 716 from file
[2025-08-14 01:09:55,185][__main__][INFO] - Effective total batch size across 2 device(s) on 1 node(s) with 1 accumulation steps: 1432
[2025-08-14 01:09:55,190][__main__][INFO] - Saved metadata: {'timestamp': 1755148195.1853776, 'slurm_job_id': '30051868', 'batch_size': 716, 'num_devices': 2, 'effective_batch_size': 1432}
[2025-08-14 01:10:03,958][data_module][INFO] - Set DataModule global_step_offset to 2158 (will apply when dataset is created)
[2025-08-14 01:10:03,961][__main__][INFO] - Updated DataModule global_step_offset to 2158 for resume
[2025-08-14 01:10:04,124][__main__][INFO] - === STARTING TRAINING ===
[2025-08-14 01:10:04,124][__main__][INFO] - Resuming from checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d11-curriculum/checkpoints/d11-curriculum-step=2158.ckpt
[2025-08-14 01:10:05,350][__main__][INFO] - === STARTING EXPERIMENT: bb6-full ===
[2025-08-14 01:10:05,350][__main__][INFO] - PID: 600957
[2025-08-14 01:10:05,351][__main__][INFO] - SLURM_JOB_ID: 30091639
[2025-08-14 01:10:05,351][__main__][INFO] - NODE_RANK: unknown
[2025-08-14 01:10:05,351][__main__][INFO] - WORLD_SIZE: unknown
[2025-08-14 01:10:05,351][__main__][INFO] - MASTER_ADDR: unknown
[2025-08-14 01:10:05,351][__main__][INFO] - MASTER_PORT: unknown
[2025-08-14 01:10:05,351][__main__][INFO] - SLURM_NODEID: 0
[2025-08-14 01:10:05,351][__main__][INFO] - SLURM_NNODES: 1
[2025-08-14 01:10:05,351][__main__][INFO] - SLURM_NODELIST: holygpu7c26106
[2025-08-14 01:10:05,351][__main__][INFO] - Architecture: rgcn50
[2025-08-14 01:10:05,351][__main__][INFO] - Embedding Dim: 64
[2025-08-14 01:10:05,351][__main__][INFO] - Learning Rate: 0.0003
[2025-08-14 01:10:05,351][__main__][INFO] - Weight Decay: 0.0
[2025-08-14 01:10:05,351][__main__][INFO] - Optimizer: schedulefree
[2025-08-14 01:10:05,351][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-14 01:10:05,351][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-14 01:10:05,351][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-14 01:10:05,352][__main__][INFO] - Channel Multipliers: [2, 4, 8, 16]
[2025-08-14 01:10:05,979][__main__][INFO] - Num Relations: 66
[2025-08-14 01:10:05,979][__main__][INFO] - Num Logical Qubits: 12
[2025-08-14 01:10:05,979][__main__][INFO] - Dataset: code_type=bivariate_bicycle, l=6, m=6, rounds_list=[7], p=0.5
[2025-08-14 01:10:05,979][__main__][INFO] - Standard training (no curriculum)
[2025-08-14 01:10:05,979][__main__][INFO] - Accelerator: auto
[2025-08-14 01:10:05,980][__main__][INFO] - Devices per node: auto
[2025-08-14 01:10:05,980][__main__][INFO] - Num Nodes: 1
[2025-08-14 01:10:05,980][__main__][INFO] - Total Devices: 1
[2025-08-14 01:10:05,980][__main__][INFO] - Strategy: auto
[2025-08-14 01:10:05,980][__main__][INFO] - Sync BatchNorm: True
[2025-08-14 01:10:05,980][__main__][INFO] - MWPM filtering: False
[2025-08-14 01:10:05,980][__main__][INFO] - Batch Size: auto-tuned
[2025-08-14 01:10:05,980][__main__][INFO] - Precision: bf16-mixed
[2025-08-14 01:10:05,980][__main__][INFO] - Max Steps: 50000
[2025-08-14 01:10:05,980][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-14 01:10:05,980][__main__][INFO] - Log every 100 steps
[2025-08-14 01:10:05,980][__main__][INFO] - Num Workers: 8
[2025-08-14 01:10:05,980][__main__][INFO] - Prefetch Factor: 4
[2025-08-14 01:10:05,981][__main__][INFO] - Persistent Workers: True
[2025-08-14 01:10:05,981][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/bb6-full
[2025-08-14 01:10:05,984][__main__][INFO] - Loaded W&B run ID from file: l3kfr2uo
[2025-08-14 01:10:05,984][__main__][INFO] - Setting up W&B logger with existing run ID: l3kfr2uo
[2025-08-14 01:10:05,984][__main__][INFO] - Initializing wandb logger with params
[2025-08-14 01:10:06,606][__main__][INFO] - === AUTO-TUNING BATCH SIZE (RANK 0) ===
[2025-08-14 01:10:08,289][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=2
[2025-08-14 01:10:10,322][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=4
[2025-08-14 01:10:12,032][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=8
[2025-08-14 01:10:13,903][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=16
[2025-08-14 01:10:16,061][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=32
[2025-08-14 01:10:18,873][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=64
[2025-08-14 01:10:22,946][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=128
[2025-08-14 01:10:24,474][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=96
[2025-08-14 01:10:30,210][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=112
[2025-08-14 01:10:31,801][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=104
[2025-08-14 01:10:37,924][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=108
[2025-08-14 01:10:39,544][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=106
[2025-08-14 01:10:45,725][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=107
[2025-08-14 01:10:47,342][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=106
[2025-08-14 01:10:48,302][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=106
[2025-08-14 01:10:50,093][__main__][INFO] - Model loaded from checkpoint at global step 0
[2025-08-14 01:10:50,201][__main__][INFO] - Found optimal batch size 106
[2025-08-14 01:10:50,207][__main__][INFO] - Saved batch size 90 to file
[2025-08-14 01:10:50,207][__main__][INFO] - Optimal per-GPU batch size found: 90
[2025-08-14 01:10:50,207][__main__][INFO] - Effective total batch size across 1 device(s) on 1 node(s) with 1 accumulation steps: 90
[2025-08-14 01:10:50,209][__main__][INFO] - Saved metadata: {'timestamp': 1755148250.2078617, 'slurm_job_id': '30091639', 'batch_size': 90, 'num_devices': 1, 'effective_batch_size': 90}
[2025-08-14 01:11:10,890][__main__][INFO] - Model loaded from checkpoint at global step 2158
[2025-08-14 01:11:11,230][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=11, rounds_list=[11], p=2.1, batch_size=716
[2025-08-14 01:11:11,230][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-14 01:28:55,600][__main__][INFO] - === STARTING EXPERIMENT: bb6-full ===
[2025-08-14 01:28:55,600][__main__][INFO] - PID: 607211
[2025-08-14 01:28:55,600][__main__][INFO] - SLURM_JOB_ID: 30091639
[2025-08-14 01:28:55,600][__main__][INFO] - NODE_RANK: unknown
[2025-08-14 01:28:55,601][__main__][INFO] - WORLD_SIZE: unknown
[2025-08-14 01:28:55,601][__main__][INFO] - MASTER_ADDR: unknown
[2025-08-14 01:28:55,601][__main__][INFO] - MASTER_PORT: unknown
[2025-08-14 01:28:55,601][__main__][INFO] - SLURM_NODEID: 0
[2025-08-14 01:28:55,601][__main__][INFO] - SLURM_NNODES: 1
[2025-08-14 01:28:55,601][__main__][INFO] - SLURM_NODELIST: holygpu7c26106
[2025-08-14 01:28:55,601][__main__][INFO] - Architecture: rgcn50
[2025-08-14 01:28:55,601][__main__][INFO] - Embedding Dim: 64
[2025-08-14 01:28:55,601][__main__][INFO] - Learning Rate: 0.0005
[2025-08-14 01:28:55,601][__main__][INFO] - Weight Decay: 0.0
[2025-08-14 01:28:55,601][__main__][INFO] - Optimizer: schedulefree
[2025-08-14 01:28:55,601][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-14 01:28:55,601][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-14 01:28:55,601][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-14 01:28:55,601][__main__][INFO] - Channel Multipliers: [2, 4, 8, 16]
[2025-08-14 01:28:56,229][__main__][INFO] - Num Relations: 66
[2025-08-14 01:28:56,229][__main__][INFO] - Num Logical Qubits: 12
[2025-08-14 01:28:56,229][__main__][INFO] - Dataset: code_type=bivariate_bicycle, l=6, m=6, rounds_list=[7], p=0.5
[2025-08-14 01:28:56,229][__main__][INFO] - Standard training (no curriculum)
[2025-08-14 01:28:56,230][__main__][INFO] - Accelerator: auto
[2025-08-14 01:28:56,230][__main__][INFO] - Devices per node: auto
[2025-08-14 01:28:56,230][__main__][INFO] - Num Nodes: 1
[2025-08-14 01:28:56,230][__main__][INFO] - Total Devices: 1
[2025-08-14 01:28:56,230][__main__][INFO] - Strategy: auto
[2025-08-14 01:28:56,230][__main__][INFO] - Sync BatchNorm: True
[2025-08-14 01:28:56,230][__main__][INFO] - MWPM filtering: False
[2025-08-14 01:28:56,230][__main__][INFO] - Batch Size: auto-tuned
[2025-08-14 01:28:56,230][__main__][INFO] - Precision: bf16-mixed
[2025-08-14 01:28:56,230][__main__][INFO] - Max Steps: 50000
[2025-08-14 01:28:56,230][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-14 01:28:56,230][__main__][INFO] - Log every 100 steps
[2025-08-14 01:28:56,231][__main__][INFO] - Num Workers: 8
[2025-08-14 01:28:56,231][__main__][INFO] - Prefetch Factor: 4
[2025-08-14 01:28:56,231][__main__][INFO] - Persistent Workers: True
[2025-08-14 01:28:56,231][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/bb6-full
[2025-08-14 01:28:56,243][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-14 01:28:56,244][__main__][INFO] - Initializing wandb logger with params
[2025-08-14 01:28:58,195][__main__][INFO] - Saved new W&B run ID to file: salfbioy
[2025-08-14 01:28:58,815][__main__][INFO] - === AUTO-TUNING BATCH SIZE (RANK 0) ===
[2025-08-14 01:29:00,484][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=2
[2025-08-14 01:29:02,450][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=4
[2025-08-14 01:29:04,184][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=8
[2025-08-14 01:29:06,046][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=16
[2025-08-14 01:29:08,215][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=32
[2025-08-14 01:29:11,024][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=64
[2025-08-14 01:29:15,096][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=128
[2025-08-14 01:29:16,591][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=96
[2025-08-14 01:29:22,343][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=112
[2025-08-14 01:29:23,944][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=104
[2025-08-14 01:29:29,998][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=108
[2025-08-14 01:29:31,636][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=106
[2025-08-14 01:29:37,874][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=107
[2025-08-14 01:29:44,246][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=107
[2025-08-14 01:29:46,040][__main__][INFO] - Model loaded from checkpoint at global step 0
[2025-08-14 01:29:46,181][__main__][INFO] - Found optimal batch size 107
[2025-08-14 01:29:46,184][__main__][INFO] - Saved batch size 90 to file
[2025-08-14 01:29:46,185][__main__][INFO] - Optimal per-GPU batch size found: 90
[2025-08-14 01:29:46,185][__main__][INFO] - Effective total batch size across 1 device(s) on 1 node(s) with 1 accumulation steps: 90
[2025-08-14 01:29:46,188][__main__][INFO] - Saved metadata: {'timestamp': 1755149386.1853416, 'slurm_job_id': '30091639', 'batch_size': 90, 'num_devices': 1, 'effective_batch_size': 90}
[2025-08-14 01:29:46,608][__main__][INFO] - === STARTING TRAINING ===
[2025-08-14 01:29:47,007][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=90
[2025-08-14 01:50:18,698][__main__][INFO] - === STARTING EXPERIMENT: bb6-full-lr-high ===
[2025-08-14 01:50:18,698][__main__][INFO] - PID: 129683
[2025-08-14 01:50:18,698][__main__][INFO] - SLURM_JOB_ID: 30099998
[2025-08-14 01:50:18,698][__main__][INFO] - NODE_RANK: unknown
[2025-08-14 01:50:18,698][__main__][INFO] - WORLD_SIZE: unknown
[2025-08-14 01:50:18,698][__main__][INFO] - MASTER_ADDR: unknown
[2025-08-14 01:50:18,698][__main__][INFO] - MASTER_PORT: unknown
[2025-08-14 01:50:18,698][__main__][INFO] - SLURM_NODEID: 0
[2025-08-14 01:50:18,698][__main__][INFO] - SLURM_NNODES: 1
[2025-08-14 01:50:18,698][__main__][INFO] - SLURM_NODELIST: holygpu8a29505
[2025-08-14 01:50:18,698][__main__][INFO] - Architecture: rgcn50
[2025-08-14 01:50:18,698][__main__][INFO] - Embedding Dim: 64
[2025-08-14 01:50:18,698][__main__][INFO] - Learning Rate: 0.001
[2025-08-14 01:50:18,698][__main__][INFO] - Weight Decay: 0.0
[2025-08-14 01:50:18,699][__main__][INFO] - Optimizer: schedulefree
[2025-08-14 01:50:18,699][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-14 01:50:18,699][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-14 01:50:18,699][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-14 01:50:18,699][__main__][INFO] - Channel Multipliers: [2, 4, 8, 16]
[2025-08-14 01:50:19,579][__main__][INFO] - Num Relations: 66
[2025-08-14 01:50:19,580][__main__][INFO] - Num Logical Qubits: 12
[2025-08-14 01:50:19,580][__main__][INFO] - Dataset: code_type=bivariate_bicycle, l=6, m=6, rounds_list=[7], p=0.5
[2025-08-14 01:50:19,580][__main__][INFO] - Standard training (no curriculum)
[2025-08-14 01:50:19,605][__main__][INFO] - Accelerator: auto
[2025-08-14 01:50:19,605][__main__][INFO] - Devices per node: auto
[2025-08-14 01:50:19,605][__main__][INFO] - Num Nodes: 1
[2025-08-14 01:50:19,606][__main__][INFO] - Total Devices: 1
[2025-08-14 01:50:19,606][__main__][INFO] - Strategy: auto
[2025-08-14 01:50:19,606][__main__][INFO] - Sync BatchNorm: True
[2025-08-14 01:50:19,606][__main__][INFO] - MWPM filtering: False
[2025-08-14 01:50:19,606][__main__][INFO] - Batch Size: auto-tuned
[2025-08-14 01:50:19,606][__main__][INFO] - Precision: bf16-mixed
[2025-08-14 01:50:19,606][__main__][INFO] - Max Steps: 50000
[2025-08-14 01:50:19,606][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-14 01:50:19,606][__main__][INFO] - Log every 100 steps
[2025-08-14 01:50:19,606][__main__][INFO] - Num Workers: 8
[2025-08-14 01:50:19,606][__main__][INFO] - Prefetch Factor: 4
[2025-08-14 01:50:19,606][__main__][INFO] - Persistent Workers: True
[2025-08-14 01:50:19,606][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/bb6-full-lr-high
[2025-08-14 01:50:19,620][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-14 01:50:19,621][__main__][INFO] - Initializing wandb logger with params
[2025-08-14 01:50:27,262][__main__][INFO] - Saved new W&B run ID to file: 2153mtk3
[2025-08-14 01:50:27,946][__main__][INFO] - === AUTO-TUNING BATCH SIZE (RANK 0) ===
[2025-08-14 01:50:29,883][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=2
[2025-08-14 01:50:37,999][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=4
[2025-08-14 01:50:39,917][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=8
[2025-08-14 01:50:41,878][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=16
[2025-08-14 01:50:43,905][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=32
[2025-08-14 01:50:46,188][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=64
[2025-08-14 01:50:49,169][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=128
[2025-08-14 01:50:53,534][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=256
[2025-08-14 01:50:55,885][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=192
[2025-08-14 01:51:02,513][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=224
[2025-08-14 01:51:05,083][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=208
[2025-08-14 01:51:12,071][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=216
[2025-08-14 01:51:19,006][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=220
[2025-08-14 01:51:26,195][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=222
[2025-08-14 01:51:29,092][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=221
[2025-08-14 01:51:37,493][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=221
[2025-08-14 01:51:39,603][__main__][INFO] - Model loaded from checkpoint at global step 0
[2025-08-14 01:51:39,756][__main__][INFO] - Found optimal batch size 221
[2025-08-14 01:51:39,761][__main__][INFO] - Saved batch size 187 to file
[2025-08-14 01:51:39,762][__main__][INFO] - Optimal per-GPU batch size found: 187
[2025-08-14 01:51:39,762][__main__][INFO] - Effective total batch size across 1 device(s) on 1 node(s) with 1 accumulation steps: 187
[2025-08-14 01:51:39,765][__main__][INFO] - Saved metadata: {'timestamp': 1755150699.7624433, 'slurm_job_id': '30099998', 'batch_size': 187, 'num_devices': 1, 'effective_batch_size': 187}
[2025-08-14 01:51:40,201][__main__][INFO] - === STARTING TRAINING ===
[2025-08-14 01:51:40,596][data_module][INFO] - Created dataset (BivariateBicycleDataset): l=6, m=6, d=9, rounds_list=[7], p=0.5, batch_size=187
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         [2025-08-14 06:08:52,181][__main__][ERROR] - === TRAINING FAILED: DataLoader worker (pid 133926) is killed by signal: Terminated.  ===
[2025-08-14 07:19:13,961][__main__][INFO] - === STARTING EXPERIMENT: d15-curriculum ===
[2025-08-14 07:19:13,961][__main__][INFO] - PID: 2988419
[2025-08-14 07:19:13,961][__main__][INFO] - SLURM_JOB_ID: 30051885
[2025-08-14 07:19:13,961][__main__][INFO] - NODE_RANK: unknown
[2025-08-14 07:19:13,961][__main__][INFO] - WORLD_SIZE: unknown
[2025-08-14 07:19:13,961][__main__][INFO] - MASTER_ADDR: unknown
[2025-08-14 07:19:13,961][__main__][INFO] - MASTER_PORT: unknown
[2025-08-14 07:19:13,961][__main__][INFO] - SLURM_NODEID: 0
[2025-08-14 07:19:13,961][__main__][INFO] - SLURM_NNODES: 1
[2025-08-14 07:19:13,962][__main__][INFO] - SLURM_NODELIST: holygpu8a17503
[2025-08-14 07:19:13,962][__main__][INFO] - Architecture: resnet50
[2025-08-14 07:19:13,962][__main__][INFO] - Embedding Dim: 128
[2025-08-14 07:19:13,962][__main__][INFO] - Learning Rate: 0.0004
[2025-08-14 07:19:13,962][__main__][INFO] - Weight Decay: 0.0
[2025-08-14 07:19:13,962][__main__][INFO] - Optimizer: schedulefree
[2025-08-14 07:19:13,962][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-14 07:19:13,962][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-14 07:19:13,962][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-14 07:19:13,962][__main__][INFO] - Channel Multipliers: [2, 2.5, 3, 3.5]
[2025-08-14 07:19:13,962][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-14 07:19:13,962][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-14 07:19:13,962][__main__][INFO] - Use LSTM: False
[2025-08-14 07:19:13,962][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-14 07:19:13,962][__main__][INFO] - Dataset: code_type=surface_code, d=15, rounds_list=[15], p=2.1
[2025-08-14 07:19:13,962][__main__][INFO] - === 3-STAGE CURRICULUM LEARNING ENABLED ===
[2025-08-14 07:19:13,962][__main__][INFO] - Stage 1: p=0.5 for 50000 steps
[2025-08-14 07:19:13,962][__main__][INFO] - Stage 2: p=0.5→2.1 over 50000 steps
[2025-08-14 07:19:13,962][__main__][INFO] - Stage 3: p=2.1 for 200000 steps
[2025-08-14 07:19:13,963][__main__][INFO] - Total curriculum steps: 300000
[2025-08-14 07:19:13,963][__main__][INFO] - Accelerator: auto
[2025-08-14 07:19:13,963][__main__][INFO] - Devices per node: 4
[2025-08-14 07:19:13,963][__main__][INFO] - Num Nodes: 1
[2025-08-14 07:19:13,963][__main__][INFO] - Total Devices: 4
[2025-08-14 07:19:13,963][__main__][INFO] - Strategy: auto
[2025-08-14 07:19:13,963][__main__][INFO] - Sync BatchNorm: True
[2025-08-14 07:19:13,963][__main__][INFO] - MWPM filtering: False
[2025-08-14 07:19:13,963][__main__][INFO] - Batch Size: auto-tuned
[2025-08-14 07:19:13,963][__main__][INFO] - Precision: bf16-mixed
[2025-08-14 07:19:13,963][__main__][INFO] - Max Steps: 300000 (curriculum override)
[2025-08-14 07:19:13,963][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-14 07:19:13,963][__main__][INFO] - Log every 100 steps
[2025-08-14 07:19:13,963][__main__][INFO] - Num Workers: 7
[2025-08-14 07:19:13,963][__main__][INFO] - Prefetch Factor: 4
[2025-08-14 07:19:13,963][__main__][INFO] - Persistent Workers: True
[2025-08-14 07:19:13,963][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d15-curriculum
[2025-08-14 07:19:13,975][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-14 07:19:13,975][__main__][INFO] - Initializing wandb logger with params
[2025-08-14 07:19:21,251][__main__][INFO] - Saved new W&B run ID to file: b3emqw4p
[2025-08-14 07:19:21,254][stage_manager][INFO] - Initialized 3-stage curriculum learning:
[2025-08-14 07:19:21,254][stage_manager][INFO] -   Stage 1: p=0.5 for 50000 steps
[2025-08-14 07:19:21,254][stage_manager][INFO] -   Stage 2: p=0.5→2.1 over 50000 steps
[2025-08-14 07:19:21,254][stage_manager][INFO] -   Stage 3: p=2.1 for 200000 steps
[2025-08-14 07:19:21,254][stage_manager][INFO] -   Total steps: 300000
[2025-08-14 07:19:21,363][__main__][INFO] - === AUTO-TUNING BATCH SIZE (RANK 0) ===
[2025-08-14 07:19:22,414][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=15, rounds_list=[15], p=2.1, batch_size=2
[2025-08-14 07:19:22,414][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-14 07:19:33,065][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=15, rounds_list=[15], p=2.1, batch_size=4
[2025-08-14 07:19:33,066][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-14 07:19:34,093][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=15, rounds_list=[15], p=2.1, batch_size=8
[2025-08-14 07:19:34,093][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-14 07:19:35,212][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=15, rounds_list=[15], p=2.1, batch_size=16
[2025-08-14 07:19:35,212][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-14 07:19:36,652][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=15, rounds_list=[15], p=2.1, batch_size=32
[2025-08-14 07:19:36,652][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-14 07:19:38,250][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=15, rounds_list=[15], p=2.1, batch_size=64
[2025-08-14 07:19:38,250][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-14 07:19:40,072][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=15, rounds_list=[15], p=2.1, batch_size=128
[2025-08-14 07:19:40,072][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-14 07:19:42,777][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=15, rounds_list=[15], p=2.1, batch_size=256
[2025-08-14 07:19:42,777][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-14 07:19:47,207][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=15, rounds_list=[15], p=2.1, batch_size=512
[2025-08-14 07:19:47,208][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-14 07:19:48,954][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=15, rounds_list=[15], p=2.1, batch_size=384
[2025-08-14 07:19:48,954][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-14 07:19:50,449][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=15, rounds_list=[15], p=2.1, batch_size=320
[2025-08-14 07:19:50,449][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-14 07:19:55,748][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=15, rounds_list=[15], p=2.1, batch_size=352
[2025-08-14 07:19:55,748][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-14 07:20:01,554][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=15, rounds_list=[15], p=2.1, batch_size=368
[2025-08-14 07:20:01,554][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-14 07:20:03,339][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=15, rounds_list=[15], p=2.1, batch_size=360
[2025-08-14 07:20:03,339][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-14 07:20:05,602][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=15, rounds_list=[15], p=2.1, batch_size=356
[2025-08-14 07:20:05,602][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-14 07:20:07,836][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=15, rounds_list=[15], p=2.1, batch_size=354
[2025-08-14 07:20:07,836][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-14 07:20:13,603][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=15, rounds_list=[15], p=2.1, batch_size=355
[2025-08-14 07:20:13,603][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-14 07:20:19,715][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=15, rounds_list=[15], p=2.1, batch_size=355
[2025-08-14 07:20:19,715][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-14 07:20:20,460][__main__][INFO] - Model loaded from checkpoint at global step 0
[2025-08-14 07:20:20,565][__main__][INFO] - Found optimal batch size 355
[2025-08-14 07:20:20,572][__main__][INFO] - Saved batch size 301 to file
[2025-08-14 07:20:20,572][__main__][INFO] - Optimal per-GPU batch size found: 301
[2025-08-14 07:20:20,572][__main__][INFO] - Effective total batch size across 4 device(s) on 1 node(s) with 1 accumulation steps: 1204
[2025-08-14 07:20:20,578][__main__][INFO] - Saved metadata: {'timestamp': 1755170420.5727165, 'slurm_job_id': '30051885', 'batch_size': 301, 'num_devices': 4, 'effective_batch_size': 1204}
[2025-08-14 07:20:20,938][__main__][INFO] - === STARTING TRAINING ===
[2025-08-14 07:21:23,632][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=15, rounds_list=[15], p=2.1, batch_size=301
[2025-08-14 07:21:23,634][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-14 07:37:24,683][__main__][ERROR] - === TRAINING FAILED: DataLoader worker (pid 2989403) is killed by signal: Terminated.  ===
[2025-08-14 08:10:29,146][__main__][INFO] - === STARTING EXPERIMENT: d15-curriculum ===
[2025-08-14 08:10:29,147][__main__][INFO] - PID: 3113056
[2025-08-14 08:10:29,147][__main__][INFO] - SLURM_JOB_ID: 30051885
[2025-08-14 08:10:29,147][__main__][INFO] - NODE_RANK: unknown
[2025-08-14 08:10:29,147][__main__][INFO] - WORLD_SIZE: unknown
[2025-08-14 08:10:29,147][__main__][INFO] - MASTER_ADDR: unknown
[2025-08-14 08:10:29,147][__main__][INFO] - MASTER_PORT: unknown
[2025-08-14 08:10:29,147][__main__][INFO] - SLURM_NODEID: 0
[2025-08-14 08:10:29,147][__main__][INFO] - SLURM_NNODES: 1
[2025-08-14 08:10:29,147][__main__][INFO] - SLURM_NODELIST: holygpu8a17601
[2025-08-14 08:10:29,147][__main__][INFO] - Architecture: resnet50
[2025-08-14 08:10:29,147][__main__][INFO] - Embedding Dim: 128
[2025-08-14 08:10:29,148][__main__][INFO] - Learning Rate: 0.0004
[2025-08-14 08:10:29,148][__main__][INFO] - Weight Decay: 0.0
[2025-08-14 08:10:29,148][__main__][INFO] - Optimizer: schedulefree
[2025-08-14 08:10:29,148][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-14 08:10:29,148][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-14 08:10:29,148][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-14 08:10:29,148][__main__][INFO] - Channel Multipliers: [2, 2.5, 3, 3.5]
[2025-08-14 08:10:29,148][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-14 08:10:29,148][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-14 08:10:29,148][__main__][INFO] - Use LSTM: False
[2025-08-14 08:10:29,148][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-14 08:10:29,148][__main__][INFO] - Dataset: code_type=surface_code, d=15, rounds_list=[15], p=2.1
[2025-08-14 08:10:29,149][__main__][INFO] - === 3-STAGE CURRICULUM LEARNING ENABLED ===
[2025-08-14 08:10:29,149][__main__][INFO] - Stage 1: p=0.5 for 50000 steps
[2025-08-14 08:10:29,149][__main__][INFO] - Stage 2: p=0.5→2.1 over 50000 steps
[2025-08-14 08:10:29,149][__main__][INFO] - Stage 3: p=2.1 for 200000 steps
[2025-08-14 08:10:29,149][__main__][INFO] - Total curriculum steps: 300000
[2025-08-14 08:10:29,149][__main__][INFO] - Accelerator: auto
[2025-08-14 08:10:29,149][__main__][INFO] - Devices per node: 4
[2025-08-14 08:10:29,149][__main__][INFO] - Num Nodes: 1
[2025-08-14 08:10:29,149][__main__][INFO] - Total Devices: 4
[2025-08-14 08:10:29,149][__main__][INFO] - Strategy: auto
[2025-08-14 08:10:29,149][__main__][INFO] - Sync BatchNorm: True
[2025-08-14 08:10:29,150][__main__][INFO] - MWPM filtering: False
[2025-08-14 08:10:29,150][__main__][INFO] - Batch Size: auto-tuned
[2025-08-14 08:10:29,150][__main__][INFO] - Precision: bf16-mixed
[2025-08-14 08:10:29,150][__main__][INFO] - Max Steps: 300000 (curriculum override)
[2025-08-14 08:10:29,150][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-14 08:10:29,150][__main__][INFO] - Log every 100 steps
[2025-08-14 08:10:29,150][__main__][INFO] - Num Workers: 7
[2025-08-14 08:10:29,150][__main__][INFO] - Prefetch Factor: 4
[2025-08-14 08:10:29,150][__main__][INFO] - Persistent Workers: True
[2025-08-14 08:10:29,150][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d15-curriculum
[2025-08-14 08:10:29,165][__main__][INFO] - Found latest checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d15-curriculum/checkpoints/d15-curriculum-step=2150.ckpt
[2025-08-14 08:10:29,168][__main__][INFO] - Loaded W&B run ID from file: b3emqw4p
[2025-08-14 08:10:29,168][__main__][INFO] - Setting up W&B logger with existing run ID: b3emqw4p
[2025-08-14 08:10:29,169][__main__][INFO] - Initializing wandb logger with params
[2025-08-14 08:10:29,178][stage_manager][INFO] - Initialized 3-stage curriculum learning:
[2025-08-14 08:10:29,179][stage_manager][INFO] -   Stage 1: p=0.5 for 50000 steps
[2025-08-14 08:10:29,179][stage_manager][INFO] -   Stage 2: p=0.5→2.1 over 50000 steps
[2025-08-14 08:10:29,179][stage_manager][INFO] -   Stage 3: p=2.1 for 200000 steps
[2025-08-14 08:10:29,179][stage_manager][INFO] -   Total steps: 300000
[2025-08-14 08:10:29,322][__main__][INFO] - Loaded batch size 301 from file
[2025-08-14 08:10:29,322][__main__][INFO] - Effective total batch size across 4 device(s) on 1 node(s) with 1 accumulation steps: 1204
[2025-08-14 08:10:29,328][__main__][INFO] - Saved metadata: {'timestamp': 1755173429.3230577, 'slurm_job_id': '30051885', 'batch_size': 301, 'num_devices': 4, 'effective_batch_size': 1204}
[2025-08-14 08:10:36,659][data_module][INFO] - Set DataModule global_step_offset to 2150 (will apply when dataset is created)
[2025-08-14 08:10:36,662][__main__][INFO] - Updated DataModule global_step_offset to 2150 for resume
[2025-08-14 08:10:36,987][__main__][INFO] - === STARTING TRAINING ===
[2025-08-14 08:10:36,987][__main__][INFO] - Resuming from checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d15-curriculum/checkpoints/d15-curriculum-step=2150.ckpt
[2025-08-14 08:11:43,172][__main__][INFO] - Model loaded from checkpoint at global step 2150
[2025-08-14 08:11:43,423][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=15, rounds_list=[15], p=2.1, batch_size=301
[2025-08-14 08:11:43,423][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-14 10:37:07,717][__main__][INFO] - === STARTING EXPERIMENT: d15-curriculum ===
[2025-08-14 10:37:07,718][__main__][INFO] - PID: 2564256
[2025-08-14 10:37:07,718][__main__][INFO] - SLURM_JOB_ID: 30051885
[2025-08-14 10:37:07,718][__main__][INFO] - NODE_RANK: unknown
[2025-08-14 10:37:07,718][__main__][INFO] - WORLD_SIZE: unknown
[2025-08-14 10:37:07,718][__main__][INFO] - MASTER_ADDR: unknown
[2025-08-14 10:37:07,718][__main__][INFO] - MASTER_PORT: unknown
[2025-08-14 10:37:07,718][__main__][INFO] - SLURM_NODEID: 0
[2025-08-14 10:37:07,718][__main__][INFO] - SLURM_NNODES: 1
[2025-08-14 10:37:07,718][__main__][INFO] - SLURM_NODELIST: holygpu8a15202
[2025-08-14 10:37:07,718][__main__][INFO] - Architecture: resnet50
[2025-08-14 10:37:07,718][__main__][INFO] - Embedding Dim: 128
[2025-08-14 10:37:07,718][__main__][INFO] - Learning Rate: 0.0004
[2025-08-14 10:37:07,718][__main__][INFO] - Weight Decay: 0.0
[2025-08-14 10:37:07,719][__main__][INFO] - Optimizer: schedulefree
[2025-08-14 10:37:07,719][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-14 10:37:07,719][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-14 10:37:07,719][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-14 10:37:07,719][__main__][INFO] - Channel Multipliers: [2, 2.5, 3, 3.5]
[2025-08-14 10:37:07,719][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-14 10:37:07,719][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-14 10:37:07,719][__main__][INFO] - Use LSTM: False
[2025-08-14 10:37:07,719][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-14 10:37:07,719][__main__][INFO] - Dataset: code_type=surface_code, d=15, rounds_list=[15], p=2.1
[2025-08-14 10:37:07,719][__main__][INFO] - === 3-STAGE CURRICULUM LEARNING ENABLED ===
[2025-08-14 10:37:07,719][__main__][INFO] - Stage 1: p=0.5 for 50000 steps
[2025-08-14 10:37:07,719][__main__][INFO] - Stage 2: p=0.5→2.1 over 50000 steps
[2025-08-14 10:37:07,719][__main__][INFO] - Stage 3: p=2.1 for 200000 steps
[2025-08-14 10:37:07,719][__main__][INFO] - Total curriculum steps: 300000
[2025-08-14 10:37:07,719][__main__][INFO] - Accelerator: auto
[2025-08-14 10:37:07,719][__main__][INFO] - Devices per node: 4
[2025-08-14 10:37:07,720][__main__][INFO] - Num Nodes: 1
[2025-08-14 10:37:07,720][__main__][INFO] - Total Devices: 4
[2025-08-14 10:37:07,720][__main__][INFO] - Strategy: auto
[2025-08-14 10:37:07,720][__main__][INFO] - Sync BatchNorm: True
[2025-08-14 10:37:07,720][__main__][INFO] - MWPM filtering: False
[2025-08-14 10:37:07,720][__main__][INFO] - Batch Size: auto-tuned
[2025-08-14 10:37:07,720][__main__][INFO] - Precision: bf16-mixed
[2025-08-14 10:37:07,720][__main__][INFO] - Max Steps: 300000 (curriculum override)
[2025-08-14 10:37:07,720][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-14 10:37:07,720][__main__][INFO] - Log every 100 steps
[2025-08-14 10:37:07,720][__main__][INFO] - Num Workers: 7
[2025-08-14 10:37:07,720][__main__][INFO] - Prefetch Factor: 4
[2025-08-14 10:37:07,720][__main__][INFO] - Persistent Workers: True
[2025-08-14 10:37:07,720][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d15-curriculum
[2025-08-14 10:37:07,748][__main__][INFO] - Found latest checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d15-curriculum/checkpoints/d15-curriculum-step=2150.ckpt
[2025-08-14 10:37:07,753][__main__][INFO] - Loaded W&B run ID from file: b3emqw4p
[2025-08-14 10:37:07,754][__main__][INFO] - Setting up W&B logger with existing run ID: b3emqw4p
[2025-08-14 10:37:07,754][__main__][INFO] - Initializing wandb logger with params
[2025-08-14 10:37:07,763][stage_manager][INFO] - Initialized 3-stage curriculum learning:
[2025-08-14 10:37:07,763][stage_manager][INFO] -   Stage 1: p=0.5 for 50000 steps
[2025-08-14 10:37:07,763][stage_manager][INFO] -   Stage 2: p=0.5→2.1 over 50000 steps
[2025-08-14 10:37:07,763][stage_manager][INFO] -   Stage 3: p=2.1 for 200000 steps
[2025-08-14 10:37:07,763][stage_manager][INFO] -   Total steps: 300000
[2025-08-14 10:37:07,879][__main__][INFO] - Loaded batch size 301 from file
[2025-08-14 10:37:07,879][__main__][INFO] - Effective total batch size across 4 device(s) on 1 node(s) with 1 accumulation steps: 1204
[2025-08-14 10:37:07,885][__main__][INFO] - Saved metadata: {'timestamp': 1755182227.8800447, 'slurm_job_id': '30051885', 'batch_size': 301, 'num_devices': 4, 'effective_batch_size': 1204}
[2025-08-14 10:37:15,197][data_module][INFO] - Set DataModule global_step_offset to 2150 (will apply when dataset is created)
[2025-08-14 10:37:15,199][__main__][INFO] - Updated DataModule global_step_offset to 2150 for resume
[2025-08-14 10:37:15,507][__main__][INFO] - === STARTING TRAINING ===
[2025-08-14 10:37:15,507][__main__][INFO] - Resuming from checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d15-curriculum/checkpoints/d15-curriculum-step=2150.ckpt
[2025-08-14 10:38:19,644][__main__][INFO] - Model loaded from checkpoint at global step 2150
[2025-08-14 10:38:19,865][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=15, rounds_list=[15], p=2.1, batch_size=301
[2025-08-14 10:38:19,865][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-14 11:37:11,564][__main__][INFO] - === STARTING EXPERIMENT: d15-curriculum ===
[2025-08-14 11:37:11,565][__main__][INFO] - PID: 2153660
[2025-08-14 11:37:11,565][__main__][INFO] - SLURM_JOB_ID: 30051885
[2025-08-14 11:37:11,566][__main__][INFO] - NODE_RANK: unknown
[2025-08-14 11:37:11,566][__main__][INFO] - WORLD_SIZE: unknown
[2025-08-14 11:37:11,566][__main__][INFO] - MASTER_ADDR: unknown
[2025-08-14 11:37:11,566][__main__][INFO] - MASTER_PORT: unknown
[2025-08-14 11:37:11,566][__main__][INFO] - SLURM_NODEID: 0
[2025-08-14 11:37:11,566][__main__][INFO] - SLURM_NNODES: 1
[2025-08-14 11:37:11,566][__main__][INFO] - SLURM_NODELIST: holygpu8a11302
[2025-08-14 11:37:11,566][__main__][INFO] - Architecture: resnet50
[2025-08-14 11:37:11,566][__main__][INFO] - Embedding Dim: 128
[2025-08-14 11:37:11,566][__main__][INFO] - Learning Rate: 0.0004
[2025-08-14 11:37:11,566][__main__][INFO] - Weight Decay: 0.0
[2025-08-14 11:37:11,566][__main__][INFO] - Optimizer: schedulefree
[2025-08-14 11:37:11,566][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-14 11:37:11,566][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-14 11:37:11,566][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-14 11:37:11,566][__main__][INFO] - Channel Multipliers: [2, 2.5, 3, 3.5]
[2025-08-14 11:37:11,566][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-14 11:37:11,566][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-14 11:37:11,566][__main__][INFO] - Use LSTM: False
[2025-08-14 11:37:11,566][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-14 11:37:11,567][__main__][INFO] - Dataset: code_type=surface_code, d=15, rounds_list=[15], p=2.1
[2025-08-14 11:37:11,567][__main__][INFO] - === 3-STAGE CURRICULUM LEARNING ENABLED ===
[2025-08-14 11:37:11,567][__main__][INFO] - Stage 1: p=0.5 for 50000 steps
[2025-08-14 11:37:11,567][__main__][INFO] - Stage 2: p=0.5→2.1 over 50000 steps
[2025-08-14 11:37:11,567][__main__][INFO] - Stage 3: p=2.1 for 200000 steps
[2025-08-14 11:37:11,567][__main__][INFO] - Total curriculum steps: 300000
[2025-08-14 11:37:11,567][__main__][INFO] - Accelerator: auto
[2025-08-14 11:37:11,567][__main__][INFO] - Devices per node: 4
[2025-08-14 11:37:11,567][__main__][INFO] - Num Nodes: 1
[2025-08-14 11:37:11,567][__main__][INFO] - Total Devices: 4
[2025-08-14 11:37:11,567][__main__][INFO] - Strategy: auto
[2025-08-14 11:37:11,567][__main__][INFO] - Sync BatchNorm: True
[2025-08-14 11:37:11,567][__main__][INFO] - MWPM filtering: False
[2025-08-14 11:37:11,567][__main__][INFO] - Batch Size: auto-tuned
[2025-08-14 11:37:11,567][__main__][INFO] - Precision: bf16-mixed
[2025-08-14 11:37:11,567][__main__][INFO] - Max Steps: 300000 (curriculum override)
[2025-08-14 11:37:11,567][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-14 11:37:11,567][__main__][INFO] - Log every 100 steps
[2025-08-14 11:37:11,568][__main__][INFO] - Num Workers: 7
[2025-08-14 11:37:11,568][__main__][INFO] - Prefetch Factor: 4
[2025-08-14 11:37:11,568][__main__][INFO] - Persistent Workers: True
[2025-08-14 11:37:11,568][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d15-curriculum
[2025-08-14 11:37:11,651][__main__][INFO] - Found latest checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d15-curriculum/checkpoints/d15-curriculum-step=4261.ckpt
[2025-08-14 11:37:11,657][__main__][INFO] - Loaded W&B run ID from file: b3emqw4p
[2025-08-14 11:37:11,657][__main__][INFO] - Setting up W&B logger with existing run ID: b3emqw4p
[2025-08-14 11:37:11,657][__main__][INFO] - Initializing wandb logger with params
[2025-08-14 11:37:11,663][stage_manager][INFO] - Initialized 3-stage curriculum learning:
[2025-08-14 11:37:11,663][stage_manager][INFO] -   Stage 1: p=0.5 for 50000 steps
[2025-08-14 11:37:11,663][stage_manager][INFO] -   Stage 2: p=0.5→2.1 over 50000 steps
[2025-08-14 11:37:11,663][stage_manager][INFO] -   Stage 3: p=2.1 for 200000 steps
[2025-08-14 11:37:11,663][stage_manager][INFO] -   Total steps: 300000
[2025-08-14 11:37:11,770][__main__][INFO] - Loaded batch size 301 from file
[2025-08-14 11:37:11,770][__main__][INFO] - Effective total batch size across 4 device(s) on 1 node(s) with 1 accumulation steps: 1204
[2025-08-14 11:37:11,785][__main__][INFO] - Saved metadata: {'timestamp': 1755185831.770719, 'slurm_job_id': '30051885', 'batch_size': 301, 'num_devices': 4, 'effective_batch_size': 1204}
[2025-08-14 11:37:17,483][data_module][INFO] - Set DataModule global_step_offset to 4261 (will apply when dataset is created)
[2025-08-14 11:37:17,483][__main__][INFO] - Updated DataModule global_step_offset to 4261 for resume
[2025-08-14 11:37:17,787][__main__][INFO] - === STARTING TRAINING ===
[2025-08-14 11:37:17,787][__main__][INFO] - Resuming from checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d15-curriculum/checkpoints/d15-curriculum-step=4261.ckpt
[2025-08-14 11:38:15,118][__main__][INFO] - Model loaded from checkpoint at global step 4261
[2025-08-14 11:38:15,281][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=15, rounds_list=[15], p=2.1, batch_size=301
[2025-08-14 11:38:15,281][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-14 12:44:08,599][__main__][INFO] - === STARTING EXPERIMENT: d15-curriculum ===
[2025-08-14 12:44:08,601][__main__][INFO] - PID: 782179
[2025-08-14 12:44:08,601][__main__][INFO] - SLURM_JOB_ID: 30051885
[2025-08-14 12:44:08,601][__main__][INFO] - NODE_RANK: unknown
[2025-08-14 12:44:08,602][__main__][INFO] - WORLD_SIZE: unknown
[2025-08-14 12:44:08,602][__main__][INFO] - MASTER_ADDR: unknown
[2025-08-14 12:44:08,602][__main__][INFO] - MASTER_PORT: unknown
[2025-08-14 12:44:08,602][__main__][INFO] - SLURM_NODEID: 0
[2025-08-14 12:44:08,602][__main__][INFO] - SLURM_NNODES: 1
[2025-08-14 12:44:08,602][__main__][INFO] - SLURM_NODELIST: holygpu8a26504
[2025-08-14 12:44:08,602][__main__][INFO] - Architecture: resnet50
[2025-08-14 12:44:08,602][__main__][INFO] - Embedding Dim: 128
[2025-08-14 12:44:08,602][__main__][INFO] - Learning Rate: 0.0004
[2025-08-14 12:44:08,602][__main__][INFO] - Weight Decay: 0.0
[2025-08-14 12:44:08,602][__main__][INFO] - Optimizer: schedulefree
[2025-08-14 12:44:08,602][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-14 12:44:08,602][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-14 12:44:08,603][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-14 12:44:08,603][__main__][INFO] - Channel Multipliers: [2, 2.5, 3, 3.5]
[2025-08-14 12:44:08,603][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-14 12:44:08,603][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-14 12:44:08,603][__main__][INFO] - Use LSTM: False
[2025-08-14 12:44:08,603][__main__][INFO] - Chunking: [1, 1, 1]
[2025-08-14 12:44:08,603][__main__][INFO] - Dataset: code_type=surface_code, d=15, rounds_list=[15], p=2.1
[2025-08-14 12:44:08,603][__main__][INFO] - === 3-STAGE CURRICULUM LEARNING ENABLED ===
[2025-08-14 12:44:08,603][__main__][INFO] - Stage 1: p=0.5 for 50000 steps
[2025-08-14 12:44:08,604][__main__][INFO] - Stage 2: p=0.5→2.1 over 50000 steps
[2025-08-14 12:44:08,604][__main__][INFO] - Stage 3: p=2.1 for 200000 steps
[2025-08-14 12:44:08,604][__main__][INFO] - Total curriculum steps: 300000
[2025-08-14 12:44:08,604][__main__][INFO] - Accelerator: auto
[2025-08-14 12:44:08,604][__main__][INFO] - Devices per node: 4
[2025-08-14 12:44:08,604][__main__][INFO] - Num Nodes: 1
[2025-08-14 12:44:08,604][__main__][INFO] - Total Devices: 4
[2025-08-14 12:44:08,604][__main__][INFO] - Strategy: auto
[2025-08-14 12:44:08,604][__main__][INFO] - Sync BatchNorm: True
[2025-08-14 12:44:08,604][__main__][INFO] - MWPM filtering: False
[2025-08-14 12:44:08,605][__main__][INFO] - Batch Size: auto-tuned
[2025-08-14 12:44:08,605][__main__][INFO] - Precision: bf16-mixed
[2025-08-14 12:44:08,605][__main__][INFO] - Max Steps: 300000 (curriculum override)
[2025-08-14 12:44:08,605][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-14 12:44:08,605][__main__][INFO] - Log every 100 steps
[2025-08-14 12:44:08,605][__main__][INFO] - Num Workers: 7
[2025-08-14 12:44:08,605][__main__][INFO] - Prefetch Factor: 4
[2025-08-14 12:44:08,605][__main__][INFO] - Persistent Workers: True
[2025-08-14 12:44:08,605][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d15-curriculum
[2025-08-14 12:44:08,641][__main__][INFO] - Found latest checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d15-curriculum/checkpoints/d15-curriculum-step=4261.ckpt
[2025-08-14 12:44:08,647][__main__][INFO] - Loaded W&B run ID from file: b3emqw4p
[2025-08-14 12:44:08,648][__main__][INFO] - Setting up W&B logger with existing run ID: b3emqw4p
[2025-08-14 12:44:08,648][__main__][INFO] - Initializing wandb logger with params
[2025-08-14 12:44:08,653][stage_manager][INFO] - Initialized 3-stage curriculum learning:
[2025-08-14 12:44:08,653][stage_manager][INFO] -   Stage 1: p=0.5 for 50000 steps
[2025-08-14 12:44:08,653][stage_manager][INFO] -   Stage 2: p=0.5→2.1 over 50000 steps
[2025-08-14 12:44:08,653][stage_manager][INFO] -   Stage 3: p=2.1 for 200000 steps
[2025-08-14 12:44:08,653][stage_manager][INFO] -   Total steps: 300000
[2025-08-14 12:44:08,746][__main__][INFO] - Loaded batch size 301 from file
[2025-08-14 12:44:08,746][__main__][INFO] - Effective total batch size across 4 device(s) on 1 node(s) with 1 accumulation steps: 1204
[2025-08-14 12:44:08,754][__main__][INFO] - Saved metadata: {'timestamp': 1755189848.747087, 'slurm_job_id': '30051885', 'batch_size': 301, 'num_devices': 4, 'effective_batch_size': 1204}
[2025-08-14 12:44:12,077][data_module][INFO] - Set DataModule global_step_offset to 4261 (will apply when dataset is created)
[2025-08-14 12:44:12,078][__main__][INFO] - Updated DataModule global_step_offset to 4261 for resume
[2025-08-14 12:44:12,393][__main__][INFO] - === STARTING TRAINING ===
[2025-08-14 12:44:12,393][__main__][INFO] - Resuming from checkpoint: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d15-curriculum/checkpoints/d15-curriculum-step=4261.ckpt
[2025-08-14 12:45:17,219][__main__][INFO] - Model loaded from checkpoint at global step 4261
[2025-08-14 12:45:17,345][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=15, rounds_list=[15], p=2.1, batch_size=301
[2025-08-14 12:45:17,346][data_module][INFO] - Dataset configured for curriculum learning
[2025-08-14 15:30:09,755][__main__][INFO] - === STARTING EXPERIMENT: d9-test ===
[2025-08-14 15:30:09,755][__main__][INFO] - PID: 1014851
[2025-08-14 15:30:09,755][__main__][INFO] - SLURM_JOB_ID: 30182809
[2025-08-14 15:30:09,756][__main__][INFO] - NODE_RANK: unknown
[2025-08-14 15:30:09,756][__main__][INFO] - WORLD_SIZE: unknown
[2025-08-14 15:30:09,756][__main__][INFO] - MASTER_ADDR: unknown
[2025-08-14 15:30:09,756][__main__][INFO] - MASTER_PORT: unknown
[2025-08-14 15:30:09,756][__main__][INFO] - SLURM_NODEID: 0
[2025-08-14 15:30:09,756][__main__][INFO] - SLURM_NNODES: 1
[2025-08-14 15:30:09,756][__main__][INFO] - SLURM_NODELIST: holygpu7c26201
[2025-08-14 15:30:09,756][__main__][INFO] - Architecture: resnet50
[2025-08-14 15:30:09,756][__main__][INFO] - Embedding Dim: 64
[2025-08-14 15:30:09,756][__main__][INFO] - Learning Rate: 0.001
[2025-08-14 15:30:09,756][__main__][INFO] - Weight Decay: 0.0
[2025-08-14 15:30:09,756][__main__][INFO] - Optimizer: schedulefree
[2025-08-14 15:30:09,756][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-14 15:30:09,756][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-14 15:30:09,756][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-14 15:30:09,756][__main__][INFO] - Channel Multipliers: [2, 4, 8, 16]
[2025-08-14 15:31:34,503][__main__][INFO] - === STARTING EXPERIMENT: d9-test ===
[2025-08-14 15:31:34,503][__main__][INFO] - PID: 1015162
[2025-08-14 15:31:34,503][__main__][INFO] - SLURM_JOB_ID: 30182809
[2025-08-14 15:31:34,503][__main__][INFO] - NODE_RANK: unknown
[2025-08-14 15:31:34,503][__main__][INFO] - WORLD_SIZE: unknown
[2025-08-14 15:31:34,503][__main__][INFO] - MASTER_ADDR: unknown
[2025-08-14 15:31:34,503][__main__][INFO] - MASTER_PORT: unknown
[2025-08-14 15:31:34,503][__main__][INFO] - SLURM_NODEID: 0
[2025-08-14 15:31:34,504][__main__][INFO] - SLURM_NNODES: 1
[2025-08-14 15:31:34,504][__main__][INFO] - SLURM_NODELIST: holygpu7c26201
[2025-08-14 15:31:34,504][__main__][INFO] - Architecture: resnet50
[2025-08-14 15:31:34,504][__main__][INFO] - Embedding Dim: 64
[2025-08-14 15:31:34,504][__main__][INFO] - Learning Rate: 0.001
[2025-08-14 15:31:34,504][__main__][INFO] - Weight Decay: 0.0
[2025-08-14 15:31:34,504][__main__][INFO] - Optimizer: schedulefree
[2025-08-14 15:31:34,504][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-14 15:31:34,504][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-14 15:31:34,504][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-14 15:31:34,504][__main__][INFO] - Channel Multipliers: [2, 4, 8, 16]
[2025-08-14 15:31:34,504][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-14 15:31:34,504][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-14 15:31:34,505][__main__][INFO] - Use LSTM: False
[2025-08-14 15:35:02,285][__main__][INFO] - === STARTING EXPERIMENT: d9-test ===
[2025-08-14 15:35:02,285][__main__][INFO] - PID: 1016779
[2025-08-14 15:35:02,285][__main__][INFO] - SLURM_JOB_ID: 30182809
[2025-08-14 15:35:02,285][__main__][INFO] - NODE_RANK: unknown
[2025-08-14 15:35:02,285][__main__][INFO] - WORLD_SIZE: unknown
[2025-08-14 15:35:02,285][__main__][INFO] - MASTER_ADDR: unknown
[2025-08-14 15:35:02,285][__main__][INFO] - MASTER_PORT: unknown
[2025-08-14 15:35:02,285][__main__][INFO] - SLURM_NODEID: 0
[2025-08-14 15:35:02,285][__main__][INFO] - SLURM_NNODES: 1
[2025-08-14 15:35:02,286][__main__][INFO] - SLURM_NODELIST: holygpu7c26201
[2025-08-14 15:35:02,286][__main__][INFO] - Architecture: resnet50
[2025-08-14 15:35:02,286][__main__][INFO] - Embedding Dim: 64
[2025-08-14 15:35:02,286][__main__][INFO] - Learning Rate: 0.001
[2025-08-14 15:35:02,286][__main__][INFO] - Weight Decay: 0.0
[2025-08-14 15:35:02,286][__main__][INFO] - Optimizer: schedulefree
[2025-08-14 15:35:02,286][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-14 15:35:02,286][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-14 15:35:02,286][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-14 15:35:02,286][__main__][INFO] - Channel Multipliers: [2, 4, 8, 16]
[2025-08-14 15:35:02,286][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-14 15:35:02,286][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-14 15:35:02,286][__main__][INFO] - Use LSTM: False
[2025-08-14 15:36:52,978][__main__][INFO] - === STARTING EXPERIMENT: d9-test ===
[2025-08-14 15:36:52,978][__main__][INFO] - PID: 1017064
[2025-08-14 15:36:52,978][__main__][INFO] - SLURM_JOB_ID: 30182809
[2025-08-14 15:36:52,978][__main__][INFO] - NODE_RANK: unknown
[2025-08-14 15:36:52,978][__main__][INFO] - WORLD_SIZE: unknown
[2025-08-14 15:36:52,978][__main__][INFO] - MASTER_ADDR: unknown
[2025-08-14 15:36:52,978][__main__][INFO] - MASTER_PORT: unknown
[2025-08-14 15:36:52,978][__main__][INFO] - SLURM_NODEID: 0
[2025-08-14 15:36:52,978][__main__][INFO] - SLURM_NNODES: 1
[2025-08-14 15:36:52,978][__main__][INFO] - SLURM_NODELIST: holygpu7c26201
[2025-08-14 15:36:52,978][__main__][INFO] - Architecture: resnet50
[2025-08-14 15:36:52,978][__main__][INFO] - Embedding Dim: 64
[2025-08-14 15:36:52,978][__main__][INFO] - Learning Rate: 0.001
[2025-08-14 15:36:52,978][__main__][INFO] - Weight Decay: 0.0
[2025-08-14 15:36:52,979][__main__][INFO] - Optimizer: schedulefree
[2025-08-14 15:36:52,979][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-14 15:36:52,979][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-14 15:36:52,979][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-14 15:36:52,979][__main__][INFO] - Channel Multipliers: [2, 4, 8, 16]
[2025-08-14 15:36:52,979][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-14 15:36:52,979][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-14 15:36:52,979][__main__][INFO] - Use LSTM: False
[2025-08-14 15:36:52,979][__main__][INFO] - Num Embeddings: 1521
[2025-08-14 15:36:52,979][__main__][INFO] - Dataset: code_type=surface_code, d=9, rounds=9, p=0.5
[2025-08-14 15:36:52,979][__main__][INFO] - Standard training (no curriculum)
[2025-08-14 15:36:52,980][__main__][INFO] - Accelerator: auto
[2025-08-14 15:36:52,980][__main__][INFO] - Devices per node: auto
[2025-08-14 15:36:52,980][__main__][INFO] - Num Nodes: 1
[2025-08-14 15:36:52,980][__main__][INFO] - Total Devices: 1
[2025-08-14 15:36:52,980][__main__][INFO] - Strategy: auto
[2025-08-14 15:36:52,980][__main__][INFO] - Sync BatchNorm: True
[2025-08-14 15:36:52,980][__main__][INFO] - MWPM filtering: False
[2025-08-14 15:36:52,980][__main__][INFO] - Batch Size: auto-tuned
[2025-08-14 15:36:52,980][__main__][INFO] - Precision: bf16-mixed
[2025-08-14 15:36:52,980][__main__][INFO] - Max Steps: 50000
[2025-08-14 15:36:52,980][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-14 15:36:52,980][__main__][INFO] - Log every 100 steps
[2025-08-14 15:36:52,980][__main__][INFO] - Num Workers: 8
[2025-08-14 15:36:52,980][__main__][INFO] - Prefetch Factor: 4
[2025-08-14 15:36:52,981][__main__][INFO] - Persistent Workers: True
[2025-08-14 15:36:52,981][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d9-test
[2025-08-14 15:36:53,028][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-14 15:36:53,029][__main__][INFO] - Initializing wandb logger with params
[2025-08-14 15:36:55,657][__main__][INFO] - Saved new W&B run ID to file: 6axtsy8r
[2025-08-14 15:36:55,777][__main__][INFO] - === AUTO-TUNING BATCH SIZE (RANK 0) ===
[2025-08-14 15:36:56,799][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=2
[2025-08-14 15:38:44,216][__main__][INFO] - === STARTING EXPERIMENT: d9-test ===
[2025-08-14 15:38:44,216][__main__][INFO] - PID: 1017333
[2025-08-14 15:38:44,216][__main__][INFO] - SLURM_JOB_ID: 30182809
[2025-08-14 15:38:44,216][__main__][INFO] - NODE_RANK: unknown
[2025-08-14 15:38:44,216][__main__][INFO] - WORLD_SIZE: unknown
[2025-08-14 15:38:44,216][__main__][INFO] - MASTER_ADDR: unknown
[2025-08-14 15:38:44,216][__main__][INFO] - MASTER_PORT: unknown
[2025-08-14 15:38:44,216][__main__][INFO] - SLURM_NODEID: 0
[2025-08-14 15:38:44,216][__main__][INFO] - SLURM_NNODES: 1
[2025-08-14 15:38:44,216][__main__][INFO] - SLURM_NODELIST: holygpu7c26201
[2025-08-14 15:38:44,216][__main__][INFO] - Architecture: resnet50
[2025-08-14 15:38:44,216][__main__][INFO] - Embedding Dim: 64
[2025-08-14 15:38:44,217][__main__][INFO] - Learning Rate: 0.001
[2025-08-14 15:38:44,217][__main__][INFO] - Weight Decay: 0.0
[2025-08-14 15:38:44,217][__main__][INFO] - Optimizer: schedulefree
[2025-08-14 15:38:44,217][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-14 15:38:44,217][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-14 15:38:44,217][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-14 15:38:44,217][__main__][INFO] - Channel Multipliers: [2, 4, 8, 16]
[2025-08-14 15:38:44,217][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-14 15:38:44,217][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-14 15:38:44,217][__main__][INFO] - Use LSTM: False
[2025-08-14 15:38:44,217][__main__][INFO] - Num Embeddings: 1521
[2025-08-14 15:38:44,217][__main__][INFO] - Dataset: code_type=surface_code, d=9, rounds=9, p=0.5
[2025-08-14 15:38:44,217][__main__][INFO] - Standard training (no curriculum)
[2025-08-14 15:38:44,218][__main__][INFO] - Accelerator: auto
[2025-08-14 15:38:44,218][__main__][INFO] - Devices per node: auto
[2025-08-14 15:38:44,218][__main__][INFO] - Num Nodes: 1
[2025-08-14 15:38:44,218][__main__][INFO] - Total Devices: 1
[2025-08-14 15:38:44,218][__main__][INFO] - Strategy: auto
[2025-08-14 15:38:44,218][__main__][INFO] - Sync BatchNorm: True
[2025-08-14 15:38:44,218][__main__][INFO] - MWPM filtering: False
[2025-08-14 15:38:44,218][__main__][INFO] - Batch Size: auto-tuned
[2025-08-14 15:38:44,218][__main__][INFO] - Precision: bf16-mixed
[2025-08-14 15:38:44,218][__main__][INFO] - Max Steps: 50000
[2025-08-14 15:38:44,218][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-14 15:38:44,218][__main__][INFO] - Log every 100 steps
[2025-08-14 15:38:44,218][__main__][INFO] - Num Workers: 8
[2025-08-14 15:38:44,219][__main__][INFO] - Prefetch Factor: 4
[2025-08-14 15:38:44,219][__main__][INFO] - Persistent Workers: True
[2025-08-14 15:38:44,219][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d9-test
[2025-08-14 15:38:44,240][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-14 15:38:44,240][__main__][INFO] - Initializing wandb logger with params
[2025-08-14 15:38:46,327][__main__][INFO] - Saved new W&B run ID to file: 9km2nf09
[2025-08-14 15:38:46,417][__main__][INFO] - === AUTO-TUNING BATCH SIZE (RANK 0) ===
[2025-08-14 15:38:47,239][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=2
[2025-08-14 15:38:53,455][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=4
[2025-08-14 15:38:55,118][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=8
[2025-08-14 15:38:56,252][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=16
[2025-08-14 15:38:57,187][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=32
[2025-08-14 15:38:58,386][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=64
[2025-08-14 15:39:00,149][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=128
[2025-08-14 15:39:03,008][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=256
[2025-08-14 15:39:08,109][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=512
[2025-08-14 15:39:09,464][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=384
[2025-08-14 15:39:10,916][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=320
[2025-08-14 15:39:12,110][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=288
[2025-08-14 15:39:18,089][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=304
[2025-08-14 15:39:19,376][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=296
[2025-08-14 15:39:20,588][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=292
[2025-08-14 15:39:26,660][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=294
[2025-08-14 15:39:27,849][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=293
[2025-08-14 15:39:28,979][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=292
[2025-08-14 15:39:29,485][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=292
[2025-08-14 15:39:30,481][__main__][INFO] - Model loaded from checkpoint at global step 0
[2025-08-14 15:39:30,592][__main__][INFO] - Found optimal batch size 292
[2025-08-14 15:39:30,599][__main__][INFO] - Saved batch size 248 to file
[2025-08-14 15:39:30,599][__main__][INFO] - Optimal per-GPU batch size found: 248
[2025-08-14 15:39:30,599][__main__][INFO] - Effective total batch size across 1 device(s) on 1 node(s) with 1 accumulation steps: 248
[2025-08-14 15:39:30,605][__main__][INFO] - Saved metadata: {'timestamp': 1755200370.6000326, 'slurm_job_id': '30182809', 'batch_size': 248, 'num_devices': 1, 'effective_batch_size': 248}
[2025-08-14 15:39:31,021][__main__][INFO] - === STARTING TRAINING ===
[2025-08-14 15:39:31,054][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=248
[2025-08-14 15:49:49,768][__main__][INFO] - === STARTING EXPERIMENT: d9-test ===
[2025-08-14 15:49:49,768][__main__][INFO] - PID: 1020168
[2025-08-14 15:49:49,768][__main__][INFO] - SLURM_JOB_ID: 30182809
[2025-08-14 15:49:49,768][__main__][INFO] - NODE_RANK: unknown
[2025-08-14 15:49:49,768][__main__][INFO] - WORLD_SIZE: unknown
[2025-08-14 15:49:49,768][__main__][INFO] - MASTER_ADDR: unknown
[2025-08-14 15:49:49,768][__main__][INFO] - MASTER_PORT: unknown
[2025-08-14 15:49:49,769][__main__][INFO] - SLURM_NODEID: 0
[2025-08-14 15:49:49,769][__main__][INFO] - SLURM_NNODES: 1
[2025-08-14 15:49:49,769][__main__][INFO] - SLURM_NODELIST: holygpu7c26201
[2025-08-14 15:49:49,769][__main__][INFO] - Architecture: resnet50
[2025-08-14 15:49:49,769][__main__][INFO] - Embedding Dim: 64
[2025-08-14 15:49:49,769][__main__][INFO] - Learning Rate: 0.001
[2025-08-14 15:49:49,769][__main__][INFO] - Weight Decay: 0.0
[2025-08-14 15:49:49,769][__main__][INFO] - Optimizer: schedulefree
[2025-08-14 15:49:49,769][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-14 15:49:49,769][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-14 15:49:49,769][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-14 15:49:49,769][__main__][INFO] - Channel Multipliers: [2, 4, 8, 16]
[2025-08-14 15:49:49,769][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-14 15:49:49,770][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-14 15:49:49,770][__main__][INFO] - Use LSTM: False
[2025-08-14 15:49:49,770][__main__][INFO] - Num Embeddings: 1521
[2025-08-14 15:49:49,770][__main__][INFO] - Dataset: code_type=surface_code, d=9, rounds=9, p=0.5
[2025-08-14 15:49:49,770][__main__][INFO] - Standard training (no curriculum)
[2025-08-14 15:49:49,770][__main__][INFO] - Accelerator: auto
[2025-08-14 15:49:49,770][__main__][INFO] - Devices per node: auto
[2025-08-14 15:49:49,770][__main__][INFO] - Num Nodes: 1
[2025-08-14 15:49:49,770][__main__][INFO] - Total Devices: 1
[2025-08-14 15:49:49,770][__main__][INFO] - Strategy: auto
[2025-08-14 15:49:49,770][__main__][INFO] - Sync BatchNorm: True
[2025-08-14 15:49:49,770][__main__][INFO] - MWPM filtering: False
[2025-08-14 15:49:49,770][__main__][INFO] - Batch Size: auto-tuned
[2025-08-14 15:49:49,771][__main__][INFO] - Precision: bf16-mixed
[2025-08-14 15:49:49,771][__main__][INFO] - Max Steps: 50000
[2025-08-14 15:49:49,771][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-14 15:49:49,771][__main__][INFO] - Log every 100 steps
[2025-08-14 15:49:49,771][__main__][INFO] - Num Workers: 8
[2025-08-14 15:49:49,771][__main__][INFO] - Prefetch Factor: 4
[2025-08-14 15:49:49,771][__main__][INFO] - Persistent Workers: True
[2025-08-14 15:49:49,771][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d9-test
[2025-08-14 15:49:49,776][__main__][INFO] - Loaded W&B run ID from file: 9km2nf09
[2025-08-14 15:49:49,777][__main__][INFO] - Setting up W&B logger with existing run ID: 9km2nf09
[2025-08-14 15:49:49,777][__main__][INFO] - Initializing wandb logger with params
[2025-08-14 15:49:49,851][__main__][INFO] - Compiling model with mode='default', fullgraph=False, dynamic=None
[2025-08-14 15:49:54,554][__main__][INFO] - Model compilation enabled - first batch will be slower due to compilation overhead
[2025-08-14 15:49:54,576][__main__][INFO] - Loaded batch size 248 from file
[2025-08-14 15:49:54,576][__main__][INFO] - Effective total batch size across 1 device(s) on 1 node(s) with 1 accumulation steps: 248
[2025-08-14 15:49:54,584][__main__][INFO] - Saved metadata: {'timestamp': 1755200994.5762625, 'slurm_job_id': '30182809', 'batch_size': 248, 'num_devices': 1, 'effective_batch_size': 248}
[2025-08-14 15:51:43,282][__main__][INFO] - === STARTING EXPERIMENT: d9-test ===
[2025-08-14 15:51:43,282][__main__][INFO] - PID: 1020617
[2025-08-14 15:51:43,282][__main__][INFO] - SLURM_JOB_ID: 30182809
[2025-08-14 15:51:43,282][__main__][INFO] - NODE_RANK: unknown
[2025-08-14 15:51:43,282][__main__][INFO] - WORLD_SIZE: unknown
[2025-08-14 15:51:43,282][__main__][INFO] - MASTER_ADDR: unknown
[2025-08-14 15:51:43,282][__main__][INFO] - MASTER_PORT: unknown
[2025-08-14 15:51:43,282][__main__][INFO] - SLURM_NODEID: 0
[2025-08-14 15:51:43,282][__main__][INFO] - SLURM_NNODES: 1
[2025-08-14 15:51:43,282][__main__][INFO] - SLURM_NODELIST: holygpu7c26201
[2025-08-14 15:51:43,283][__main__][INFO] - Architecture: resnet50
[2025-08-14 15:51:43,283][__main__][INFO] - Embedding Dim: 64
[2025-08-14 15:51:43,283][__main__][INFO] - Learning Rate: 0.001
[2025-08-14 15:51:43,283][__main__][INFO] - Weight Decay: 0.0
[2025-08-14 15:51:43,283][__main__][INFO] - Optimizer: schedulefree
[2025-08-14 15:51:43,283][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-14 15:51:43,283][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-14 15:51:43,283][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-14 15:51:43,283][__main__][INFO] - Channel Multipliers: [2, 4, 8, 16]
[2025-08-14 15:51:43,283][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-14 15:51:43,283][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-14 15:51:43,283][__main__][INFO] - Use LSTM: False
[2025-08-14 15:51:43,283][__main__][INFO] - Num Embeddings: 1521
[2025-08-14 15:51:43,284][__main__][INFO] - Dataset: code_type=surface_code, d=9, rounds=9, p=0.5
[2025-08-14 15:51:43,284][__main__][INFO] - Standard training (no curriculum)
[2025-08-14 15:51:43,284][__main__][INFO] - Accelerator: auto
[2025-08-14 15:51:43,284][__main__][INFO] - Devices per node: auto
[2025-08-14 15:51:43,284][__main__][INFO] - Num Nodes: 1
[2025-08-14 15:51:43,284][__main__][INFO] - Total Devices: 1
[2025-08-14 15:51:43,284][__main__][INFO] - Strategy: auto
[2025-08-14 15:51:43,284][__main__][INFO] - Sync BatchNorm: True
[2025-08-14 15:51:43,284][__main__][INFO] - MWPM filtering: False
[2025-08-14 15:51:43,284][__main__][INFO] - Batch Size: auto-tuned
[2025-08-14 15:51:43,284][__main__][INFO] - Precision: bf16-mixed
[2025-08-14 15:51:43,284][__main__][INFO] - Max Steps: 50000
[2025-08-14 15:51:43,285][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-14 15:51:43,285][__main__][INFO] - Log every 100 steps
[2025-08-14 15:51:43,285][__main__][INFO] - Num Workers: 8
[2025-08-14 15:51:43,285][__main__][INFO] - Prefetch Factor: 4
[2025-08-14 15:51:43,285][__main__][INFO] - Persistent Workers: True
[2025-08-14 15:51:43,285][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d9-test
[2025-08-14 15:51:43,299][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-14 15:51:43,299][__main__][INFO] - Initializing wandb logger with params
[2025-08-14 15:51:45,502][__main__][INFO] - Saved new W&B run ID to file: 15lyjord
[2025-08-14 15:51:45,572][__main__][INFO] - Compiling model with mode='default', fullgraph=False, dynamic=None
[2025-08-14 15:51:47,218][__main__][INFO] - Model compilation enabled - first batch will be slower due to compilation overhead
[2025-08-14 15:51:47,238][__main__][INFO] - === AUTO-TUNING BATCH SIZE (RANK 0) ===
[2025-08-14 15:51:48,064][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=2
[2025-08-14 15:52:44,775][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=4
[2025-08-14 15:53:21,647][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=8
[2025-08-14 15:53:23,180][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=16
[2025-08-14 15:53:24,714][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=32
[2025-08-14 15:53:26,517][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=64
[2025-08-14 15:53:28,836][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=128
[2025-08-14 15:53:32,213][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=256
[2025-08-14 15:53:37,764][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=512
[2025-08-14 15:53:40,099][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=384
[2025-08-14 15:53:48,173][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=448
[2025-08-14 15:53:50,867][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=416
[2025-08-14 15:53:53,631][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=400
[2025-08-14 15:53:56,177][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=392
[2025-08-14 15:53:59,466][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=388
[2025-08-14 15:54:07,623][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=390
[2025-08-14 15:54:10,854][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=389
[2025-08-14 15:54:19,860][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=389
[2025-08-14 15:54:20,935][__main__][INFO] - Model loaded from checkpoint at global step 0
[2025-08-14 15:54:21,061][__main__][INFO] - Found optimal batch size 389
[2025-08-14 15:54:21,069][__main__][INFO] - Saved batch size 330 to file
[2025-08-14 15:54:21,069][__main__][INFO] - Optimal per-GPU batch size found: 330
[2025-08-14 15:54:21,069][__main__][INFO] - Effective total batch size across 1 device(s) on 1 node(s) with 1 accumulation steps: 330
[2025-08-14 15:54:21,073][__main__][INFO] - Saved metadata: {'timestamp': 1755201261.069781, 'slurm_job_id': '30182809', 'batch_size': 330, 'num_devices': 1, 'effective_batch_size': 330}
[2025-08-14 15:54:21,518][__main__][INFO] - === STARTING TRAINING ===
[2025-08-14 15:54:21,554][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=330
[2025-08-14 16:00:21,804][__main__][INFO] - === STARTING EXPERIMENT: d9-test ===
[2025-08-14 16:00:21,805][__main__][INFO] - PID: 1026602
[2025-08-14 16:00:21,805][__main__][INFO] - SLURM_JOB_ID: 30182809
[2025-08-14 16:00:21,805][__main__][INFO] - NODE_RANK: unknown
[2025-08-14 16:00:21,805][__main__][INFO] - WORLD_SIZE: unknown
[2025-08-14 16:00:21,805][__main__][INFO] - MASTER_ADDR: unknown
[2025-08-14 16:00:21,805][__main__][INFO] - MASTER_PORT: unknown
[2025-08-14 16:00:21,805][__main__][INFO] - SLURM_NODEID: 0
[2025-08-14 16:00:21,805][__main__][INFO] - SLURM_NNODES: 1
[2025-08-14 16:00:21,805][__main__][INFO] - SLURM_NODELIST: holygpu7c26201
[2025-08-14 16:00:21,805][__main__][INFO] - Architecture: resnet50
[2025-08-14 16:00:21,805][__main__][INFO] - Embedding Dim: 64
[2025-08-14 16:00:21,805][__main__][INFO] - Learning Rate: 0.001
[2025-08-14 16:00:21,805][__main__][INFO] - Weight Decay: 0.0
[2025-08-14 16:00:21,805][__main__][INFO] - Optimizer: schedulefree
[2025-08-14 16:00:21,805][__main__][INFO] - Gradient Clip Val: 1.0
[2025-08-14 16:00:21,806][__main__][INFO] - Gradient Clip Algorithm: norm
[2025-08-14 16:00:21,806][__main__][INFO] - Accumulate Grad Batches: 1
[2025-08-14 16:00:21,806][__main__][INFO] - Channel Multipliers: [2, 4, 8, 16]
[2025-08-14 16:00:21,806][__main__][INFO] - Stage3 Stride: [1, 1, 1]
[2025-08-14 16:00:21,806][__main__][INFO] - Stage4 Stride: [1, 1, 1]
[2025-08-14 16:00:21,806][__main__][INFO] - Use LSTM: False
[2025-08-14 16:00:21,806][__main__][INFO] - Num Embeddings: 1521
[2025-08-14 16:00:21,806][__main__][INFO] - Dataset: code_type=surface_code, d=9, rounds=9, p=0.5
[2025-08-14 16:00:21,806][__main__][INFO] - Standard training (no curriculum)
[2025-08-14 16:00:21,806][__main__][INFO] - Accelerator: auto
[2025-08-14 16:00:21,806][__main__][INFO] - Devices per node: auto
[2025-08-14 16:00:21,807][__main__][INFO] - Num Nodes: 1
[2025-08-14 16:00:21,807][__main__][INFO] - Total Devices: 1
[2025-08-14 16:00:21,807][__main__][INFO] - Strategy: auto
[2025-08-14 16:00:21,807][__main__][INFO] - Sync BatchNorm: True
[2025-08-14 16:00:21,807][__main__][INFO] - MWPM filtering: False
[2025-08-14 16:00:21,807][__main__][INFO] - Batch Size: auto-tuned
[2025-08-14 16:00:21,807][__main__][INFO] - Precision: bf16-mixed
[2025-08-14 16:00:21,807][__main__][INFO] - Max Steps: 50000
[2025-08-14 16:00:21,807][__main__][INFO] - Checkpoint every 15 minutes
[2025-08-14 16:00:21,807][__main__][INFO] - Log every 100 steps
[2025-08-14 16:00:21,807][__main__][INFO] - Num Workers: 8
[2025-08-14 16:00:21,807][__main__][INFO] - Prefetch Factor: 4
[2025-08-14 16:00:21,807][__main__][INFO] - Persistent Workers: True
[2025-08-14 16:00:21,807][__main__][INFO] - Experiment directory: /n/netscratch/yelin_lab/Everyone/andigu/scaling/d9-test
[2025-08-14 16:00:21,819][__main__][INFO] - Setting up new W&B logger (W&B will assign run ID)
[2025-08-14 16:00:21,819][__main__][INFO] - Initializing wandb logger with params
[2025-08-14 16:00:23,755][__main__][INFO] - Saved new W&B run ID to file: 0nrik7qp
[2025-08-14 16:00:23,846][__main__][INFO] - === AUTO-TUNING BATCH SIZE (RANK 0) ===
[2025-08-14 16:00:24,680][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=2
[2025-08-14 16:00:25,822][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=4
[2025-08-14 16:00:26,711][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=8
[2025-08-14 16:00:27,494][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=16
[2025-08-14 16:00:28,422][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=32
[2025-08-14 16:00:29,622][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=64
[2025-08-14 16:00:31,432][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=128
[2025-08-14 16:00:34,429][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=256
[2025-08-14 16:00:39,824][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=512
[2025-08-14 16:00:41,021][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=384
[2025-08-14 16:00:42,275][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=320
[2025-08-14 16:00:43,451][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=288
[2025-08-14 16:00:49,745][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=304
[2025-08-14 16:00:50,921][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=296
[2025-08-14 16:00:52,115][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=292
[2025-08-14 16:00:53,243][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=290
[2025-08-14 16:00:59,562][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=291
[2025-08-14 16:01:06,211][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=291
[2025-08-14 16:01:07,224][__main__][INFO] - Model loaded from checkpoint at global step 0
[2025-08-14 16:01:07,342][__main__][INFO] - Found optimal batch size 291
[2025-08-14 16:01:07,349][__main__][INFO] - Saved batch size 269 to file
[2025-08-14 16:01:07,349][__main__][INFO] - Optimal per-GPU batch size found: 269
[2025-08-14 16:01:07,349][__main__][INFO] - Effective total batch size across 1 device(s) on 1 node(s) with 1 accumulation steps: 269
[2025-08-14 16:01:07,353][__main__][INFO] - Saved metadata: {'timestamp': 1755201667.3498943, 'slurm_job_id': '30182809', 'batch_size': 269, 'num_devices': 1, 'effective_batch_size': 269}
[2025-08-14 16:01:07,796][__main__][INFO] - === STARTING TRAINING ===
[2025-08-14 16:01:07,831][data_module][INFO] - Created dataset (TemporalSurfaceCodeDataset): l=6, m=6, d=9, rounds=9, p=0.5, batch_size=269
